{"description":"Add TraySms for SMS messages.\r\n\r\nBUG=124724\r\nTEST=Test SMS messages running Chrome with --aura-notify\r\nTBR=ben for ash strings\n\nCommitted: https://src.chromium.org/viewvc/chrome?view=rev&revision=137671","cc":["chromium-reviews@chromium.org","ben+watch@chromium.org"],"reviewers":["sadrul@chromium.org"],"messages":[{"sender":"stevenjb@chromium.org","recipients":["stevenjb@chromium.org","sadrul@chromium.org","chromium-reviews@chromium.org","sadrul@chromium.org","ben+watch@chromium.org"],"text":"SMS tray is ready for review when you have a chance.\n\nhttp://codereview.chromium.org/10332152/diff/2001/ash/system/tray/system_tray.cc\nFile ash/system/tray/system_tray.cc (right):\n\nhttp://codereview.chromium.org/10332152/diff/2001/ash/system/tray/system_tray.cc#newcode273\nash/system/tray/system_tray.cc:273: }\nMoved from below.","disapproval":false,"date":"2012-05-15 02:57:16.420608","approval":false},{"sender":"sadrul@chromium.org","recipients":["stevenjb@chromium.org","sadrul@chromium.org","chromium-reviews@chromium.org","sadrul@chromium.org","ben+watch@chromium.org"],"text":"http://codereview.chromium.org/10332152/diff/26/ash/system/network/tray_sms.cc\nFile ash/system/network/tray_sms.cc (right):\n\nhttp://codereview.chromium.org/10332152/diff/26/ash/system/network/tray_sms.cc#newcode108\nash/system/network/tray_sms.cc:108: #else\n#else  // defined(OS_CHROMEOS)\n\nhttp://codereview.chromium.org/10332152/diff/26/ash/system/network/tray_sms.cc#newcode149\nash/system/network/tray_sms.cc:149: class TraySms::SmsMessageView : public views::View,\nJust to clarify, this is one row in a detailed/notification view?\n\nhttp://codereview.chromium.org/10332152/diff/26/ash/system/network/tray_sms.cc#newcode233\nash/system/network/tray_sms.cc:233: int LayoutNotificationView() {\nIt looks like the detailed view gets a close button, but the notification button doesn't. Is that intentional? Should TrayNotificationView be involved somehow?\n\nhttp://codereview.chromium.org/10332152/diff/26/ash/system/network/tray_sms.h\nFile ash/system/network/tray_sms.h (right):\n\nhttp://codereview.chromium.org/10332152/diff/26/ash/system/network/tray_sms.h#newcode24\nash/system/network/tray_sms.h:24: OVERRIDE;\nOVERRIDE shouldn't be in its own line. You can move the parameter from the line before (see tray_power)\n\nhttp://codereview.chromium.org/10332152/diff/26/ash/system/network/tray_sms.h#newcode33\nash/system/network/tray_sms.h:33: class SmsDefaultView;\nThis is OK. But I wanted to point out that the rest of the tray-related code has these in a tray:: namespace.\n\nhttp://codereview.chromium.org/10332152/diff/26/ash/system/tray/system_tray.cc\nFile ash/system/tray/system_tray.cc (right):\n\nhttp://codereview.chromium.org/10332152/diff/26/ash/system/tray/system_tray.cc#newcode276\nash/system/tray/system_tray.cc:276: if (item == detailed_item_) {\nI am thinking this should be a DCHECK.","disapproval":false,"date":"2012-05-15 15:10:50.825347","approval":false},{"sender":"stevenjb@chromium.org","recipients":["stevenjb@chromium.org","sadrul@chromium.org","chromium-reviews@chromium.org","sadrul@chromium.org","ben+watch@chromium.org"],"text":"http://codereview.chromium.org/10332152/diff/26/ash/system/network/tray_sms.cc\nFile ash/system/network/tray_sms.cc (right):\n\nhttp://codereview.chromium.org/10332152/diff/26/ash/system/network/tray_sms.cc#newcode108\nash/system/network/tray_sms.cc:108: #else\nOn 2012/05/15 15:10:50, sadrul wrote:\n> #else  // defined(OS_CHROMEOS)\n\nDone.\n\nhttp://codereview.chromium.org/10332152/diff/26/ash/system/network/tray_sms.cc#newcode149\nash/system/network/tray_sms.cc:149: class TraySms::SmsMessageView : public views::View,\nOn 2012/05/15 15:10:50, sadrul wrote:\n> Just to clarify, this is one row in a detailed/notification view?\nCorrect.\n\nhttp://codereview.chromium.org/10332152/diff/26/ash/system/network/tray_sms.cc#newcode233\nash/system/network/tray_sms.cc:233: int LayoutNotificationView() {\nOn 2012/05/15 15:10:50, sadrul wrote:\n> It looks like the detailed view gets a close button, but the notification button\n> doesn't. Is that intentional? Should TrayNotificationView be involved somehow?\n\nSmsNotificationView inherits a close button from TrayNotificationView. \nThe detailed entries also need a close button, but the layout is a little different. \nI could do this as a base class and two subclasses if that would be more readable?\n\nhttp://codereview.chromium.org/10332152/diff/26/ash/system/network/tray_sms.h\nFile ash/system/network/tray_sms.h (right):\n\nhttp://codereview.chromium.org/10332152/diff/26/ash/system/network/tray_sms.h#newcode24\nash/system/network/tray_sms.h:24: OVERRIDE;\nOn 2012/05/15 15:10:50, sadrul wrote:\n> OVERRIDE shouldn't be in its own line. You can move the parameter from the line\n> before (see tray_power)\n\nDone.\n\nhttp://codereview.chromium.org/10332152/diff/26/ash/system/network/tray_sms.h#newcode33\nash/system/network/tray_sms.h:33: class SmsDefaultView;\nOn 2012/05/15 15:10:50, sadrul wrote:\n> This is OK. But I wanted to point out that the rest of the tray-related code has\n> these in a tray:: namespace.\n\nThat works fine too, but in this case most of these also need to be friends, so this is more compact.\n\nhttp://codereview.chromium.org/10332152/diff/26/ash/system/tray/system_tray.cc\nFile ash/system/tray/system_tray.cc (right):\n\nhttp://codereview.chromium.org/10332152/diff/26/ash/system/tray/system_tray.cc#newcode276\nash/system/tray/system_tray.cc:276: if (item == detailed_item_) {\nOn 2012/05/15 15:10:50, sadrul wrote:\n> I am thinking this should be a DCHECK.\n\nI would rather keep this safe in case a class calls this without checking that its detailed view is open. It should really be an early exit though, I'll fix that.","disapproval":false,"date":"2012-05-15 16:55:19.593252","approval":false},{"sender":"stevenjb@chromium.org","recipients":["stevenjb@chromium.org","sadrul@chromium.org","chromium-reviews@chromium.org","sadrul@chromium.org","ben+watch@chromium.org"],"text":"PTAL","disapproval":false,"date":"2012-05-15 16:55:32.360727","approval":false},{"sender":"sadrul@chromium.org","recipients":["stevenjb@chromium.org","sadrul@chromium.org","chromium-reviews@chromium.org","sadrul@chromium.org","ben+watch@chromium.org"],"text":"LGTM","disapproval":false,"date":"2012-05-16 18:19:42.808926","approval":true},{"sender":"stevenjb@chromium.org","recipients":["stevenjb@chromium.org","sadrul@chromium.org","chromium-reviews@chromium.org","sadrul@chromium.org","ben+watch@chromium.org"],"text":"PTAL. \nI merged TraySms with TrayDetailsView.\n\nI had to make a change to TrayDetailsView::Layout to handle the case when size.height() == height() but the content is smaller than the bubble. (It was simplest to always force the footer to the bottom).\n\nThere is also a change to system_tray_bubble.cc to always resize the default view to its contents, so that it is sized correctly when a new entry is added to the default view while showing a detailed view (e.g. a SMS arrives while viewing the network view) and the < button is clicked.","disapproval":false,"date":"2012-05-16 23:31:04.889851","approval":false},{"sender":"sadrul@chromium.org","recipients":["stevenjb@chromium.org","sadrul@chromium.org","chromium-reviews@chromium.org","ben+watch@chromium.org"],"text":"On 2012/05/16 23:31:04, stevenjb (chromium) wrote:\n> PTAL. \n> I merged TraySms with TrayDetailsView.\n> \n> I had to make a change to TrayDetailsView::Layout to handle the case when\n> size.height() == height() but the content is smaller than the bubble. (It was\n> simplest to always force the footer to the bottom).\n> \n> There is also a change to system_tray_bubble.cc to always resize the default\n> view to its contents, so that it is sized correctly when a new entry is added to\n> the default view while showing a detailed view (e.g. a SMS arrives while viewing\n> the network view) and the < button is clicked.\n\nBoth of these changes look good. Thanks! LGTM","disapproval":false,"date":"2012-05-16 23:51:16.227202","approval":true},{"sender":"commit-bot@chromium.org","recipients":["stevenjb@chromium.org","sadrul@chromium.org","chromium-reviews@chromium.org","ben+watch@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/stevenjb@chromium.org/10332152/2003","disapproval":false,"date":"2012-05-17 05:43:43.804495","approval":false},{"sender":"commit-bot@chromium.org","recipients":["stevenjb@chromium.org","sadrul@chromium.org","chromium-reviews@chromium.org","ben+watch@chromium.org"],"text":"Can't apply patch for file ui/resources/ui_resources.grd.\nWhile running patch -p1 --forward --force;\npatching file ui/resources/ui_resources.grd\nHunk #1 FAILED at 289.\n1 out of 1 hunk FAILED -- saving rejects to file ui/resources/ui_resources.grd.rej","disapproval":false,"date":"2012-05-17 05:43:51.332451","approval":false}],"owner_email":"stevenjb@chromium.org","private":false,"base_url":"svn://svn.chromium.org/chrome/trunk/src","owner":"stevenjb","subject":"Add TraySms for SMS messages.","created":"2012-05-14 19:45:49.002971","patchsets":[1,2001,26,6016,12001,2003],"modified":"2012-05-17 16:20:55.894850","closed":true,"commit":false,"issue":10332152}
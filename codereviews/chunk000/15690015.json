{"description":"Fix crash when JS alert from background page appears during lock screen\n\n+ Added test that caused crash without changes in ash/wm/stacking_controller.cc\n+ Changes in chrome/browser/ui/views/frame/browser_view.cc prevents stealing focus loop\n\nBUG=226141\nTEST=ShellTest.CreateLockScreenModalWindow\n\nCommitted: https://src.chromium.org/viewvc/chrome?view=rev&revision=203191","cc":["chromium-reviews@chromium.org","tfarina@chromium.org","sadrul@chromium.org","ben+watch@chromium.org"],"reviewers":["sky@chromium.org","nkostylev@chromium.org"],"messages":[{"sender":"dpolukhin@chromium.org","recipients":["dpolukhin@chromium.org","sky@chromium.org","chromium-reviews@chromium.org","tfarina@chromium.org","sadrul@chromium.org","ben+watch@chromium.org"],"text":"","disapproval":false,"date":"2013-05-29 14:33:48.709230","approval":false},{"sender":"dpolukhin@chromium.org","recipients":["dpolukhin@chromium.org","sky@chromium.org","nkostylev@chromium.org","chromium-reviews@chromium.org","tfarina@chromium.org","sadrul@chromium.org","ben+watch@chromium.org"],"text":"sky@ please do OWNER review","disapproval":false,"date":"2013-05-29 14:39:49.373640","approval":false},{"sender":"sky@chromium.org","recipients":["dpolukhin@chromium.org","sky@chromium.org","nkostylev@chromium.org","chromium-reviews@chromium.org","tfarina@chromium.org","sadrul@chromium.org","ben+watch@chromium.org"],"text":"How about a test?","disapproval":false,"date":"2013-05-29 15:25:47.225660","approval":false},{"sender":"dpolukhin@chromium.org","recipients":["dpolukhin@chromium.org","sky@chromium.org","nkostylev@chromium.org","chromium-reviews@chromium.org","tfarina@chromium.org","sadrul@chromium.org","ben+watch@chromium.org"],"text":"Test added, PTAL.","disapproval":false,"date":"2013-05-30 12:45:12.530000","approval":false},{"sender":"sky@chromium.org","recipients":["dpolukhin@chromium.org","sky@chromium.org","nkostylev@chromium.org","chromium-reviews@chromium.org","tfarina@chromium.org","sadrul@chromium.org","ben+watch@chromium.org"],"text":"https://codereview.chromium.org/15690015/diff/24001/ash/shell_unittest.cc\nFile ash/shell_unittest.cc (right):\n\nhttps://codereview.chromium.org/15690015/diff/24001/ash/shell_unittest.cc#newcode278\nash/shell_unittest.cc:278: TestModalDialogDelegate* dilaog_delegate = new TestModalDialogDelegate();\ndilaog -> dialog\n\nhttps://codereview.chromium.org/15690015/diff/24001/ash/wm/stacking_controller.cc\nFile ash/wm/stacking_controller.cc (right):\n\nhttps://codereview.chromium.org/15690015/diff/24001/ash/wm/stacking_controller.cc#newcode134\nash/wm/stacking_controller.cc:134: int window_container_id = window->transient_parent() ?\nThis code would be less mysterious if you made it early out, eg:\n\nif (!window->transient_parent())\n  return GetContainerById(root, internal::kShellWindowId_SystemModalContainer);\n}\n\nIn fact you could combine this with the if on 122 (keeping your comment).","disapproval":false,"date":"2013-05-30 14:53:47.249630","approval":false},{"sender":"dpolukhin@chromium.org","recipients":["dpolukhin@chromium.org","sky@chromium.org","nkostylev@chromium.org","chromium-reviews@chromium.org","tfarina@chromium.org","sadrul@chromium.org","ben+watch@chromium.org"],"text":"PTAL\n\nhttps://codereview.chromium.org/15690015/diff/24001/ash/shell_unittest.cc\nFile ash/shell_unittest.cc (right):\n\nhttps://codereview.chromium.org/15690015/diff/24001/ash/shell_unittest.cc#newcode278\nash/shell_unittest.cc:278: TestModalDialogDelegate* dilaog_delegate = new TestModalDialogDelegate();\nOn 2013/05/30 14:53:47, sky wrote:\n> dilaog -> dialog\n\nDone.\n\nhttps://codereview.chromium.org/15690015/diff/24001/ash/wm/stacking_controller.cc\nFile ash/wm/stacking_controller.cc (right):\n\nhttps://codereview.chromium.org/15690015/diff/24001/ash/wm/stacking_controller.cc#newcode134\nash/wm/stacking_controller.cc:134: int window_container_id = window->transient_parent() ?\nOn 2013/05/30 14:53:47, sky wrote:\n> This code would be less mysterious if you made it early out, eg:\n> \n> if (!window->transient_parent())\n>   return GetContainerById(root, internal::kShellWindowId_SystemModalContainer);\n> }\n> \n> In fact you could combine this with the if on 122 (keeping your comment).\n\nDone.","disapproval":false,"date":"2013-05-30 15:09:02.329680","approval":false},{"sender":"sky@chromium.org","recipients":["dpolukhin@chromium.org","sky@chromium.org","nkostylev@chromium.org","chromium-reviews@chromium.org","tfarina@chromium.org","sadrul@chromium.org","ben+watch@chromium.org"],"text":"LGTM","disapproval":false,"date":"2013-05-30 15:23:35.543320","approval":true},{"sender":"commit-bot@chromium.org","recipients":["dpolukhin@chromium.org","sky@chromium.org","nkostylev@chromium.org","chromium-reviews@chromium.org","tfarina@chromium.org","sadrul@chromium.org","ben+watch@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/dpolukhin@chromium.org/15690015/33003","disapproval":false,"date":"2013-05-30 15:33:35.141590","approval":false},{"sender":"commit-bot@chromium.org","recipients":["dpolukhin@chromium.org","sky@chromium.org","nkostylev@chromium.org","chromium-reviews@chromium.org","tfarina@chromium.org","sadrul@chromium.org","ben+watch@chromium.org"],"text":"Change committed as 203191","disapproval":false,"date":"2013-05-30 18:59:29.486730","approval":false}],"owner_email":"dpolukhin@chromium.org","private":false,"base_url":"svn://svn.chromium.org/chrome/trunk/src","owner":"Dmitry Polukhin","subject":"Fix crash when JS alert from background page appears during lock screen","created":"2013-05-29 14:31:51.778660","patchsets":[1,15001,17001,24001,33003],"modified":"2013-05-30 18:59:29.652570","closed":true,"commit":false,"issue":15690015}
{"files":{"chrome/browser/profiles/profile.cc":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":1,"num_removed":1,"messages":[],"id":12007,"is_binary":false},"chrome/browser/profiles/profile.h":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":4,"num_removed":1,"messages":[],"id":12008,"is_binary":false},"chrome/browser/sync/glue/theme_data_type_controller.cc":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":1,"num_removed":1,"messages":[],"id":12015,"is_binary":false},"chrome/browser/profiles/profile_manager.cc":{"status":"M","num_chunks":6,"no_base_file":false,"property_changes":"","num_added":10,"num_removed":10,"messages":[{"author":"Aaron Boodman","author_email":"aa@chromium.org","text":"Comment doesn't really make sense.","draft":false,"lineno":158,"date":"2011-04-09 04:53:48.583309","left":false},{"author":"Dmitry Polukhin","author_email":"dpolukhin@chromium.org","text":"On 2011/04/09 04:53:48, Aaron Boodman wrote:\n> Comment doesn't really make sense.\n\nDone.","draft":false,"lineno":158,"date":"2011-04-11 13:01:03.992429","left":false}],"id":12011,"is_binary":false},"chrome/browser/sync/glue/extension_data_type_controller.cc":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":1,"num_removed":1,"messages":[],"id":12014,"is_binary":false},"chrome/browser/extensions/extension_management_api.cc":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":6,"num_removed":4,"messages":[{"author":"Aaron Boodman","author_email":"aa@chromium.org","text":"unrelated change?","draft":false,"lineno":266,"date":"2011-04-09 04:53:48.582252","left":false},{"author":"Dmitry Polukhin","author_email":"dpolukhin@chromium.org","text":"On 2011/04/09 04:53:48, Aaron Boodman wrote:\n> unrelated change?\n\nIt is required changes because Init will be called more than once - for login profile and for user's profile. All other event routers already have such guards (see for example http://google.com/codesearch/p?hl=en#OAMlx_jo-ck/src/chrome/browser/extensions/extension_cookies_api.cc&q=ExtensionCookiesEventRouter::Init&exact_package=chromium&sa=N&cd=1&ct=rc&l=33). I don't like such protection but it is required because concept of ExtensionManagementEventRouter as a singleton is broken (singleton shouldn't require Init method that must be called only once before first use).","draft":false,"lineno":266,"date":"2011-04-11 13:01:03.991737","left":false},{"author":"Aaron Boodman","author_email":"aa@chromium.org","text":"On 2011/04/11 13:01:03, Dmitry Polukhin wrote:\n> On 2011/04/09 04:53:48, Aaron Boodman wrote:\n> > unrelated change?\n> \n> It is required changes because Init will be called more than once - for login\n> profile and for user's profile. All other event routers already have such guards\n> (see for example\n> http://google.com/codesearch/p?hl=en#OAMlx_jo-ck/src/chrome/browser/extensions/extension_cookies_api.cc&q=ExtensionCookiesEventRouter::Init&exact_package=chromium&sa=N&cd=1&ct=rc&l=33).\n> I don't like such protection but it is required because concept of\n> ExtensionManagementEventRouter as a singleton is broken (singleton shouldn't\n> require Init method that must be called only once before first use).\n\nAgree it is ugly, but acceptable. Can you put a comment here like:\n\n// Don't re-init (eg in the case of multiple profiles).","draft":false,"lineno":266,"date":"2011-04-14 17:51:20.485607","left":false},{"author":"Dmitry Polukhin","author_email":"dpolukhin@chromium.org","text":"On 2011/04/14 17:51:20, Aaron Boodman wrote:\n> On 2011/04/11 13:01:03, Dmitry Polukhin wrote:\n> > On 2011/04/09 04:53:48, Aaron Boodman wrote:\n> > > unrelated change?\n> > \n> > It is required changes because Init will be called more than once - for login\n> > profile and for user's profile. All other event routers already have such\n> guards\n> > (see for example\n> >\n> http://google.com/codesearch/p?hl=en#OAMlx_jo-ck/src/chrome/browser/extensions/extension_cookies_api.cc&q=ExtensionCookiesEventRouter::Init&exact_package=chromium&sa=N&cd=1&ct=rc&l=33).\n> > I don't like such protection but it is required because concept of\n> > ExtensionManagementEventRouter as a singleton is broken (singleton shouldn't\n> > require Init method that must be called only once before first use).\n> \n> Agree it is ugly, but acceptable. Can you put a comment here like:\n> \n> // Don't re-init (eg in the case of multiple profiles).\n\nDone.","draft":false,"lineno":266,"date":"2011-04-15 11:45:18.852227","left":false}],"id":12003,"is_binary":false},"chrome/browser/chromeos/login/login_browsertest.cc":{"status":"M","num_chunks":2,"no_base_file":false,"property_changes":"","num_added":4,"num_removed":3,"messages":[{"author":"Aaron Boodman","author_email":"aa@chromium.org","text":"There's ASSERT_NOT_NULL you can use instead. Or you can just use EXPECT_TRUE.","draft":false,"lineno":95,"date":"2011-04-09 04:53:48.581979","left":false},{"author":"Dmitry Polukhin","author_email":"dpolukhin@chromium.org","text":"On 2011/04/09 04:53:48, Aaron Boodman wrote:\n> There's ASSERT_NOT_NULL you can use instead. Or you can just use EXPECT_TRUE.\n\nDone.","draft":false,"lineno":95,"date":"2011-04-11 13:01:03.991582","left":false}],"id":12002,"is_binary":false},"chrome/test/live_sync/live_extensions_sync_test_base.cc":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":2,"num_removed":2,"messages":[],"id":12017,"is_binary":false},"chrome/test/testing_profile.cc":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":2,"num_removed":1,"messages":[],"id":12018,"is_binary":false},"chrome/browser/profiles/profile_impl.h":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":1,"num_removed":1,"messages":[],"id":12010,"is_binary":false},"chrome/browser/sync/glue/app_data_type_controller.cc":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":1,"num_removed":1,"messages":[],"id":12013,"is_binary":false},"chrome/browser/profiles/profile_manager.h":{"status":"M","num_chunks":3,"no_base_file":false,"property_changes":"","num_added":10,"num_removed":10,"messages":[{"author":"Aaron Boodman","author_email":"aa@chromium.org","text":"Why would it matter if extensions were enabled the last time this path was used, out of curiosity?","draft":false,"lineno":110,"date":"2011-04-09 04:53:48.583455","left":false},{"author":"Aaron Boodman","author_email":"aa@chromium.org","text":"Why the name change GetProfile->GetProfileImpl? Also, why make this method private?","draft":false,"lineno":111,"date":"2011-04-09 04:53:48.583593","left":false},{"author":"Dmitry Polukhin","author_email":"dpolukhin@chromium.org","text":"On 2011/04/09 04:53:48, Aaron Boodman wrote:\n> Why would it matter if extensions were enabled the last time this path was used,\n> out of curiosity?\n\nBecause if Profile is initialized already, it is not re-initialized (with new extensions_enabled value) and existing profile is returned. So if profile exists extensions_enabled value is ignored.","draft":false,"lineno":110,"date":"2011-04-11 13:01:03.992558","left":false},{"author":"Dmitry Polukhin","author_email":"dpolukhin@chromium.org","text":"On 2011/04/09 04:53:48, Aaron Boodman wrote:\n> Why the name change GetProfile->GetProfileImpl? Also, why make this method\n> private?\n\nI did it because I had changed meaning of second argument but preserved type of the argument. So I needed to make sure that I found all use cases. But after that I found that no-one actually using it except for 1 test (see chrome_frame/test/net/fake_external_tab.cc) and this test did it as a try to resolve test flakiness (http://codereview.chromium.org/2051004). I can make it public again but it looks that it is implementation of GetProfile that none should care about (especially taking into account that second parameter is ignored in some cases).","draft":false,"lineno":111,"date":"2011-04-11 13:01:03.992692","left":false},{"author":"Aaron Boodman","author_email":"aa@chromium.org","text":"On 2011/04/11 13:01:03, Dmitry Polukhin wrote:\n> On 2011/04/09 04:53:48, Aaron Boodman wrote:\n> > Why would it matter if extensions were enabled the last time this path was\n> used,\n> > out of curiosity?\n> \n> Because if Profile is initialized already, it is not re-initialized (with new\n> extensions_enabled value) and existing profile is returned. So if profile exists\n> extensions_enabled value is ignored.\n\nok.","draft":false,"lineno":110,"date":"2011-04-14 17:51:20.486223","left":false},{"author":"Aaron Boodman","author_email":"aa@chromium.org","text":"On 2011/04/11 13:01:03, Dmitry Polukhin wrote:\n> On 2011/04/09 04:53:48, Aaron Boodman wrote:\n> > Why the name change GetProfile->GetProfileImpl? Also, why make this method\n> > private?\n> \n> I did it because I had changed meaning of second argument but preserved type of\n> the argument. So I needed to make sure that I found all use cases. But after\n> that I found that no-one actually using it except for 1 test (see\n> chrome_frame/test/net/fake_external_tab.cc) and this test did it as a try to\n> resolve test flakiness (http://codereview.chromium.org/2051004). I can make it\n> public again but it looks that it is implementation of GetProfile that none\n> should care about (especially taking into account that second parameter is\n> ignored in some cases).\n\nok, makes sense.","draft":false,"lineno":111,"date":"2011-04-14 17:51:20.486360","left":false}],"id":12012,"is_binary":false},"chrome/browser/ui/cocoa/extensions/extension_popup_controller_unittest.mm":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":2,"num_removed":1,"messages":[],"id":12016,"is_binary":false},"chrome/browser/extensions/extension_process_manager.cc":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":8,"num_removed":0,"messages":[{"author":"Aaron Boodman","author_email":"aa@chromium.org","text":"Why is this change necessary? How do we even get in here when we aren't loading any extensions in ExtensionService?","draft":false,"lineno":175,"date":"2011-04-09 04:53:48.582500","left":false},{"author":"Dmitry Polukhin","author_email":"dpolukhin@chromium.org","text":"On 2011/04/09 04:53:48, Aaron Boodman wrote:\n> Why is this change necessary? How do we even get in here when we aren't loading\n> any extensions in ExtensionService?\n\nThis change is required when user logs in and user's extensions start loading. This changes prevents creating renderer for user's extensions in login profile. It looks like we don't have concept of profile unload.\n\nHow it works in general. Initially only login profile is initialized. When user logs in on Chrome OS we don't restart Chrome process and just load user profile. Therefore when user logged in we have 2 profiles in memory. It is already happens, I haven't changed it. My CL initializes extensions in login profile.","draft":false,"lineno":175,"date":"2011-04-11 13:01:03.991887","left":false},{"author":"Aaron Boodman","author_email":"aa@chromium.org","text":"On 2011/04/11 13:01:03, Dmitry Polukhin wrote:\n> On 2011/04/09 04:53:48, Aaron Boodman wrote:\n> > Why is this change necessary? How do we even get in here when we aren't\n> loading\n> > any extensions in ExtensionService?\n> \n> This change is required when user logs in and user's extensions start loading.\n> This changes prevents creating renderer for user's extensions in login profile.\n> It looks like we don't have concept of profile unload.\n> \n> How it works in general. Initially only login profile is initialized. When user\n> logs in on Chrome OS we don't restart Chrome process and just load user profile.\n> Therefore when user logged in we have 2 profiles in memory. It is already\n> happens, I haven't changed it. My CL initializes extensions in login profile.\n\nIt seems like when we create the first profile (the login profile), we set it up to only load extensions that are Extension::COMPONENT. So it seems like the filtering of what extensions to load has already been done by the time this code runs, so there should be no point in checking it again. Do you ever hit the return statement here?\n\nSee: http://codesearch.google.com/codesearch/p?hl=en#OAMlx_jo-ck/src/chrome/browser/extensions/extension_service.cc&q=extension_service.cc&exact_package=chromium&l=1419","draft":false,"lineno":175,"date":"2011-04-14 17:51:20.485798","left":false},{"author":"Dmitry Polukhin","author_email":"dpolukhin@chromium.org","text":"On 2011/04/14 17:51:20, Aaron Boodman wrote:\n> It seems like when we create the first profile (the login profile), we set it up\n> to only load extensions that are Extension::COMPONENT. So it seems like the\n> filtering of what extensions to load has already been done by the time this code\n> runs, so there should be no point in checking it again. Do you ever hit the\n> return statement here?\n> \n> See:\n> http://codesearch.google.com/codesearch/p?hl=en#OAMlx_jo-ck/src/chrome/browser/extensions/extension_service.cc&q=extension_service.cc&exact_package=chromium&l=1419\n\nI'll double check it but I observed that return is executed when extensions for user profile are loaded (i.e. extensions for second profile). I saw that all profiles get notified with EXTENSIONS_READY when second profile is loaded. I'll check it once again why it happens - it looks like it shouldn't happen.","draft":false,"lineno":175,"date":"2011-04-14 18:18:15.309977","left":false},{"author":"Dmitry Polukhin","author_email":"dpolukhin@chromium.org","text":"On 2011/04/14 18:18:15, Dmitry Polukhin wrote:\n> On 2011/04/14 17:51:20, Aaron Boodman wrote:\n> > It seems like when we create the first profile (the login profile), we set it\n> up\n> > to only load extensions that are Extension::COMPONENT. So it seems like the\n> > filtering of what extensions to load has already been done by the time this\n> code\n> > runs, so there should be no point in checking it again. Do you ever hit the\n> > return statement here?\n> > \n> > See:\n> >\n> http://codesearch.google.com/codesearch/p?hl=en#OAMlx_jo-ck/src/chrome/browser/extensions/extension_service.cc&q=extension_service.cc&exact_package=chromium&l=1419\n> \n> I'll double check it but I observed that return is executed when extensions for\n> user profile are loaded (i.e. extensions for second profile). I saw that all\n> profiles get notified with EXTENSIONS_READY when second profile is loaded. I'll\n> check it once again why it happens - it looks like it shouldn't happen.\n\nI found why we got notifications for all profiles: c-tor for ExtensionProcessManager subscribed for all sources - I fixed it.","draft":false,"lineno":175,"date":"2011-04-15 11:45:18.852393","left":false}],"id":12004,"is_binary":false},"chrome/browser/extensions/extension_service.cc":{"status":"M","num_chunks":2,"no_base_file":false,"property_changes":"","num_added":4,"num_removed":3,"messages":[],"id":12005,"is_binary":false},"chrome/browser/extensions/extension_service.h":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":2,"num_removed":1,"messages":[{"author":"Aaron Boodman","author_email":"aa@chromium.org","text":"Boolean params are bad for readability. How about adding an ExtensionServiceFlags enum to pass in here?","draft":false,"lineno":145,"date":"2011-04-09 04:53:48.582755","left":false},{"author":"Dmitry Polukhin","author_email":"dpolukhin@chromium.org","text":"On 2011/04/09 04:53:48, Aaron Boodman wrote:\n> Boolean params are bad for readability. How about adding an\n> ExtensionServiceFlags enum to pass in here?\n\nI'm not sure that I get the idea. It looks like we need all 4 combinations of autoupdate_enabled and extensions_enabled for testing purpose so using single flags enum won't make things simpler, IMHO.","draft":false,"lineno":145,"date":"2011-04-11 13:01:03.992025","left":false},{"author":"Aaron Boodman","author_email":"aa@chromium.org","text":"On 2011/04/11 13:01:03, Dmitry Polukhin wrote:\n> On 2011/04/09 04:53:48, Aaron Boodman wrote:\n> > Boolean params are bad for readability. How about adding an\n> > ExtensionServiceFlags enum to pass in here?\n> \n> I'm not sure that I get the idea. It looks like we need all 4 combinations of\n> autoupdate_enabled and extensions_enabled for testing purpose so using single\n> flags enum won't make things simpler, IMHO.\n\nThe idea is so that people can see at the call sites what the booleans mean -- so that they have meaningful names.\n\nI don't feel that strongly about this one.","draft":false,"lineno":145,"date":"2011-04-14 17:51:20.485955","left":false}],"id":12006,"is_binary":false},"chrome/browser/profiles/profile_impl.cc":{"status":"M","num_chunks":3,"no_base_file":false,"property_changes":"","num_added":17,"num_removed":9,"messages":[{"author":"Aaron Boodman","author_email":"aa@chromium.org","text":"This should always be true.","draft":false,"lineno":363,"date":"2011-04-09 04:53:48.582977","left":false},{"author":"Aaron Boodman","author_email":"aa@chromium.org","text":"What do we do in ExtensionUpdater that you're trying to avoid here? It seems like if no extensions are installed that have update URLs, ExtensionUpdater shouldn't do anything.","draft":false,"lineno":372,"date":"2011-04-09 04:53:48.583162","left":false},{"author":"Dmitry Polukhin","author_email":"dpolukhin@chromium.org","text":"On 2011/04/09 04:53:48, Aaron Boodman wrote:\n> This should always be true.\n\nDone.","draft":false,"lineno":363,"date":"2011-04-11 13:01:03.992169","left":false},{"author":"Dmitry Polukhin","author_email":"dpolukhin@chromium.org","text":"On 2011/04/09 04:53:48, Aaron Boodman wrote:\n> What do we do in ExtensionUpdater that you're trying to avoid here? It seems\n> like if no extensions are installed that have update URLs, ExtensionUpdater\n> shouldn't do anything.\n\nI would like to avoid pings to server from login screen. As far as I understand blacklist will be downloaded if there are component extensions because HasInstalledExtensions returns true.","draft":false,"lineno":372,"date":"2011-04-11 13:01:03.992300","left":false},{"author":"Aaron Boodman","author_email":"aa@chromium.org","text":"On 2011/04/11 13:01:03, Dmitry Polukhin wrote:\n> On 2011/04/09 04:53:48, Aaron Boodman wrote:\n> > What do we do in ExtensionUpdater that you're trying to avoid here? It seems\n> > like if no extensions are installed that have update URLs, ExtensionUpdater\n> > shouldn't do anything.\n> \n> I would like to avoid pings to server from login screen. As far as I understand\n> blacklist will be downloaded if there are component extensions because\n> HasInstalledExtensions returns true.\n\nOk, I talked to asargent. I agree with you.","draft":false,"lineno":372,"date":"2011-04-14 17:51:20.486091","left":false}],"id":12009,"is_binary":false},"chrome/browser/browser_main.cc":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":1,"num_removed":1,"messages":[],"id":12001,"is_binary":false},"chrome/test/testing_profile.h":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":1,"num_removed":1,"messages":[],"id":12019,"is_binary":false},"chrome_frame/test/net/fake_external_tab.cc":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":1,"num_removed":1,"messages":[],"id":12020,"is_binary":false}},"owner_email":"dpolukhin@chromium.org","owner":"Dmitry Polukhin","message":"block ExtensionHost for profiles with disabled extensions","try_job_results":[{"parent_name":null,"tests":[],"slave":null,"url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=linux&number=20599","timestamp":"2011-04-15 11:45:18.886783","builder":"linux","clobber":null,"project":null,"reason":null,"result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIxCxIFSXNzdWUYhJmbAwwLEghQYXRjaFNldBj5VQwLEgxUcnlKb2JSZXN1bHQY5uIBDA","requester":null,"buildnumber":null,"revision":null},{"parent_name":null,"tests":[],"slave":null,"url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=win_sync&number=1324","timestamp":"2011-04-15 11:45:18.886783","builder":"win_sync","clobber":null,"project":null,"reason":null,"result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIxCxIFSXNzdWUYhJmbAwwLEghQYXRjaFNldBj5VQwLEgxUcnlKb2JSZXN1bHQY5-IBDA","requester":null,"buildnumber":null,"revision":null},{"parent_name":null,"tests":[],"slave":null,"url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=mac&number=21121","timestamp":"2011-04-15 11:45:18.886783","builder":"mac","clobber":null,"project":null,"reason":null,"result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIxCxIFSXNzdWUYhJmbAwwLEghQYXRjaFNldBj5VQwLEgxUcnlKb2JSZXN1bHQY6OIBDA","requester":null,"buildnumber":null,"revision":null},{"parent_name":null,"tests":[],"slave":null,"url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=linux_view&number=4613","timestamp":"2011-04-15 11:45:18.886783","builder":"linux_view","clobber":null,"project":null,"reason":null,"result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIxCxIFSXNzdWUYhJmbAwwLEghQYXRjaFNldBj5VQwLEgxUcnlKb2JSZXN1bHQY6eIBDA","requester":null,"buildnumber":null,"revision":null},{"parent_name":null,"tests":[],"slave":null,"url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=win&number=25190","timestamp":"2011-04-15 11:45:18.886783","builder":"win","clobber":null,"project":null,"reason":null,"result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIxCxIFSXNzdWUYhJmbAwwLEghQYXRjaFNldBj5VQwLEgxUcnlKb2JSZXN1bHQY6uIBDA","requester":null,"buildnumber":null,"revision":null},{"parent_name":null,"tests":[],"slave":null,"url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=linux_sync&number=1580","timestamp":"2011-04-15 11:45:18.886783","builder":"linux_sync","clobber":null,"project":null,"reason":null,"result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIxCxIFSXNzdWUYhJmbAwwLEghQYXRjaFNldBj5VQwLEgxUcnlKb2JSZXN1bHQY6-IBDA","requester":null,"buildnumber":null,"revision":null},{"parent_name":null,"tests":[],"slave":null,"url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=mac_sync&number=1329","timestamp":"2011-04-15 11:45:18.886783","builder":"mac_sync","clobber":null,"project":null,"reason":null,"result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIxCxIFSXNzdWUYhJmbAwwLEghQYXRjaFNldBj5VQwLEgxUcnlKb2JSZXN1bHQY7OIBDA","requester":null,"buildnumber":null,"revision":null},{"parent_name":null,"tests":[],"slave":null,"url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=linux_chromeos&number=6282","timestamp":"2011-04-15 11:45:18.886783","builder":"linux_chromeos","clobber":null,"project":null,"reason":null,"result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIxCxIFSXNzdWUYhJmbAwwLEghQYXRjaFNldBj5VQwLEgxUcnlKb2JSZXN1bHQY7eIBDA","requester":null,"buildnumber":null,"revision":null}],"created":"2011-04-07 14:38:38.114597","url":null,"num_comments":27,"modified":"2012-01-13 14:30:15.175201","patchset":11001,"issue":6737028}
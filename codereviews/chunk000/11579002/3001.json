{"files":{"net/base/x509_util_nss.cc":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":17,"num_removed":0,"messages":[{"author":"Ryan Sleevi (OoO until 11-18)","author_email":"rsleevi@chromium.org","text":"use the CERTName comparison","draft":false,"lineno":541,"date":"2012-12-13 19:49:05.504010","left":false},{"author":"digit1","author_email":"digit@chromium.org","text":"On 2012/12/13 19:49:05, Ryan Sleevi wrote:\n> use the CERTName comparison\n\nThat's not do-able for the reason explained previously (no NSS API to create a CERTName from a DER-encoded byte array).\nI've added a comment explaining this.\n","draft":false,"lineno":541,"date":"2012-12-14 17:54:33.591460","left":false},{"author":"Ryan Sleevi (OoO until 11-18)","author_email":"rsleevi@chromium.org","text":"On 2012/12/14 17:54:33, digit1 wrote:\n> On 2012/12/13 19:49:05, Ryan Sleevi wrote:\n> > use the CERTName comparison\n> \n> That's not do-able for the reason explained previously (no NSS API to create a\n> CERTName from a DER-encoded byte array).\n> I've added a comment explaining this.\n\nSee comments about the NSS API to use to do this :)","draft":false,"lineno":541,"date":"2012-12-14 18:16:42.291800","left":false}],"id":4007,"is_binary":false},"net/base/x509_certificate_win.cc":{"status":"M","num_chunks":2,"no_base_file":false,"property_changes":"","num_added":40,"num_removed":0,"messages":[{"author":"Ryan Sleevi (OoO until 11-18)","author_email":"rsleevi@chromium.org","text":"STYLE: Indenting is wrong\n\nbool IsCertNameBlobInIsuserList(\n    CERT_NAME_BLOB* name_blob,\n    const std::vector<std::string>& issuer_names) {\n}","draft":false,"lineno":129,"date":"2012-12-13 19:49:05.503430","left":false},{"author":"Ryan Sleevi (OoO until 11-18)","author_email":"rsleevi@chromium.org","text":"STYLE: Indenting is messy here\n\nif (IsCertNameBlobInIssuerList(&cert_handle->pCertInfo->Issuer,\n                               valid_issuers)) {\n  return true;\n}\n\nSame on 496 as well","draft":false,"lineno":490,"date":"2012-12-13 19:49:05.503750","left":false},{"author":"digit1","author_email":"digit@chromium.org","text":"On 2012/12/13 19:49:05, Ryan Sleevi wrote:\n> STYLE: Indenting is wrong\n> \n> bool IsCertNameBlobInIsuserList(\n>     CERT_NAME_BLOB* name_blob,\n>     const std::vector<std::string>& issuer_names) {\n> }\n\nDone.","draft":false,"lineno":129,"date":"2012-12-14 17:54:33.591080","left":false},{"author":"digit1","author_email":"digit@chromium.org","text":"On 2012/12/13 19:49:05, Ryan Sleevi wrote:\n> STYLE: Indenting is messy here\n> \n> if (IsCertNameBlobInIssuerList(&cert_handle->pCertInfo->Issuer,\n>                                valid_issuers)) {\n>   return true;\n> }\n> \n> Same on 496 as well\n\nDone.","draft":false,"lineno":490,"date":"2012-12-14 17:54:33.591270","left":false}],"id":4006,"is_binary":false},"net/base/x509_certificate_ios.cc":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":15,"num_removed":0,"messages":[{"author":"Ryan Sleevi (OoO until 11-18)","author_email":"rsleevi@chromium.org","text":"It's a shame to have to reparse the CERTName here (we have it in cert_handle->issuer)","draft":false,"lineno":75,"date":"2012-12-13 19:49:05.501250","left":false},{"author":"Ryan Sleevi (OoO until 11-18)","author_email":"rsleevi@chromium.org","text":"BUG: Rather then checking the subject, you should be checking issuer names here as well.\n\nIt's legal for intermediate_ca_certs[.size() - 1].issuer == some_valid_issuer, which would be missed by this algorithm.","draft":false,"lineno":82,"date":"2012-12-13 19:49:05.501550","left":false},{"author":"digit1","author_email":"digit@chromium.org","text":"On 2012/12/13 19:49:05, Ryan Sleevi wrote:\n> It's a shame to have to reparse the CERTName here (we have it in\n> cert_handle->issuer)\n\nI know, but cert_handle->issuer is a CertPrincipal which, has you already mentioned, should only be used for presentation. That's why I intentionally avoided using it here.\n\nI also wanted to use CERT_CompareName(), unfortunately NSS doesn't seem to provide _any_ API to create a CERTName object from its DER-encoded representation. The only alternative seems to create multiple CERTRDN objects first, then pass then to CERT_CreateName() / CERT_AddRDN(), amd each CERTRDN is created from a list of CERTAVA objects.\n\nThis is much more work, it requires parsing the DER encoded issuer names explicitely, and I'm not sure it will be much better than comparing the DER-encoded representations directly.\n\nI'd be happy if you or wtc@ had a better suggestion for this issue.\n\n","draft":false,"lineno":75,"date":"2012-12-14 17:54:33.589960","left":false},{"author":"digit1","author_email":"digit@chromium.org","text":"That makes sense, I'll fix all checks.","draft":false,"lineno":82,"date":"2012-12-14 17:54:33.590160","left":false},{"author":"Ryan Sleevi (OoO until 11-18)","author_email":"rsleevi@chromium.org","text":"On 2012/12/14 17:54:33, digit1 wrote:\n> On 2012/12/13 19:49:05, Ryan Sleevi wrote:\n> > It's a shame to have to reparse the CERTName here (we have it in\n> > cert_handle->issuer)\n> \n> I know, but cert_handle->issuer is a CertPrincipal which, has you already\n> mentioned, should only be used for presentation. That's why I intentionally\n> avoided using it here.\n\ncert_handle->issuer is a CERTName, which is the canonical type, not a CertPrincipal.\n\nNote, I was talking about cert_handle->issuer, not this->issuer_\n\n> \n> I also wanted to use CERT_CompareName(), unfortunately NSS doesn't seem to\n> provide _any_ API to create a CERTName object from its DER-encoded\n> representation. The only alternative seems to create multiple CERTRDN objects\n> first, then pass then to CERT_CreateName() / CERT_AddRDN(), amd each CERTRDN is\n> created from a list of CERTAVA objects.\n\ntypedef scoped_ptr_malloc<CERTName, NSSDestroyer<CERTName, CERT_DestroyName> > ScopedCERTName;\n\n\nSECItem data;\ndata.len = ...\ndata.data = ...;\n\nScopedPLArenaPool arena(PORT_NewArena(DER_DEFAULT_CHUNKSIZE));\nif (!arena.get());\n  return false;\nScopedCERTName name(PORT_ArenaZNew(arena, CERTName));\nif (!name.get())\n  return false;\nSECStatus rv = SEC_ASN1DecodeItem(arena.get(), name.get(), SEC_ASN1_GET(CERT_NameTemplate), &data);\nif (rv != SECSuccess)\n  return false;\n\n/* Setting ->arena will ensure that name releases arena when it's done. If this is all stack local, then you don't need to do this and just let the arena pool handle cleanup */\nname->arena = arena.release();\n\n/* do something with a CERTName here */\n\nreturn true;\n\n> \n> This is much more work, it requires parsing the DER encoded issuer names\n> explicitely, and I'm not sure it will be much better than comparing the\n> DER-encoded representations directly.\n\nIt also yields the RFC-correct output, which comparing the DER-encoded representations does not.\n\n> \n> I'd be happy if you or wtc@ had a better suggestion for this issue.\n> \n\n","draft":false,"lineno":75,"date":"2012-12-14 18:16:42.291550","left":false},{"author":"digit1","author_email":"digit@chromium.org","text":"Thank you so much for this, I've implemented this in net/base/x509_util_nss.cc, this makes the use of CERT_CompareName() possible.","draft":false,"lineno":75,"date":"2012-12-18 16:19:24.729230","left":false}],"id":4002,"is_binary":false},"net/base/x509_certificate.h":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":4,"num_removed":0,"messages":[],"id":4001,"is_binary":false},"net/base/x509_certificate_nss.cc":{"status":"M","num_chunks":2,"no_base_file":false,"property_changes":"","num_added":16,"num_removed":0,"messages":[{"author":"Ryan Sleevi (OoO until 11-18)","author_email":"rsleevi@chromium.org","text":"STYLE: See comments re braces (also line 166-168)","draft":false,"lineno":161,"date":"2012-12-13 19:49:05.502130","left":false},{"author":"Ryan Sleevi (OoO until 11-18)","author_email":"rsleevi@chromium.org","text":"BUG: See comment in ios re subject vs issuer","draft":false,"lineno":167,"date":"2012-12-13 19:49:05.502410","left":false}],"id":4004,"is_binary":false},"net/base/x509_util_nss.h":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":10,"num_removed":0,"messages":[{"author":"Ryan Sleevi (OoO until 11-18)","author_email":"rsleevi@chromium.org","text":"see comments in iOS about making this a CERTName and saving some name parsing","draft":false,"lineno":80,"date":"2012-12-13 19:49:05.504260","left":false},{"author":"Ryan Sleevi (OoO until 11-18)","author_email":"rsleevi@chromium.org","text":"Perhaps rather then passing a single SECItem for a name, along with a vector of strings, you have it pass in a vector of CERTName (collected from the CERTCertificate*s) and a vector of strings (collected from the SSL handshake)","draft":false,"lineno":81,"date":"2012-12-13 19:49:05.504490","left":false},{"author":"digit1","author_email":"digit@chromium.org","text":"Yes, I've actually changed the function to take a vector of CERTCertificate*, which makes it easier to reuse for iOS too.","draft":false,"lineno":81,"date":"2012-12-14 17:54:33.591670","left":false},{"author":"Ryan Sleevi (OoO until 11-18)","author_email":"rsleevi@chromium.org","text":"On 2012/12/14 17:54:33, digit1 wrote:\n> Yes, I've actually changed the function to take a vector of CERTCertificate*,\n> which makes it easier to reuse for iOS too.\n\nThat works too","draft":false,"lineno":81,"date":"2012-12-14 18:16:42.291980","left":false}],"id":4008,"is_binary":false},"net/base/x509_certificate_mac.cc":{"status":"M","num_chunks":3,"no_base_file":false,"property_changes":"","num_added":44,"num_removed":0,"messages":[{"author":"Ryan Sleevi (OoO until 11-18)","author_email":"rsleevi@chromium.org","text":"STYLE: multi-line conditionals should have braces (also lines 373-375)\n\nBUG: See IOS bug about subject vs ISSUER","draft":false,"lineno":368,"date":"2012-12-13 19:49:05.501850","left":false},{"author":"digit1","author_email":"digit@chromium.org","text":"On 2012/12/13 19:49:05, Ryan Sleevi wrote:\n> STYLE: multi-line conditionals should have braces (also lines 373-375)\n> \n> BUG: See IOS bug about subject vs ISSUER\n\nDone.","draft":false,"lineno":368,"date":"2012-12-14 17:54:33.590340","left":false}],"id":4003,"is_binary":false},"net/base/x509_certificate_openssl.cc":{"status":"M","num_chunks":2,"no_base_file":false,"property_changes":"","num_added":71,"num_removed":0,"messages":[{"author":"Ryan Sleevi (OoO until 11-18)","author_email":"rsleevi@chromium.org","text":"BUG: See previous comments re: subject vs issuer","draft":false,"lineno":523,"date":"2012-12-13 19:49:05.502700","left":false},{"author":"Ryan Sleevi (OoO until 11-18)","author_email":"rsleevi@chromium.org","text":"Not sure this comment really makes sense. Is it a continuation of some comment? which?","draft":false,"lineno":529,"date":"2012-12-13 19:49:05.502930","left":false},{"author":"Ryan Sleevi (OoO until 11-18)","author_email":"rsleevi@chromium.org","text":"This breaks the inner loop but keeps spinning the outer loop.\n\nJust return true here, and return false on line 542?","draft":false,"lineno":537,"date":"2012-12-13 19:49:05.503160","left":false},{"author":"digit1","author_email":"digit@chromium.org","text":"On 2012/12/13 19:49:05, Ryan Sleevi wrote:\n> BUG: See previous comments re: subject vs issuer\n\nDone.","draft":false,"lineno":523,"date":"2012-12-14 17:54:33.590520","left":false},{"author":"digit1","author_email":"digit@chromium.org","text":"Yes, it's a left-over, I've removed it.\n","draft":false,"lineno":529,"date":"2012-12-14 17:54:33.590720","left":false},{"author":"digit1","author_email":"digit@chromium.org","text":"Doh. Thanks for this.","draft":false,"lineno":537,"date":"2012-12-14 17:54:33.590900","left":false}],"id":4005,"is_binary":false}},"owner_email":"digit@chromium.org","owner":"digit1","message":"Add missing base files (damn you git cl upload)","try_job_results":[{"parent_name":null,"tests":["sync_integration_tests","defaulttests"],"slave":"slave54-c4","url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=linux_rel&number=84013","timestamp":"2012-12-13 20:08:09.740063","builder":"linux_rel","clobber":false,"project":"Chromium Try Server","reason":"cert-is-issued-by","result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIwCxIFSXNzdWUY-tzCBQwLEghQYXRjaFNldBi5FwwLEgxUcnlKb2JSZXN1bHQYth8M","requester":"digit@chromium.org","buildnumber":"84013","revision":"172836"},{"parent_name":null,"tests":["defaulttests"],"slave":"slave78-c4","url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=linux_chromeos&number=67758","timestamp":"2012-12-13 20:03:55.396022","builder":"linux_chromeos","clobber":false,"project":"Chromium Try Server","reason":"cert-is-issued-by","result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIwCxIFSXNzdWUY-tzCBQwLEghQYXRjaFNldBi5FwwLEgxUcnlKb2JSZXN1bHQYqh8M","requester":"digit@chromium.org","buildnumber":"67758","revision":"172836"},{"parent_name":"android_dbg","tests":["defaulttests"],"slave":"chromeperf53","url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=android_dbg_triggered_tests&number=18582","timestamp":"2012-12-13 19:40:03.263338","builder":"android_dbg_triggered_tests","clobber":false,"project":"Chromium Try Server","reason":"Triggerable(android_dbg)","result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIwCxIFSXNzdWUY-tzCBQwLEghQYXRjaFNldBi5FwwLEgxUcnlKb2JSZXN1bHQYkScM","requester":null,"buildnumber":"18582","revision":"172836"},{"parent_name":null,"tests":["defaulttests"],"slave":"vm400-m4","url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=linux_redux&number=558","timestamp":"2012-12-13 19:26:14.725879","builder":"linux_redux","clobber":false,"project":"Chromium Try Server","reason":"cert-is-issued-by","result":"2","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIwCxIFSXNzdWUY-tzCBQwLEghQYXRjaFNldBi5FwwLEgxUcnlKb2JSZXN1bHQYtB8M","requester":"digit@chromium.org","buildnumber":"558","revision":"172836"},{"parent_name":null,"tests":["defaulttests"],"slave":"slave95-c4","url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=linux_asan&number=12810","timestamp":"2012-12-13 19:24:25.526126","builder":"linux_asan","clobber":false,"project":"Chromium Try Server","reason":"cert-is-issued-by","result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIwCxIFSXNzdWUY-tzCBQwLEghQYXRjaFNldBi5FwwLEgxUcnlKb2JSZXN1bHQYrB8M","requester":"digit@chromium.org","buildnumber":"12810","revision":"172836"},{"parent_name":null,"tests":["defaulttests"],"slave":"slave67-c4","url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=linux_aura&number=4464","timestamp":"2012-12-13 19:22:43.745139","builder":"linux_aura","clobber":false,"project":"Chromium Try Server","reason":"cert-is-issued-by","result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIwCxIFSXNzdWUY-tzCBQwLEghQYXRjaFNldBi5FwwLEgxUcnlKb2JSZXN1bHQYqR8M","requester":"digit@chromium.org","buildnumber":"4464","revision":"172836"},{"parent_name":null,"tests":["defaulttests"],"slave":"vm433-m4","url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=android_clang_dbg&number=6802","timestamp":"2012-12-13 19:10:55.324842","builder":"android_clang_dbg","clobber":false,"project":"Chromium Try Server","reason":"cert-is-issued-by","result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIwCxIFSXNzdWUY-tzCBQwLEghQYXRjaFNldBi5FwwLEgxUcnlKb2JSZXN1bHQYqx8M","requester":"digit@chromium.org","buildnumber":"6802","revision":"172836"},{"parent_name":null,"tests":["defaulttests"],"slave":"slave111-c4","url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=android_dbg&number=21980","timestamp":"2012-12-13 19:10:48.660201","builder":"android_dbg","clobber":false,"project":"Chromium Try Server","reason":"cert-is-issued-by","result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIwCxIFSXNzdWUY-tzCBQwLEghQYXRjaFNldBi5FwwLEgxUcnlKb2JSZXN1bHQYsR8M","requester":"digit@chromium.org","buildnumber":"21980","revision":"172836"},{"parent_name":null,"tests":["compile"],"slave":"slave28-c4","url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=linux_clang&number=70859","timestamp":"2012-12-13 19:09:15.599554","builder":"linux_clang","clobber":false,"project":"Chromium Try Server","reason":"cert-is-issued-by","result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIwCxIFSXNzdWUY-tzCBQwLEghQYXRjaFNldBi5FwwLEgxUcnlKb2JSZXN1bHQYsh8M","requester":"digit@chromium.org","buildnumber":"70859","revision":"172836"},{"parent_name":null,"tests":["defaulttests"],"slave":"vm121-m4","url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=win_aura&number=9547","timestamp":"2012-12-13 19:07:18.885378","builder":"win_aura","clobber":false,"project":"Chromium Try Server","reason":"cert-is-issued-by","result":"2","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIwCxIFSXNzdWUY-tzCBQwLEghQYXRjaFNldBi5FwwLEgxUcnlKb2JSZXN1bHQYrR8M","requester":"digit@chromium.org","buildnumber":"9547","revision":"172836"},{"parent_name":null,"tests":["defaulttests","sync_integration_tests"],"slave":"vm358-m4","url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=win_rel&number=91123","timestamp":"2012-12-13 19:05:55.185006","builder":"win_rel","clobber":false,"project":"Chromium Try Server","reason":"cert-is-issued-by","result":"2","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIwCxIFSXNzdWUY-tzCBQwLEghQYXRjaFNldBi5FwwLEgxUcnlKb2JSZXN1bHQYrh8M","requester":"digit@chromium.org","buildnumber":"91123","revision":"172836"},{"parent_name":null,"tests":["sync_integration_tests","defaulttests"],"slave":"vm688-m4","url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=mac_rel&number=82718","timestamp":"2012-12-13 19:01:16.502211","builder":"mac_rel","clobber":false,"project":"Chromium Try Server","reason":"cert-is-issued-by","result":"2","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIwCxIFSXNzdWUY-tzCBQwLEghQYXRjaFNldBi5FwwLEgxUcnlKb2JSZXN1bHQYtR8M","requester":"digit@chromium.org","buildnumber":"82718","revision":"172836"},{"parent_name":null,"tests":["defaulttests"],"slave":"mini36-l1","url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=ios_rel_device&number=13730","timestamp":"2012-12-13 18:59:54.608805","builder":"ios_rel_device","clobber":false,"project":"Chromium Try Server","reason":"cert-is-issued-by","result":"2","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIwCxIFSXNzdWUY-tzCBQwLEghQYXRjaFNldBi5FwwLEgxUcnlKb2JSZXN1bHQYsB8M","requester":"digit@chromium.org","buildnumber":"13730","revision":"172836"},{"parent_name":null,"tests":["defaulttests"],"slave":"vm653-m4","url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=mac_asan&number=13258","timestamp":"2012-12-13 18:59:32.224568","builder":"mac_asan","clobber":false,"project":"Chromium Try Server","reason":"cert-is-issued-by","result":"2","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIwCxIFSXNzdWUY-tzCBQwLEghQYXRjaFNldBi5FwwLEgxUcnlKb2JSZXN1bHQYsx8M","requester":"digit@chromium.org","buildnumber":"13258","revision":"172836"},{"parent_name":null,"tests":["defaulttests"],"slave":"mini29-l1","url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=ios_dbg_simulator&number=14247","timestamp":"2012-12-13 18:58:46.816763","builder":"ios_dbg_simulator","clobber":false,"project":"Chromium Try Server","reason":"cert-is-issued-by","result":"2","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIwCxIFSXNzdWUY-tzCBQwLEghQYXRjaFNldBi5FwwLEgxUcnlKb2JSZXN1bHQYrx8M","requester":"digit@chromium.org","buildnumber":"14247","revision":"172836"}],"created":"2012-12-13 18:35:25.096470","url":null,"num_comments":27,"modified":"2012-12-18 16:19:24.790770","patchset":3001,"issue":11579002}
{"description":"Refactor PPB_NetworkMonitor_Private interface to use CompletionCallback.\n\nPreviously NetworkMonitor required that a callback is passed to the \nCreate() method. It was hard to use and inconsistent with other APIs. \nAdded new UpdateNetworkList() method which accepts a \nCompletionCallback to be called when network list changes.\n\nBUG=281781\n\nCommitted: https://src.chromium.org/viewvc/chrome?view=rev&revision=221582","cc":["chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","dcaiafa+watch@chromium.org","yusukes+watch@chromium.org","hclam+watch@chromium.org","sergeyu+watch@chromium.org","amit@chromium.org","sanjeevr@chromium.org","jam@chromium.org","garykac+watch@chromium.org","yzshen+watch@chromium.org","joi+watch-content@chromium.org","wez+watch@chromium.org","lambroslambrou+watch@chromium.org","darin-cc@chromium.org","raymes+watch@chromium.org","weitaosu+watch@chromium.org","piman+watch@chromium.org","alexeypa+watch@chromium.org","rmsousa+watch@chromium.org","ihf+watch@chromium.org"],"reviewers":["yzshen@chromium.org"],"messages":[{"sender":"sergeyu@chromium.org","recipients":["sergeyu@chromium.org","yzshen@chromium.org","chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","dcaiafa+watch@chromium.org","yusukes+watch@chromium.org","hclam+watch@chromium.org","sergeyu+watch@chromium.org","amit@chromium.org","sanjeevr@chromium.org","jam@chromium.org","garykac+watch@chromium.org","yzshen+watch@chromium.org","joi+watch-content@chromium.org","wez+watch@chromium.org","lambroslambrou+watch@chromium.org","darin-cc@chromium.org","raymes+watch@chromium.org","weitaosu+watch@chromium.org","piman+watch@chromium.org","alexeypa+watch@chromium.org","rmsousa+watch@chromium.org","ihf+watch@chromium.org"],"text":"","disapproval":false,"date":"2013-09-03 23:44:27.913280","approval":false},{"sender":"yzshen@chromium.org","recipients":["sergeyu@chromium.org","yzshen@chromium.org","chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","dcaiafa+watch@chromium.org","yusukes+watch@chromium.org","hclam+watch@chromium.org","sergeyu+watch@chromium.org","amit@chromium.org","sanjeevr@chromium.org","jam@chromium.org","garykac+watch@chromium.org","yzshen+watch@chromium.org","joi+watch-content@chromium.org","wez+watch@chromium.org","lambroslambrou+watch@chromium.org","darin-cc@chromium.org","raymes+watch@chromium.org","weitaosu+watch@chromium.org","piman+watch@chromium.org","alexeypa+watch@chromium.org","rmsousa+watch@chromium.org","ihf+watch@chromium.org"],"text":"https://codereview.chromium.org/23453025/diff/7001/ppapi/api/private/ppb_network_monitor_private.idl\nFile ppapi/api/private/ppb_network_monitor_private.idl (right):\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/api/private/ppb_network_monitor_private.idl#newcode32\nppapi/api/private/ppb_network_monitor_private.idl:32: * Gets current network configuration. When called for the first time, completes as\n- longer than 80 chars\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/cpp/private/network_monitor_private.cc\nFile ppapi/cpp/private/network_monitor_private.cc (right):\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/cpp/private/network_monitor_private.cc#newcode17\nppapi/cpp/private/network_monitor_private.cc:17: template <> const char* interface_name<PPB_NetworkMonitor_Private>() {\nnit: please consider appending the version number.\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/cpp/private/network_monitor_private.h\nFile ppapi/cpp/private/network_monitor_private.h (right):\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/cpp/private/network_monitor_private.h#newcode20\nppapi/cpp/private/network_monitor_private.h:20: NetworkMonitorPrivate(const InstanceHandle& instance);\nexplicit, please.\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/proxy/ppb_network_monitor_private_proxy.cc\nFile ppapi/proxy/ppb_network_monitor_private_proxy.cc (right):\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/proxy/ppb_network_monitor_private_proxy.cc#newcode46\nppapi/proxy/ppb_network_monitor_private_proxy.cc:46: thunk::EnterResourceCreation enter(pp_instance());\nPlease use EnterResourceCreationNoLock. At this point, the lock has been acquired.\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/proxy/ppb_network_monitor_private_proxy.cc#newcode78\nppapi/proxy/ppb_network_monitor_private_proxy.cc:78: OBJECT_IS_PROXY, pp_instance(), list);\nnit: please consider setting network_list_ to NULL.\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/proxy/ppb_network_monitor_private_proxy.h\nFile ppapi/proxy/ppb_network_monitor_private_proxy.h (right):\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/proxy/ppb_network_monitor_private_proxy.h#newcode49\nppapi/proxy/ppb_network_monitor_private_proxy.h:49: // same thread that created the NetworkMonitor.\nThis is no longer needed, because TrackedCallback will make sure that it is run on the correct thread.\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/tests/test_network_monitor_private.cc\nFile ppapi/tests/test_network_monitor_private.cc (right):\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/tests/test_network_monitor_private.cc#newcode172\nppapi/tests/test_network_monitor_private.cc:172: CallbackHandler callback_handler(instance_->pp_instance());\nPlease consider using TestCompletionCallbackWithOutput.\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/thunk/ppb_network_monitor_private_thunk.cc\nFile ppapi/thunk/ppb_network_monitor_private_thunk.cc (right):\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/thunk/ppb_network_monitor_private_thunk.cc#newcode18\nppapi/thunk/ppb_network_monitor_private_thunk.cc:18: PP_Resource Create(PP_Instance instance) {\nFYI: You could use [generate_thunk] in the idl file to auto gen this file and save you some work.","disapproval":false,"date":"2013-09-04 19:52:01.091480","approval":false},{"sender":"sergeyu@chromium.org","recipients":["sergeyu@chromium.org","yzshen@chromium.org","chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","dcaiafa+watch@chromium.org","yusukes+watch@chromium.org","hclam+watch@chromium.org","sergeyu+watch@chromium.org","amit@chromium.org","sanjeevr@chromium.org","jam@chromium.org","garykac+watch@chromium.org","yzshen+watch@chromium.org","joi+watch-content@chromium.org","wez+watch@chromium.org","lambroslambrou+watch@chromium.org","darin-cc@chromium.org","raymes+watch@chromium.org","weitaosu+watch@chromium.org","piman+watch@chromium.org","alexeypa+watch@chromium.org","rmsousa+watch@chromium.org","ihf+watch@chromium.org"],"text":"https://codereview.chromium.org/23453025/diff/7001/ppapi/api/private/ppb_network_monitor_private.idl\nFile ppapi/api/private/ppb_network_monitor_private.idl (right):\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/api/private/ppb_network_monitor_private.idl#newcode32\nppapi/api/private/ppb_network_monitor_private.idl:32: * Gets current network configuration. When called for the first time, completes as\nOn 2013/09/04 19:52:01, yzshen1 wrote:\n> - longer than 80 chars\n\nDone.\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/cpp/private/network_monitor_private.cc\nFile ppapi/cpp/private/network_monitor_private.cc (right):\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/cpp/private/network_monitor_private.cc#newcode17\nppapi/cpp/private/network_monitor_private.cc:17: template <> const char* interface_name<PPB_NetworkMonitor_Private>() {\nOn 2013/09/04 19:52:01, yzshen1 wrote:\n> nit: please consider appending the version number.\n\nDone.\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/cpp/private/network_monitor_private.h\nFile ppapi/cpp/private/network_monitor_private.h (right):\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/cpp/private/network_monitor_private.h#newcode20\nppapi/cpp/private/network_monitor_private.h:20: NetworkMonitorPrivate(const InstanceHandle& instance);\nOn 2013/09/04 19:52:01, yzshen1 wrote:\n> explicit, please.\n\nDone.\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/proxy/ppb_network_monitor_private_proxy.cc\nFile ppapi/proxy/ppb_network_monitor_private_proxy.cc (right):\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/proxy/ppb_network_monitor_private_proxy.cc#newcode46\nppapi/proxy/ppb_network_monitor_private_proxy.cc:46: thunk::EnterResourceCreation enter(pp_instance());\nOn 2013/09/04 19:52:01, yzshen1 wrote:\n> Please use EnterResourceCreationNoLock. At this point, the lock has been\n> acquired.\n\nDone. Thanks for catching this.\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/proxy/ppb_network_monitor_private_proxy.cc#newcode78\nppapi/proxy/ppb_network_monitor_private_proxy.cc:78: OBJECT_IS_PROXY, pp_instance(), list);\nOn 2013/09/04 19:52:01, yzshen1 wrote:\n> nit: please consider setting network_list_ to NULL.\n\nDone.\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/proxy/ppb_network_monitor_private_proxy.h\nFile ppapi/proxy/ppb_network_monitor_private_proxy.h (right):\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/proxy/ppb_network_monitor_private_proxy.h#newcode49\nppapi/proxy/ppb_network_monitor_private_proxy.h:49: // same thread that created the NetworkMonitor.\nOn 2013/09/04 19:52:01, yzshen1 wrote:\n> This is no longer needed, because TrackedCallback will make sure that it is run\n> on the correct thread.\n\nDone.\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/tests/test_network_monitor_private.cc\nFile ppapi/tests/test_network_monitor_private.cc (right):\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/tests/test_network_monitor_private.cc#newcode172\nppapi/tests/test_network_monitor_private.cc:172: CallbackHandler callback_handler(instance_->pp_instance());\nOn 2013/09/04 19:52:01, yzshen1 wrote:\n> Please consider using TestCompletionCallbackWithOutput.\n\nDone.\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/thunk/ppb_network_monitor_private_thunk.cc\nFile ppapi/thunk/ppb_network_monitor_private_thunk.cc (right):\n\nhttps://codereview.chromium.org/23453025/diff/7001/ppapi/thunk/ppb_network_monitor_private_thunk.cc#newcode18\nppapi/thunk/ppb_network_monitor_private_thunk.cc:18: PP_Resource Create(PP_Instance instance) {\nOn 2013/09/04 19:52:01, yzshen1 wrote:\n> FYI: You could use [generate_thunk] in the idl file to auto gen this file and\n> save you some work.\n\nDone.","disapproval":false,"date":"2013-09-04 22:22:31.749650","approval":false},{"sender":"yzshen@chromium.org","recipients":["sergeyu@chromium.org","yzshen@chromium.org","chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","dcaiafa+watch@chromium.org","yusukes+watch@chromium.org","hclam+watch@chromium.org","sergeyu+watch@chromium.org","amit@chromium.org","sanjeevr@chromium.org","jam@chromium.org","garykac+watch@chromium.org","yzshen+watch@chromium.org","joi+watch-content@chromium.org","wez+watch@chromium.org","lambroslambrou+watch@chromium.org","darin-cc@chromium.org","raymes+watch@chromium.org","weitaosu+watch@chromium.org","piman+watch@chromium.org","alexeypa+watch@chromium.org","rmsousa+watch@chromium.org","ihf+watch@chromium.org"],"text":"LGTM\n\nThanks!\n\nhttps://codereview.chromium.org/23453025/diff/21001/ppapi/thunk/ppb_network_monitor_api.h\nFile ppapi/thunk/ppb_network_monitor_api.h (right):\n\nhttps://codereview.chromium.org/23453025/diff/21001/ppapi/thunk/ppb_network_monitor_api.h#newcode22\nppapi/thunk/ppb_network_monitor_api.h:22: PP_Resource* network_list,\nwrong indent.","disapproval":false,"date":"2013-09-05 18:45:19.549340","approval":true},{"sender":"sergeyu@chromium.org","recipients":["sergeyu@chromium.org","yzshen@chromium.org","chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","dcaiafa+watch@chromium.org","yusukes+watch@chromium.org","hclam+watch@chromium.org","sergeyu+watch@chromium.org","amit@chromium.org","sanjeevr@chromium.org","jam@chromium.org","garykac+watch@chromium.org","yzshen+watch@chromium.org","joi+watch-content@chromium.org","wez+watch@chromium.org","lambroslambrou+watch@chromium.org","darin-cc@chromium.org","raymes+watch@chromium.org","weitaosu+watch@chromium.org","piman+watch@chromium.org","alexeypa+watch@chromium.org","rmsousa+watch@chromium.org","ihf+watch@chromium.org"],"text":"https://codereview.chromium.org/23453025/diff/21001/ppapi/thunk/ppb_network_monitor_api.h\nFile ppapi/thunk/ppb_network_monitor_api.h (right):\n\nhttps://codereview.chromium.org/23453025/diff/21001/ppapi/thunk/ppb_network_monitor_api.h#newcode22\nppapi/thunk/ppb_network_monitor_api.h:22: PP_Resource* network_list,\nOn 2013/09/05 18:45:20, yzshen1 wrote:\n> wrong indent.\n\nDone.","disapproval":false,"date":"2013-09-05 18:56:52.680200","approval":false},{"sender":"commit-bot@chromium.org","recipients":["sergeyu@chromium.org","yzshen@chromium.org","chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","dcaiafa+watch@chromium.org","yusukes+watch@chromium.org","hclam+watch@chromium.org","sergeyu+watch@chromium.org","amit@chromium.org","sanjeevr@chromium.org","jam@chromium.org","garykac+watch@chromium.org","yzshen+watch@chromium.org","joi+watch-content@chromium.org","wez+watch@chromium.org","lambroslambrou+watch@chromium.org","darin-cc@chromium.org","raymes+watch@chromium.org","weitaosu+watch@chromium.org","piman+watch@chromium.org","alexeypa+watch@chromium.org","rmsousa+watch@chromium.org","ihf+watch@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/sergeyu@chromium.org/23453025/55001","disapproval":false,"date":"2013-09-05 18:58:27.862260","approval":false},{"sender":"commit-bot@chromium.org","recipients":["sergeyu@chromium.org","yzshen@chromium.org","chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","dcaiafa+watch@chromium.org","yusukes+watch@chromium.org","hclam+watch@chromium.org","sergeyu+watch@chromium.org","amit@chromium.org","sanjeevr@chromium.org","jam@chromium.org","garykac+watch@chromium.org","yzshen+watch@chromium.org","joi+watch-content@chromium.org","wez+watch@chromium.org","lambroslambrou+watch@chromium.org","darin-cc@chromium.org","raymes+watch@chromium.org","weitaosu+watch@chromium.org","piman+watch@chromium.org","alexeypa+watch@chromium.org","rmsousa+watch@chromium.org","ihf+watch@chromium.org"],"text":"Change committed as 221582","disapproval":false,"date":"2013-09-06 05:30:29.571970","approval":false}],"owner_email":"sergeyu@chromium.org","private":false,"base_url":"svn://svn.chromium.org/chrome/trunk/src","owner":"Sergey Ulanov","subject":"Refactor PPB_NetworkMonitor_Private interface to use CompletionCallback.","created":"2013-09-03 22:13:56.280830","patchsets":[3001,5001,7001,21001,55001],"modified":"2013-09-06 05:30:29.921220","closed":true,"commit":false,"issue":23453025}
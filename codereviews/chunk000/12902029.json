{"description":"Fix InputMethod Widget activation checks; cleanup, etc.\n\nRemove InputMethodBase::On[Focus|Blur] and |widget_focused_|.\nCheck widget()->IsActive() as needed instead of widget_focused_.\n( this resolves improper init order firing DCHECKs in views_unittests )\n( fixes FocusManagerDtorTest.* with --enable-views-textfield )\nFix NativeTextfieldViewsTest widget activation and textfield focus.\n\nRename virtual InputMethod::set_delegate() to SetDelegate().\nCall the base Init from InputMethodBase::Init first.\n( initializes |widget_| before it's used in OnInputLangChange )\nRemove InputMethodBase's unnecessary NON_EXPORTED_BASE usage.\nAdd empty MockInputMethod::On[Focus|Blur] implementations.\nUpdate comments for conciseness and clarity.\n\nBUG=131660\nTEST=No input regressions; unit tests pass with --enable-views-textfield.\nR=sky@chromium.org,suzhe@chromium.org\n\nCommitted: https://src.chromium.org/viewvc/chrome?view=rev&revision=191049","cc":["chromium-reviews@chromium.org","tfarina@chromium.org","ben+watch@chromium.org","penghuang+watch@chromium.org","yusukes+watch@chromium.org","ananta@chromium.org"],"reviewers":["sky@chromium.org","suzhe@chromium.org"],"messages":[{"sender":"msw@chromium.org","recipients":["msw@chromium.org","sky@chromium.org","suzhe@chromium.org","chromium-reviews@chromium.org","tfarina@chromium.org","suzhe@chromium.org","ben+watch@chromium.org","penghuang+watch@chromium.org","yusukes+watch@chromium.org"],"text":"Hey James and Scott, please take a look; thanks!","disapproval":false,"date":"2013-03-26 18:39:26.112500","approval":false},{"sender":"msw@chromium.org","recipients":["msw@chromium.org","sky@chromium.org","suzhe@chromium.org","chromium-reviews@chromium.org","tfarina@chromium.org","suzhe@chromium.org","ben+watch@chromium.org","penghuang+watch@chromium.org","yusukes+watch@chromium.org"],"text":"Gah, hold off for linux_chromeos test failures...\nI'm really disliking our IME code...","disapproval":false,"date":"2013-03-26 19:33:07.206590","approval":false},{"sender":"msw@chromium.org","recipients":["msw@chromium.org","sky@chromium.org","suzhe@chromium.org","chromium-reviews@chromium.org","tfarina@chromium.org","suzhe@chromium.org","ben+watch@chromium.org","penghuang+watch@chromium.org","yusukes+watch@chromium.org","ananta@chromium.org"],"text":"Please take a look now, thanks! Fixing views_unittests was simple enough.","disapproval":false,"date":"2013-03-27 01:55:09.442390","approval":false},{"sender":"suzhe@chromium.org","recipients":["msw@chromium.org","sky@chromium.org","suzhe@chromium.org","chromium-reviews@chromium.org","tfarina@chromium.org","ben+watch@chromium.org","penghuang+watch@chromium.org","yusukes+watch@chromium.org","ananta@chromium.org"],"text":"On 2013/03/27 01:55:09, msw wrote:\n> Please take a look now, thanks! Fixing views_unittests was simple enough.\n\nLGTM","disapproval":false,"date":"2013-03-27 03:12:32.513980","approval":true},{"sender":"sky@chromium.org","recipients":["msw@chromium.org","sky@chromium.org","suzhe@chromium.org","chromium-reviews@chromium.org","tfarina@chromium.org","ben+watch@chromium.org","penghuang+watch@chromium.org","yusukes+watch@chromium.org","ananta@chromium.org"],"text":"https://codereview.chromium.org/12902029/diff/11002/ui/views/ime/input_method_base.cc\nFile ui/views/ime/input_method_base.cc (right):\n\nhttps://codereview.chromium.org/12902029/diff/11002/ui/views/ime/input_method_base.cc#newcode18\nui/views/ime/input_method_base.cc:18: if (widget())\nIs this needed? You don't null check widget any where else. Also, I would be inclined to use widget_ every where rather than widget_ (otherwise places like this look inconsistant).","disapproval":false,"date":"2013-03-27 15:10:23.749370","approval":false},{"sender":"msw@chromium.org","recipients":["msw@chromium.org","sky@chromium.org","suzhe@chromium.org","chromium-reviews@chromium.org","tfarina@chromium.org","ben+watch@chromium.org","penghuang+watch@chromium.org","yusukes+watch@chromium.org","ananta@chromium.org"],"text":"Comments addressed; please take another look.\n\nhttps://codereview.chromium.org/12902029/diff/11002/ui/views/ime/input_method_base.cc\nFile ui/views/ime/input_method_base.cc (right):\n\nhttps://codereview.chromium.org/12902029/diff/11002/ui/views/ime/input_method_base.cc#newcode18\nui/views/ime/input_method_base.cc:18: if (widget())\nOn 2013/03/27 15:10:23, sky wrote:\n> Is this needed? You don't null check widget any where else. Also, I would be\n> inclined to use widget_ every where rather than widget_ (otherwise places like\n> this look inconsistant).\n\nDone; I removed the check, but will restore it if trybots fail. It's possible that some InputMethod instances may not be Init()'ed with a valid Widget, given the state of this code.\n\nDone; presuming you meant \"rather than widget()\", I changed to use widget_ everywhere in this file. I generally prefer to consistently use accessors for const usages and member identifiers for assignment, so that assignment statements like \"x_ = y\" and \"x_(y)\" are more readily apparent/searchable. I think you've dissented of that practice before, but I'm still inclined to generally follow it; let me know if that's an issue and we can figure it out.","disapproval":false,"date":"2013-03-27 17:36:25.779790","approval":false},{"sender":"msw@chromium.org","recipients":["msw@chromium.org","sky@chromium.org","suzhe@chromium.org","chromium-reviews@chromium.org","tfarina@chromium.org","ben+watch@chromium.org","penghuang+watch@chromium.org","yusukes+watch@chromium.org","ananta@chromium.org"],"text":"Scott, please take another look; trybots passed and skipping the check works fine locally; thanks!","disapproval":false,"date":"2013-03-27 20:36:58.911310","approval":false},{"sender":"sky@chromium.org","recipients":["msw@chromium.org","sky@chromium.org","suzhe@chromium.org","chromium-reviews@chromium.org","tfarina@chromium.org","ben+watch@chromium.org","penghuang+watch@chromium.org","yusukes+watch@chromium.org","ananta@chromium.org"],"text":"SLGTM","disapproval":false,"date":"2013-03-27 20:48:37.198900","approval":true},{"sender":"commit-bot@chromium.org","recipients":["msw@chromium.org","sky@chromium.org","suzhe@chromium.org","chromium-reviews@chromium.org","tfarina@chromium.org","ben+watch@chromium.org","penghuang+watch@chromium.org","yusukes+watch@chromium.org","ananta@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/msw@chromium.org/12902029/23001","disapproval":false,"date":"2013-03-27 20:55:43.506160","approval":false},{"sender":"commit-bot@chromium.org","recipients":["msw@chromium.org","sky@chromium.org","suzhe@chromium.org","chromium-reviews@chromium.org","tfarina@chromium.org","ben+watch@chromium.org","penghuang+watch@chromium.org","yusukes+watch@chromium.org","ananta@chromium.org"],"text":"Change committed as 191049","disapproval":false,"date":"2013-03-27 22:19:34.772640","approval":false}],"owner_email":"msw@chromium.org","private":false,"base_url":"svn://svn.chromium.org/chrome/trunk/src","owner":"msw","subject":"Fix InputMethod Widget activation checks; cleanup, etc.","created":"2013-03-21 23:19:45.585640","patchsets":[2001,7001,10001,11002,23001],"modified":"2013-03-27 22:19:35.172890","closed":true,"commit":false,"issue":12902029}
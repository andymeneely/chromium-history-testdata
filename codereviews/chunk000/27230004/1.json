{"files":{"content/browser/media/media_source_browsertest.cc":{"status":"M","num_chunks":3,"no_base_file":false,"property_changes":"","num_added":14,"num_removed":0,"messages":[],"id":1003,"is_binary":false},"content/browser/media/encrypted_media_browsertest.cc":{"status":"M","num_chunks":4,"no_base_file":false,"property_changes":"","num_added":22,"num_removed":1,"messages":[],"id":1002,"is_binary":false},"chrome/browser/media/encrypted_media_browsertest.cc":{"status":"M","num_chunks":3,"no_base_file":false,"property_changes":"","num_added":22,"num_removed":0,"messages":[{"author":"xhwang","author_email":"xhwang@chromium.org","text":"This violates DEPS rules [1]. But since we set WebRuntimeFeatures directly without using any flag [2], I don't see a better way to do this without checking Android version directly (which IMHO is more hacky). Thoughts?\n\n[1] https://code.google.com/p/chromium/codesearch#chromium/src/content/browser/DEPS&l=33\n\n[2] https://code.google.com/p/chromium/codesearch#chromium/src/content/child/runtime_features.cc&l=26\n\n","draft":false,"lineno":14,"date":"2013-10-14 20:12:47.771880","left":false},{"author":"qinmin","author_email":"qinmin@chromium.org","text":"Maybe add a function IsMSESupported() somewhere in content?\nAnd then both the runtime_features and this file can use that function?\nAnyway, I don't see a way to get around the android version check, the WebRuntimeFeatures for MSE are still determined from the android version\n\nOn 2013/10/14 20:12:47, xhwang wrote:\n> This violates DEPS rules [1]. But since we set WebRuntimeFeatures directly\n> without using any flag [2], I don't see a better way to do this without checking\n> Android version directly (which IMHO is more hacky). Thoughts?\n> \n> [1]\n> https://code.google.com/p/chromium/codesearch#chromium/src/content/browser/DEPS&l=33\n> \n> [2]\n> https://code.google.com/p/chromium/codesearch#chromium/src/content/child/runtime_features.cc&l=26\n> \n\n","draft":false,"lineno":14,"date":"2013-10-14 20:59:45.592000","left":false},{"author":"ddorwin","author_email":"ddorwin@chromium.org","text":"On 2013/10/14 20:59:45, qinmin wrote:\n> Maybe add a function IsMSESupported() somewhere in content?\n> And then both the runtime_features and this file can use that function?\n> Anyway, I don't see a way to get around the android version check, the\n> WebRuntimeFeatures for MSE are still determined from the android version\n> \n> On 2013/10/14 20:12:47, xhwang wrote:\n> > This violates DEPS rules [1]. But since we set WebRuntimeFeatures directly\n> > without using any flag [2], I don't see a better way to do this without\n> checking\n> > Android version directly (which IMHO is more hacky). Thoughts?\n> > \n> > [1]\n> >\n> https://code.google.com/p/chromium/codesearch#chromium/src/content/browser/DEPS&l=33\n> > \n> > [2]\n> >\n> https://code.google.com/p/chromium/codesearch#chromium/src/content/child/runtime_features.cc&l=26\n> > \n> \n\nI would rather run the tests unless we explicitly know the platform does not support the tests. If someone accidentally flipped the runtime feature flag, we'd lose coverage and not know about it.\n\nThe actual check [3] is pretty simple and permanent, so I think it's fine to include here. For simplicity, wrap it in a helper like qinmin suggested. A name that references platform limitations might be better, but I can't think of a good one.\n\n[3] https://code.google.com/p/chromium/codesearch#chromium/src/content/child/runtime_features.cc&q=enableMediaSource&sq=package:chromium&type=cs&l=25","draft":false,"lineno":14,"date":"2013-10-14 21:30:34.171830","left":false},{"author":"ddorwin","author_email":"ddorwin@chromium.org","text":"A helper function also allows this to be encapsulated in one place.","draft":false,"lineno":105,"date":"2013-10-14 21:30:34.172150","left":false},{"author":"ddorwin","author_email":"ddorwin@chromium.org","text":"Where do we prevent SRC tests from running on Android? It doesn't look like we do (the content test has it).","draft":false,"lineno":133,"date":"2013-10-14 21:30:34.172480","left":false},{"author":"xhwang","author_email":"xhwang@chromium.org","text":"On 2013/10/14 21:30:34, ddorwin wrote:\n> On 2013/10/14 20:59:45, qinmin wrote:\n> > Maybe add a function IsMSESupported() somewhere in content?\n> > And then both the runtime_features and this file can use that function?\n> > Anyway, I don't see a way to get around the android version check, the\n> > WebRuntimeFeatures for MSE are still determined from the android version\n> > \n> > On 2013/10/14 20:12:47, xhwang wrote:\n> > > This violates DEPS rules [1]. But since we set WebRuntimeFeatures directly\n> > > without using any flag [2], I don't see a better way to do this without\n> > checking\n> > > Android version directly (which IMHO is more hacky). Thoughts?\n> > > \n> > > [1]\n> > >\n> >\n> https://code.google.com/p/chromium/codesearch#chromium/src/content/browser/DEPS&l=33\n> > > \n> > > [2]\n> > >\n> >\n> https://code.google.com/p/chromium/codesearch#chromium/src/content/child/runtime_features.cc&l=26\n> > > \n> > \n> \n> I would rather run the tests unless we explicitly know the platform does not\n> support the tests. If someone accidentally flipped the runtime feature flag,\n> we'd lose coverage and not know about it.\n> \n> The actual check [3] is pretty simple and permanent, so I think it's fine to\n> include here. For simplicity, wrap it in a helper like qinmin suggested. A name\n> that references platform limitations might be better, but I can't think of a\n> good one.\n> \n> [3]\n> https://code.google.com/p/chromium/codesearch#chromium/src/content/child/runtime_features.cc&q=enableMediaSource&sq=package:chromium&type=cs&l=25\n\nInstead of checking android version, we can just check MediaCodecBridge's availability which is the first hand information about whether MSE is available on Android.","draft":false,"lineno":14,"date":"2013-10-16 07:58:40.012970","left":false},{"author":"xhwang","author_email":"xhwang@chromium.org","text":"On 2013/10/14 21:30:34, ddorwin wrote:\n> A helper function also allows this to be encapsulated in one place.\n\nDone.","draft":false,"lineno":105,"date":"2013-10-16 07:58:40.013270","left":false},{"author":"xhwang","author_email":"xhwang@chromium.org","text":"On 2013/10/14 21:30:34, ddorwin wrote:\n> Where do we prevent SRC tests from running on Android? It doesn't look like we\n> do (the content test has it).\n\nI only fixed content_browsertest and haven't fixed browser_test yet. Currently browser_tests doesn't run on Android at all so this is low priority.","draft":false,"lineno":133,"date":"2013-10-16 07:58:40.013460","left":false},{"author":"ddorwin","author_email":"ddorwin@chromium.org","text":"On 2013/10/16 07:58:40, xhwang wrote:\n> On 2013/10/14 21:30:34, ddorwin wrote:\n> > On 2013/10/14 20:59:45, qinmin wrote:\n> > > Maybe add a function IsMSESupported() somewhere in content?\n> > > And then both the runtime_features and this file can use that function?\n> > > Anyway, I don't see a way to get around the android version check, the\n> > > WebRuntimeFeatures for MSE are still determined from the android version\n> > > \n> > > On 2013/10/14 20:12:47, xhwang wrote:\n> > > > This violates DEPS rules [1]. But since we set WebRuntimeFeatures directly\n> > > > without using any flag [2], I don't see a better way to do this without\n> > > checking\n> > > > Android version directly (which IMHO is more hacky). Thoughts?\n> > > > \n> > > > [1]\n> > > >\n> > >\n> >\n> https://code.google.com/p/chromium/codesearch#chromium/src/content/browser/DEPS&l=33\n> > > > \n> > > > [2]\n> > > >\n> > >\n> >\n> https://code.google.com/p/chromium/codesearch#chromium/src/content/child/runtime_features.cc&l=26\n> > > > \n> > > \n> > \n> > I would rather run the tests unless we explicitly know the platform does not\n> > support the tests. If someone accidentally flipped the runtime feature flag,\n> > we'd lose coverage and not know about it.\n> > \n> > The actual check [3] is pretty simple and permanent, so I think it's fine to\n> > include here. For simplicity, wrap it in a helper like qinmin suggested. A\n> name\n> > that references platform limitations might be better, but I can't think of a\n> > good one.\n> > \n> > [3]\n> >\n> https://code.google.com/p/chromium/codesearch#chromium/src/content/child/runtime_features.cc&q=enableMediaSource&sq=package:chromium&type=cs&l=25\n> \n> Instead of checking android version, we can just check MediaCodecBridge's\n> availability which is the first hand information about whether MSE is available\n> on Android.\n\nIf the MediaCodecBridge availability code breaks, though, you won't know because the test relies on it. It's better to avoid relying on product code to drive tests.","draft":false,"lineno":14,"date":"2013-10-16 20:17:17.045340","left":false},{"author":"ddorwin","author_email":"ddorwin@chromium.org","text":"On 2013/10/16 07:58:40, xhwang wrote:\n> On 2013/10/14 21:30:34, ddorwin wrote:\n> > Where do we prevent SRC tests from running on Android? It doesn't look like we\n> > do (the content test has it).\n> \n> I only fixed content_browsertest and haven't fixed browser_test yet. Currently\n> browser_tests doesn't run on Android at all so this is low priority.\n\nShould we drop the MSE check then? It seems EME would always rely on MediaCodecs.","draft":false,"lineno":133,"date":"2013-10-16 20:17:17.045520","left":false},{"author":"xhwang","author_email":"xhwang@chromium.org","text":"On 2013/10/16 20:17:17, ddorwin wrote:\n> On 2013/10/16 07:58:40, xhwang wrote:\n> > On 2013/10/14 21:30:34, ddorwin wrote:\n> > > Where do we prevent SRC tests from running on Android? It doesn't look like\n> we\n> > > do (the content test has it).\n> > \n> > I only fixed content_browsertest and haven't fixed browser_test yet. Currently\n> > browser_tests doesn't run on Android at all so this is low priority.\n> \n> Should we drop the MSE check then? It seems EME would always rely on\n> MediaCodecs.\n\nDone. I also fixed browser_tests to support Android. Not sure if I should do that in a separate CL. PTAL.","draft":false,"lineno":133,"date":"2013-10-16 21:41:17.514570","left":false}],"id":1001,"is_binary":false}},"owner_email":"xhwang@chromium.org","owner":"xhwang","message":null,"try_job_results":[],"created":"2013-10-14 20:07:35.634900","url":null,"num_comments":11,"modified":"2013-10-16 21:41:17.554690","patchset":1,"issue":27230004}
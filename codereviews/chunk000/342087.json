{"description":"Fixed crashes on Windows related to incorrect sizing of the Canvas's\nbacking store when CSS styles are used to resize the Canvas. Fixed\nincorrect rendering output on Mac OS X caused by similar issue.\n\nThe deeper issue is why the Canvas's backing store is incorrectly\nsized in this case. http://crbug.com/26542 has been filed to track\nthis remaining problem.\n\nBUG=http://crbug.com/26515\nTEST=none (covered by preexisting manual WebGL tests)\n\n\nCommitted: http://src.chromium.org/viewvc/chrome?view=rev&revision=30859","cc":["chromium-reviews@googlegroups.com","darin@chromium.org"],"reviewers":["brettw@chromium.org","dglazkov@chromium.org"],"messages":[{"sender":"kbr@chromium.org","recipients":["kbr@chromium.org","brettw@chromium.org","dglazkov@chromium.org","chromium-reviews@googlegroups.com","darin@chromium.org"],"text":"","disapproval":false,"date":"2009-11-03 00:20:01.209275","approval":false},{"sender":"kbr@chromium.org","recipients":["kbr@chromium.org","brettw@chromium.org","dglazkov@chromium.org","chromium-reviews@googlegroups.com","darin@chromium.org"],"text":"Fixed incorrect rendering output on Mac OS X as well.","disapproval":false,"date":"2009-11-03 01:31:28.049035","approval":false},{"sender":"brettw@chromium.org","recipients":["kbr@chromium.org","brettw@chromium.org","dglazkov@chromium.org","chromium-reviews@googlegroups.com","darin@chromium.org"],"text":"This seems complicated to avoid a crash in a case that shouldn't occur in the first place.\n\nHow about just doing the copy from GL using the min of the GL and the canvas size? When this is done, we should focus our efforts on fixing the sizing problem for real.","disapproval":false,"date":"2009-11-03 17:28:20.013001","approval":false},{"sender":"kbr@chromium.org","recipients":["kbr@chromium.org","brettw@chromium.org","dglazkov@chromium.org","chromium-reviews@googlegroups.com","darin@chromium.org"],"text":"On 2009/11/03 17:28:20, brettw wrote:\n> This seems complicated to avoid a crash in a case that shouldn't occur in the\n> first place.\n> \n> How about just doing the copy from GL using the min of the GL and the canvas\n> size? When this is done, we should focus our efforts on fixing the sizing\n> problem for real.\n\nAfter reviewing the Canvas spec at http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element , in particular:\n\n\"The intrinsic dimensions of the canvas element equal the size of the coordinate space, with the numbers interpreted in CSS pixels. However, the element can be sized arbitrarily by a style sheet. During rendering, the image is scaled to fit this layout size.\"\n\nI think the behavior of the Canvas in this case is actually correct, and that we should close http://crbug.com/26542 as \"not a bug\". I believe this is the correct fix for this issue.","disapproval":false,"date":"2009-11-03 17:42:31.432792","approval":false},{"sender":"brettw@chromium.org","recipients":["kbr@chromium.org","brettw@chromium.org","dglazkov@chromium.org","chromium-reviews@googlegroups.com","darin@chromium.org"],"text":"LGTM\n\nhttp://codereview.chromium.org/342087/diff/1002/2001\nFile webkit/api/src/GraphicsContext3D.cpp (right):\n\nhttp://codereview.chromium.org/342087/diff/1002/2001#newcode755\nLine 755: canvas.drawBitmapRect(*m_resizingBitmap, 0, dst);\nDo you want antialiasing? This call will not give you any. If you do, make a SkPaint and do setFilterBitmap (or something like that) on it before passing it into drawBitmapRect.","disapproval":false,"date":"2009-11-03 20:21:18.309311","approval":true},{"sender":"kbr@chromium.org","recipients":["kbr@chromium.org","brettw@chromium.org","dglazkov@chromium.org","chromium-reviews@googlegroups.com","darin@chromium.org"],"text":"On 2009/11/03 20:21:18, brettw wrote:\n> \n> http://codereview.chromium.org/342087/diff/1002/2001\n> File webkit/api/src/GraphicsContext3D.cpp (right):\n> \n> http://codereview.chromium.org/342087/diff/1002/2001#newcode755\n> Line 755: canvas.drawBitmapRect(*m_resizingBitmap, 0, dst);\n> Do you want antialiasing? This call will not give you any. If you do, make a\n> SkPaint and do setFilterBitmap (or something like that) on it before passing it\n> into drawBitmapRect.\n\nThanks for the hint. Antialiasing doesn't seem to be necessary here. In these cases the canvas's content is being downscaled fairly drastically before being scaled back up (with antialiasing) during page composition.","disapproval":false,"date":"2009-11-03 20:46:19.771153","approval":false}],"owner_email":"kbr@chromium.org","private":false,"base_url":"svn://chrome-svn/chrome/trunk/src/","owner":"Ken Russell","subject":"Fixed crashes related to incorrect sizing of the Canvas's backing...","created":"2009-11-03 00:18:13.448272","patchsets":[1,1002],"modified":"2011-05-09 13:40:00.127715","closed":true,"commit":false,"issue":342087}
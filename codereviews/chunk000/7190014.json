{"description":"Update and re-enable PrerenderBrowserTest.PrerenderRendererCrash.\n\nBUG=80561\nTEST=PrerenderBrowserTest.PrerenderRendererCrash\n\nCommitted: http://src.chromium.org/viewvc/chrome?view=rev&revision=89674","cc":["chromium-reviews@chromium.org","tburkard+watch@chromium.org","cbentzel+watch@chromium.org","dominich+watch@chromium.org"],"reviewers":["cbentzel@chromium.org","dominich@chromium.org","phajdan.jr@chromium.org","commit-bot@chromium.org"],"messages":[{"sender":"mmenke@chromium.org","recipients":["mmenke@chromium.org","cbentzel@chromium.org","chromium-reviews@chromium.org","tburkard+watch@chromium.org","cbentzel+watch@chromium.org","dominich+watch@chromium.org","phajdan.jr@chromium.org"],"text":"Think the flakiness was due to the redirect.  Can't remember if the redirect was deliberate or not.  I believe not.","disapproval":false,"date":"2011-06-17 16:21:48.730309","approval":false},{"sender":"dominich@chromium.org","recipients":["mmenke@chromium.org","cbentzel@chromium.org","dominich@chromium.org","chromium-reviews@chromium.org","tburkard+watch@chromium.org","cbentzel+watch@chromium.org","dominich+watch@chromium.org","phajdan.jr@chromium.org"],"text":"LGTM\n\nhttp://codereview.chromium.org/7190014/diff/6001/chrome/browser/prerender/prerender_browsertest.cc\nFile chrome/browser/prerender/prerender_browsertest.cc (right):\n\nhttp://codereview.chromium.org/7190014/diff/6001/chrome/browser/prerender/prerender_browsertest.cc#newcode1040\nchrome/browser/prerender/prerender_browsertest.cc:1040: ui_test_utils::RunMessageLoop();\nIs it possible that this construct (instead of calling one of the NavigateToXXX methods) will help with other flaky tests? If so, consider wrapping it in a method so other tests (fragments) can use it.","disapproval":false,"date":"2011-06-17 16:25:03.791533","approval":true},{"sender":"mmenke@chromium.org","recipients":["mmenke@chromium.org","cbentzel@chromium.org","dominich@chromium.org","chromium-reviews@chromium.org","tburkard+watch@chromium.org","cbentzel+watch@chromium.org","dominich+watch@chromium.org","phajdan.jr@chromium.org"],"text":"http://codereview.chromium.org/7190014/diff/6001/chrome/browser/prerender/prerender_browsertest.cc\nFile chrome/browser/prerender/prerender_browsertest.cc (right):\n\nhttp://codereview.chromium.org/7190014/diff/6001/chrome/browser/prerender/prerender_browsertest.cc#newcode1040\nchrome/browser/prerender/prerender_browsertest.cc:1040: ui_test_utils::RunMessageLoop();\nOn 2011/06/17 16:25:03, dominich wrote:\n> Is it possible that this construct (instead of calling one of the NavigateToXXX\n> methods) will help with other flaky tests? If so, consider wrapping it in a\n> method so other tests (fragments) can use it.\n\nNo, unfortunately.  This is the same function the other tests use, and I exit due to the same call to MessageLoop::Quit.\n\nThe only difference is I need to renavigate the prerendered TabContents, as opposed to the visible tab contents, to generate the crash.  I need the redirect here because I can't do the renavigation from HTML files because of security checks, or prerender about:crash directly.","disapproval":false,"date":"2011-06-17 16:30:14.890827","approval":false},{"sender":"phajdan.jr@chromium.org","recipients":["mmenke@chromium.org","cbentzel@chromium.org","dominich@chromium.org","phajdan.jr@chromium.org","chromium-reviews@chromium.org","tburkard+watch@chromium.org","cbentzel+watch@chromium.org","dominich+watch@chromium.org"],"text":"Drive-by with a test comment, no need to wait for me.\n\nhttp://codereview.chromium.org/7190014/diff/6001/chrome/browser/prerender/prerender_browsertest.cc\nFile chrome/browser/prerender/prerender_browsertest.cc (right):\n\nhttp://codereview.chromium.org/7190014/diff/6001/chrome/browser/prerender/prerender_browsertest.cc#newcode1036\nchrome/browser/prerender/prerender_browsertest.cc:1036: DCHECK(GetPrerenderContents());\nThis is a test. Don't use DCHECKS, but ASSERT_TRUEs.\n\nThe latter works both in Debug and Release modes and doesn't _crash_ the binary.","disapproval":false,"date":"2011-06-18 09:57:30.405175","approval":false},{"sender":"mmenke@chromium.org","recipients":["mmenke@chromium.org","cbentzel@chromium.org","dominich@chromium.org","phajdan.jr@chromium.org","chromium-reviews@chromium.org","tburkard+watch@chromium.org","cbentzel+watch@chromium.org","dominich+watch@chromium.org"],"text":"http://codereview.chromium.org/7190014/diff/6001/chrome/browser/prerender/prerender_browsertest.cc\nFile chrome/browser/prerender/prerender_browsertest.cc (right):\n\nhttp://codereview.chromium.org/7190014/diff/6001/chrome/browser/prerender/prerender_browsertest.cc#newcode1036\nchrome/browser/prerender/prerender_browsertest.cc:1036: DCHECK(GetPrerenderContents());\nOn 2011/06/18 09:57:30, Paweł Hajdan Jr. wrote:\n> This is a test. Don't use DCHECKS, but ASSERT_TRUEs.\n> \n> The latter works both in Debug and Release modes and doesn't _crash_ the binary.\n\nWill do.  Thanks for catching that.","disapproval":false,"date":"2011-06-18 13:33:29.996879","approval":false},{"sender":"cbentzel@chromium.org","recipients":["mmenke@chromium.org","cbentzel@chromium.org","dominich@chromium.org","phajdan.jr@chromium.org","chromium-reviews@chromium.org","tburkard+watch@chromium.org","cbentzel+watch@chromium.org","dominich+watch@chromium.org"],"text":"I wish there was a way to make this test work without the AddAliasUrl change.\n\nWhat happens if you iframe/frame about:crash in an http page? Is this disallowed?","disapproval":false,"date":"2011-06-20 13:31:09.307718","approval":false},{"sender":"mmenke@chromium.org","recipients":["mmenke@chromium.org","cbentzel@chromium.org","dominich@chromium.org","phajdan.jr@chromium.org","chromium-reviews@chromium.org","tburkard+watch@chromium.org","cbentzel+watch@chromium.org","dominich+watch@chromium.org"],"text":"On 2011/06/20 13:31:09, cbentzel wrote:\n> I wish there was a way to make this test work without the AddAliasUrl change.\n> \n> What happens if you iframe/frame about:crash in an http page? Is this\n> disallowed?\n\nYes.  http pages can't access about pages in any way, for security reasons.","disapproval":false,"date":"2011-06-20 13:47:09.130317","approval":false},{"sender":"cbentzel@chromium.org","recipients":["reply@chromiumcodereview.appspotmail.com"],"text":"LGTM\n\nCan't think of a better way to do this. Arguably we could kill the\nrender process containing the prerendered RenderView without\ninitiating the crash.\n\nWhat happens to this test if both the referring RenderView and the\nprerendered RenderView are assigned to the same render process? Seems\nlike it should work, just wanted to confirm.\n\nOn Mon, Jun 20, 2011 at 9:47 AM,  <mmenke@chromium.org> wrote:\n> On 2011/06/20 13:31:09, cbentzel wrote:\n>>\n>> I wish there was a way to make this test work without the AddAliasUrl\n>> change.\n>\n>> What happens if you iframe/frame about:crash in an http page? Is this\n>> disallowed?\n>\n> Yes.  http pages can't access about pages in any way, for security reasons.\n>\n> http://codereview.chromium.org/7190014/\n>\n","disapproval":false,"date":"2011-06-20 14:41:47.656927","approval":true},{"sender":"mmenke@chromium.org","recipients":["mmenke@chromium.org","cbentzel@chromium.org","dominich@chromium.org","phajdan.jr@chromium.org","chromium-reviews@chromium.org","tburkard+watch@chromium.org","cbentzel+watch@chromium.org","dominich+watch@chromium.org"],"text":"On 2011/06/20 14:41:47, cbentzel wrote:\n> LGTM\n> \n> Can't think of a better way to do this. Arguably we could kill the\n> render process containing the prerendered RenderView without\n> initiating the crash.\n> \n> What happens to this test if both the referring RenderView and the\n> prerendered RenderView are assigned to the same render process? Seems\n> like it should work, just wanted to confirm.\n\nThe referring RenderView and the prerendered RenderView can't be assigned to the same process, since we don't prerender when the prerendered page would reuse a renderer process, except in single process mode.  In single process mode, of course, the test doesn't work, since about:crash doesn't crash the renderer process in that case.","disapproval":false,"date":"2011-06-20 15:15:47.861420","approval":false},{"sender":"commit-bot@chromium.org","recipients":["mmenke@chromium.org","cbentzel@chromium.org","dominich@chromium.org","phajdan.jr@chromium.org","commit-bot@chromium.org","chromium-reviews@chromium.org","tburkard+watch@chromium.org","cbentzel+watch@chromium.org","dominich+watch@chromium.org"],"text":"Change committed as 89674","disapproval":false,"date":"2011-06-20 16:41:14.382198","approval":false}],"owner_email":"mmenke@chromium.org","private":false,"base_url":"svn://svn.chromium.org/chrome/trunk/src/","owner":"mmenke","subject":"Update and re-enable PrerenderBrowserTest.PrerenderRendererCrash.","created":"2011-06-16 21:19:41.085291","patchsets":[1,2001,6001,5005],"modified":"2011-06-20 16:41:20.941255","closed":true,"commit":false,"issue":7190014}
{"description":"Add --allow-scripting-gallery command line switch to allow extensions\nand scripts to run on the Chrome Extensions Gallery site. There are\nsecurity concerns in enabling this and so it remains off by default,\nbut this is needed for automation testing of the gallery.\n\nCleanup: Have UserScriptSlave::InjectScripts() return void instead of a bogus bool.\n\nTEST=Visit http://chrome.google.com/extensions, check that content scripts work when the command-line switch is given, and are not injected when the switch is not given.\nBUG=none\n\n\nCommitted: http://src.chromium.org/viewvc/chrome?view=rev&revision=51977","cc":["chromium-reviews@chromium.org","ben+cc@chromium.org","aa@chromium.org","pam+watch@chromium.org","brettw-cc@chromium.org","darin-cc@chromium.org"],"reviewers":["erikkay@chromium.org","aa@chromium.org"],"messages":[{"sender":"sdoyon@chromium.org","recipients":["sdoyon@chromium.org","erikkay@chromium.org","chromium-reviews@chromium.org","ben+cc@chromium.org","erikkay@chromium.org","aa@chromium.org","pam+watch@chromium.org","brettw-cc@chromium.org","darin-cc@chromium.org"],"text":"","disapproval":false,"date":"2010-07-08 16:00:22.711242","approval":false},{"sender":"erikkay@chromium.org","recipients":["sdoyon@chromium.org","erikkay@chromium.org","aa@chromium.org","chromium-reviews@chromium.org","ben+cc@chromium.org","erikkay@chromium.org","aa@chromium.org","pam+watch@chromium.org","brettw-cc@chromium.org","darin-cc@chromium.org"],"text":"+aa\n\nhttp://codereview.chromium.org/2912002/diff/1/4\nFile chrome/common/chrome_switches.cc (right):\n\nhttp://codereview.chromium.org/2912002/diff/1/4#newcode28\nchrome/common/chrome_switches.cc:28: // Allows injecting extensions and user script on the extensions gallery site.\nI assume the purpose of this is for automated testing of the gallery.  Could you add that into the comment (and update this CL's description)?\n\nhttp://codereview.chromium.org/2912002/diff/1/7\nFile chrome/renderer/user_script_slave.cc (right):\n\nhttp://codereview.chromium.org/2912002/diff/1/7#newcode144\nchrome/renderer/user_script_slave.cc:144: bool UserScriptSlave::InjectScripts(WebFrame* frame,\nWhile looking at this change, I noticed that all branches in this function return true.  I did a search and it looks like nothing checks this return value either.  Seems like we should just remove the bool while you're in here.  Aaron, do you have an opinion?","disapproval":false,"date":"2010-07-08 16:15:37.763290","approval":false},{"sender":"sdoyon@chromium.org","recipients":["sdoyon@chromium.org","erikkay@chromium.org","aa@chromium.org","chromium-reviews@chromium.org","ben+cc@chromium.org","erikkay@chromium.org","aa@chromium.org","pam+watch@chromium.org","brettw-cc@chromium.org","darin-cc@chromium.org"],"text":"On Thu, 8 Jul 2010, erikkay@chromium.org wrote:\n\n> http://codereview.chromium.org/2912002/diff/1/4#newcode28\n> chrome/common/chrome_switches.cc:28: // Allows injecting extensions and\n> user script on the extensions gallery site.\n> I assume the purpose of this is for automated testing of the gallery.\n\nThat's the official purpose.\n\nBut it's also useful for accessibility (as of yet probably only to\nmyself): I use a chrome extension to interact with Chrome, not quite\nfor general browsing, but certainly for not-so-automated-testing, of\ncertain gadgets and of course the gallery.\n\n> Could you add that into the comment (and update this CL's description)?\n\nIt already mentions testing and accessibility, but I've changed it to be\nmore explicit.\n\n> chrome/renderer/user_script_slave.cc:144: bool\n> UserScriptSlave::InjectScripts(WebFrame* frame,\n> While looking at this change, I noticed that all branches in this\n> function return true.  I did a search and it looks like nothing checks\n> this return value either.  Seems like we should just remove the bool\n> while you're in here.<\n\nAlright, done.\n\nThanks","disapproval":false,"date":"2010-07-08 18:43:34.571661","approval":false},{"sender":"erikkay@chromium.org","recipients":["sdoyon@chromium.org","erikkay@chromium.org","aa@chromium.org","chromium-reviews@chromium.org","ben+cc@chromium.org","aa@chromium.org","pam+watch@chromium.org","brettw-cc@chromium.org","darin-cc@chromium.org"],"text":"On 2010/07/08 18:43:34, sdoyon wrote:\n> On Thu, 8 Jul 2010, mailto:erikkay@chromium.org wrote:\n> \n> > http://codereview.chromium.org/2912002/diff/1/4#newcode28\n> > chrome/common/chrome_switches.cc:28: // Allows injecting extensions and\n> > user script on the extensions gallery site.\n> > I assume the purpose of this is for automated testing of the gallery.\n> \n> That's the official purpose.\n> \n> But it's also useful for accessibility (as of yet probably only to\n> myself): I use a chrome extension to interact with Chrome, not quite\n> for general browsing, but certainly for not-so-automated-testing, of\n> certain gadgets and of course the gallery.\n\nI don't want this to be an officially recommended or sanctioned approach for accessibility in the gallery, so please remove that from the comments.  We're looking into another mechanism to enable broader accessibility via extensions.\n\nThere are two issues:\n(1) We don't want command-line switches that are used by default for users as a way of controlling advanced options.  They're intended for chromium developer testing, ways to communicate options to subprocesses or as flags to hide experimental features.\n(2) It may be fine for the case of the gallery, but it would definitely be unacceptable to use a similar mechanism for allowing content scripting of chrome:// pages for example.  I worry that one would be a slippery slope to the other.\n\nLGTM with the comment change.\n\n\n> > Could you add that into the comment (and update this CL's description)?\n> \n> It already mentions testing and accessibility, but I've changed it to be\n> more explicit.\n> \n> > chrome/renderer/user_script_slave.cc:144: bool\n> > UserScriptSlave::InjectScripts(WebFrame* frame,\n> > While looking at this change, I noticed that all branches in this\n> > function return true.  I did a search and it looks like nothing checks\n> > this return value either.  Seems like we should just remove the bool\n> > while you're in here.<\n> \n> Alright, done.\n> \n> Thanks","disapproval":false,"date":"2010-07-08 20:35:48.589801","approval":true},{"sender":"sdoyon@chromium.org","recipients":["reply@chromiumcodereview.appspotmail.com"],"text":"On Thu, 8 Jul 2010, erikkay@chromium.org wrote:\n\n> On 2010/07/08 18:43:34, sdoyon wrote:\n>> On Thu, 8 Jul 2010, mailto:erikkay@chromium.org wrote:\n>\n>>> http://codereview.chromium.org/2912002/diff/1/4#newcode28\n>>> chrome/common/chrome_switches.cc:28: // Allows injecting extensions and\n>>> user script on the extensions gallery site.\n>>> I assume the purpose of this is for automated testing of the gallery.\n>\n>> That's the official purpose.\n>\n>> But it's also useful for accessibility (as of yet probably only to\n>> myself): I use a chrome extension to interact with Chrome, not quite\n>> for general browsing, but certainly for not-so-automated-testing, of\n>> certain gadgets and of course the gallery.\n>\n> I don't want this to be an officially recommended or sanctioned approach for\n> accessibility in the gallery,\n\nHmm indeed that wouldn't be good.\n\n> so please remove that from the comments.\n\nDone.\n\n>  We're\n> looking into another mechanism to enable broader accessibility via \n> extensions.\n\nCan you elaborate?\n\n> There are two issues:\n> (1) We don't want command-line switches that are used by default for users as \n> a\n> way of controlling advanced options.  They're intended for chromium developer\n> testing, ways to communicate options to subprocesses or as flags to hide\n> experimental features.\n\nRight.\n\nThis swtich solution would get us going, but I don't see it as a good \ngeneral long term solutoin. You'd want to authorize a particular extension \nto script the gallery, not all of them. Just not clear exactly how to do \nthat. A specific permission sounds heavy-handed, and users won't know to \nsay no.\n\n\n> LGTM with the comment change.\n\nThanks\n\n","disapproval":false,"date":"2010-07-08 21:02:20.100542","approval":false}],"owner_email":"sdoyon@chromium.org","private":false,"base_url":"svn://chrome-svn/chrome/trunk/src/","owner":"sdoyon","subject":"Add --allow-scripting-gallery command line switch to allow extensions...","created":"2010-07-08 16:00:13.893865","patchsets":[1,10001,19001],"modified":"2011-05-09 13:11:56.626573","closed":true,"commit":false,"issue":2912002}
{"description":"Create a \"GetWOW64Status()\" utility function and make the rest of the codebase call it.\r\n\r\nBUG=none\r\nTEST=none\n\nCommitted: http://src.chromium.org/viewvc/chrome?view=rev&revision=76854","cc":["chromium-reviews@chromium.org","brettw-cc@chromium.org","native-client-reviews@googlegroups.com","phajdan.jr@chromium.org"],"reviewers":["rvargas@chromium.org","brettw@chromium.org"],"messages":[{"sender":"pkasting@chromium.org","recipients":["pkasting@chromium.org","rvargas@chromium.org","brettw@chromium.org","chromium-reviews@chromium.org","brettw-cc@chromium.org","native-client-reviews@googlegroups.com","phajdan.jr@chromium.org"],"text":"Ricardo: Sandbox\nBrett: Rest\n\nThe sandbox changes mean there's now exactly one usage of the Wow64 class, and it has one public function.  This suggests that someone should do a followup change to move all this code over to the file where it's called.  I can file a bug on that if you want.","disapproval":false,"date":"2011-03-03 22:22:50.684332","approval":false},{"sender":"brettw@chromium.org","recipients":["pkasting@chromium.org","rvargas@chromium.org","brettw@chromium.org","chromium-reviews@chromium.org","brettw-cc@chromium.org","native-client-reviews@googlegroups.com","phajdan.jr@chromium.org"],"text":"LGTM\n\nhttp://codereview.chromium.org/6610029/diff/1/base/win/windows_version.cc\nFile base/win/windows_version.cc (right):\n\nhttp://codereview.chromium.org/6610029/diff/1/base/win/windows_version.cc#newcode81\nbase/win/windows_version.cc:81: if (is_wow64_process == NULL)\nI guess I would have just written !is_wow_64_process but your code is OK if you prefer that.\n\nhttp://codereview.chromium.org/6610029/diff/1/base/win/windows_version.h\nFile base/win/windows_version.h (right):\n\nhttp://codereview.chromium.org/6610029/diff/1/base/win/windows_version.h#newcode48\nbase/win/windows_version.h:48: WOW64Status GetWOW64StatusForHandle(HANDLE handle);\nMaybe call this process_handle to make more clear what it's suppose to be a handle for?","disapproval":false,"date":"2011-03-03 22:28:53.580857","approval":true},{"sender":"pkasting@chromium.org","recipients":["pkasting@chromium.org","rvargas@chromium.org","brettw@chromium.org","chromium-reviews@chromium.org","brettw-cc@chromium.org","native-client-reviews@googlegroups.com","phajdan.jr@chromium.org"],"text":"http://codereview.chromium.org/6610029/diff/1/base/win/windows_version.cc\nFile base/win/windows_version.cc (right):\n\nhttp://codereview.chromium.org/6610029/diff/1/base/win/windows_version.cc#newcode81\nbase/win/windows_version.cc:81: if (is_wow64_process == NULL)\nOn 2011/03/03 22:28:53, brettw wrote:\n> I guess I would have just written !is_wow_64_process but your code is OK if you\n> prefer that.\n\nDon't care much.  Changed.\n\nhttp://codereview.chromium.org/6610029/diff/1/base/win/windows_version.h\nFile base/win/windows_version.h (right):\n\nhttp://codereview.chromium.org/6610029/diff/1/base/win/windows_version.h#newcode48\nbase/win/windows_version.h:48: WOW64Status GetWOW64StatusForHandle(HANDLE handle);\nOn 2011/03/03 22:28:53, brettw wrote:\n> Maybe call this process_handle to make more clear what it's suppose to be a\n> handle for?\n\nI went one better than this and also changed the API name to GetWOW64StatusForProcess() and the calling code in memory_details_win.cc from using |handle| to using |process_handle|.","disapproval":false,"date":"2011-03-03 22:33:23.734993","approval":false},{"sender":"rvargas@chromium.org","recipients":["pkasting@chromium.org","rvargas@chromium.org","brettw@chromium.org","chromium-reviews@chromium.org","brettw-cc@chromium.org","native-client-reviews@googlegroups.com","phajdan.jr@chromium.org"],"text":"LGTM\n\nhttp://codereview.chromium.org/6610029/diff/2006/base/win/windows_version.cc\nFile base/win/windows_version.cc (right):\n\nhttp://codereview.chromium.org/6610029/diff/2006/base/win/windows_version.cc#newcode80\nbase/win/windows_version.cc:80: GetProcAddress(GetModuleHandle(L\"kernel32.dll\"), \"IsWow64Process\"));\nCan we save this pointer? GetProcAddress is not that fast, and this may be called a bunch of times for each process that we want to launch.\n\nhttp://codereview.chromium.org/6610029/diff/2006/base/win/windows_version.h\nFile base/win/windows_version.h (right):\n\nhttp://codereview.chromium.org/6610029/diff/2006/base/win/windows_version.h#newcode33\nbase/win/windows_version.h:33: enum WOW64Status {\nI would prefer if the enum was not a status (as in something that can change), and instead the name was more \"fixed\"... this \"is running under wow\" or not, as opposed to \"disabled\" which would always make me double check what it means. But I don't have a real suggestion for a better name, so if you don't have a better name that's ok.","disapproval":false,"date":"2011-03-04 00:12:18.190521","approval":true},{"sender":"pkasting@chromium.org","recipients":["pkasting@chromium.org","rvargas@chromium.org","brettw@chromium.org","chromium-reviews@chromium.org","brettw-cc@chromium.org","native-client-reviews@googlegroups.com","phajdan.jr@chromium.org"],"text":"http://codereview.chromium.org/6610029/diff/2006/base/win/windows_version.cc\nFile base/win/windows_version.cc (right):\n\nhttp://codereview.chromium.org/6610029/diff/2006/base/win/windows_version.cc#newcode80\nbase/win/windows_version.cc:80: GetProcAddress(GetModuleHandle(L\"kernel32.dll\"), \"IsWow64Process\"));\nOn 2011/03/04 00:12:18, rvargas wrote:\n> Can we save this pointer? GetProcAddress is not that fast, and this may be\n> called a bunch of times for each process that we want to launch.\n\nBut the entire return value is cached in GetWOW64Status().  So this should only be called once.\n\nhttp://codereview.chromium.org/6610029/diff/2006/base/win/windows_version.h\nFile base/win/windows_version.h (right):\n\nhttp://codereview.chromium.org/6610029/diff/2006/base/win/windows_version.h#newcode33\nbase/win/windows_version.h:33: enum WOW64Status {\nOn 2011/03/04 00:12:18, rvargas wrote:\n> I would prefer if the enum was not a status (as in something that can change),\n> and instead the name was more \"fixed\"... this \"is running under wow\" or not, as\n> opposed to \"disabled\" which would always make me double check what it means. But\n> I don't have a real suggestion for a better name, so if you don't have a better\n> name that's ok.\n\nHmm.  I see your point.  I can't think of anything better though.  \"WOW64State\" is equally bad.","disapproval":false,"date":"2011-03-04 01:11:48.102844","approval":false},{"sender":"rvargas@chromium.org","recipients":["pkasting@chromium.org","rvargas@chromium.org","brettw@chromium.org","chromium-reviews@chromium.org","brettw-cc@chromium.org","native-client-reviews@googlegroups.com","phajdan.jr@chromium.org"],"text":"http://codereview.chromium.org/6610029/diff/2006/base/win/windows_version.cc\nFile base/win/windows_version.cc (right):\n\nhttp://codereview.chromium.org/6610029/diff/2006/base/win/windows_version.cc#newcode80\nbase/win/windows_version.cc:80: GetProcAddress(GetModuleHandle(L\"kernel32.dll\"), \"IsWow64Process\"));\nOn 2011/03/04 01:11:48, Peter Kasting wrote:\n> On 2011/03/04 00:12:18, rvargas wrote:\n> > Can we save this pointer? GetProcAddress is not that fast, and this may be\n> > called a bunch of times for each process that we want to launch.\n> \n> But the entire return value is cached in GetWOW64Status().  So this should only\n> be called once.\n\nEven better :)","disapproval":false,"date":"2011-03-04 01:21:49.441633","approval":false}],"owner_email":"pkasting@chromium.org","private":false,"base_url":"svn://chrome-svn/chrome/trunk/src/","owner":"Peter Kasting","subject":"Create a \"GetWOW64Status()\" utility function and make the rest of the codebas...","created":"2011-03-03 22:19:49.999992","patchsets":[1,2006],"modified":"2011-05-20 02:32:48.204302","closed":true,"commit":false,"issue":6610029}
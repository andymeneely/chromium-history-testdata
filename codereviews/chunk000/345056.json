{"description":"Move PasswordFormDomManager::CreatePassword into the WebKit API\nhttp://code.google.com/p/chromium/issues/detail?id=24619\n\nCommitted: http://src.chromium.org/viewvc/chrome?view=rev&revision=31104","cc":["chromium-reviews@googlegroups.com"],"reviewers":["darin@chromium.org","tim@chromium.org"],"messages":[{"sender":"yaar@chromium.org","recipients":["yaar@chromium.org","darin@chromium.org","chromium-reviews@googlegroups.com"],"text":"ready for review.\n\nhttp://codereview.chromium.org/345056/diff/1006/1009\nFile webkit/api/src/WebPasswordForm.cpp (right):\n\nhttp://codereview.chromium.org/345056/diff/1006/1009#newcode207\nLine 207: {\nReplaces: \nGURL::Replacements rep;\t\nrep.ClearUsername();\t\nrep.ClearPassword();\t\nrep.ClearQuery();\t\nrep.ClearRef();\t\nreturn url.ReplaceComponents(rep);","disapproval":false,"date":"2009-11-04 02:44:41.484665","approval":false},{"sender":"darin@chromium.org","recipients":["yaar@chromium.org","darin@chromium.org","chromium-reviews@googlegroups.com"],"text":"http://codereview.chromium.org/345056/diff/1006/1008\nFile webkit/api/public/WebPasswordForm.h (right):\n\nhttp://codereview.chromium.org/345056/diff/1006/1008#newcode40\nLine 40: struct WebPasswordForm {\nlet's go with WebPasswordFormData since this structure contains data and is not a reference to the form itself.  (i've always wanted to change the PasswordForm name in webkit/glue)\n\nhttp://codereview.chromium.org/345056/diff/1006/1008#newcode101\nLine 101: static WebPasswordForm* create(const WebForm& form);\nWhy not follow the same pattern as WebSearchableFormData?\n\nhttp://codereview.chromium.org/345056/diff/1006/1008#newcode105\nLine 105: \nnit: remove extra new lines\n\nhttp://codereview.chromium.org/345056/diff/1006/1009\nFile webkit/api/src/WebPasswordForm.cpp (right):\n\nhttp://codereview.chromium.org/345056/diff/1006/1009#newcode73\nLine 73: * Version: MPL 1.1/GPL 2.0/LGPL 2.1\ni think we should create a separate file for this mozilla code.  let's go with WebPasswordFormUtils.{h,cpp}.  that way we can keep the separately licensed code in separate files.  these licenses apply to single source files, so it is wrong to have two different licenses appear in the same file.\n\nWebPasswordFormUtils.{h,cpp} should contain:\n  findPasswordFormFields\n  locateSpecificPasswords\n\nhttp://codereview.chromium.org/345056/diff/1006/1009#newcode209\nLine 209: strippedURL.setUser(\"\");\ni think you should set these to String() instead of \"\" since you want KURLGoogle.cpp to call, for instance, ClearQuery instead of just replacing the query string with an empty string.\n\nhttp://codereview.chromium.org/345056/diff/1006/1010\nFile webkit/glue/password_form.h (right):\n\nhttp://codereview.chromium.org/345056/diff/1006/1010#newcode142\nLine 142: blacklisted_by_user(false) {}\nnit: it is more common in google style to do like the existing code did with the closing bracket on the next line.\n\nhttp://codereview.chromium.org/345056/diff/1006/1010#newcode144\nLine 144: PasswordForm(const WebKit::WebPasswordForm& webPwdForm)\nplease use google style  ->  web_password_form\n\nhttp://codereview.chromium.org/345056/diff/1006/1011\nFile webkit/glue/password_form_dom_manager.cc (right):\n\nhttp://codereview.chromium.org/345056/diff/1006/1011#newcode11\nLine 11: using WebKit::WebForm;\nnit: add a using WebKit::WebPasswordForm;","disapproval":false,"date":"2009-11-04 04:38:40.058481","approval":false},{"sender":"yaar@chromium.org","recipients":["yaar@chromium.org","darin@chromium.org","chromium-reviews@googlegroups.com"],"text":"round 2","disapproval":false,"date":"2009-11-04 19:43:44.882540","approval":false},{"sender":"darin@chromium.org","recipients":["yaar@chromium.org","darin@chromium.org","chromium-reviews@googlegroups.com"],"text":"http://codereview.chromium.org/345056/diff/7001/7003\nFile webkit/api/public/WebPasswordFormData.h (right):\n\nhttp://codereview.chromium.org/345056/diff/7001/7003#newcode41\nLine 41: \nnit: no new line here\n\nhttp://codereview.chromium.org/345056/diff/7001/7003#newcode43\nLine 43: // be set properly. Otherwise, |action| will be left invalid.\nI think a nice improvement would be to add an isValid method:\n\n  bool isValid() const { return action.isValid(); }\n\nWe should really add a similar method to WebSearchableFormData.\n\nhttp://codereview.chromium.org/345056/diff/7001/7003#newcode104\nLine 104: \nnit: no new line, and please indent members by 4 spaces\n\nhttp://codereview.chromium.org/345056/diff/7001/7004\nFile webkit/api/src/WebPasswordFormData.cpp (right):\n\nhttp://codereview.chromium.org/345056/diff/7001/7004#newcode149\nLine 149: }  // empty namespace\nnit: usually people just write \"namespace\"\n\nhttp://codereview.chromium.org/345056/diff/7001/7004#newcode150\nLine 150: \nnit: kill extra new line\n\nhttp://codereview.chromium.org/345056/diff/7001/7005\nFile webkit/api/src/WebPasswordFormUtils.cpp (right):\n\nhttp://codereview.chromium.org/345056/diff/7001/7005#newcode1\nLine 1: // Helper to WebPasswordFormData to do the locating of username/password\nnit: please move this comment below the license block.  the license block should always appear at the top of the file.\n\nhttp://codereview.chromium.org/345056/diff/7001/7005#newcode42\nLine 42: * ***** END LICENSE BLOCK ***** */\nnit: add a new line after the license block\n\nhttp://codereview.chromium.org/345056/diff/7001/7005#newcode50\nLine 50: #undef LOG\nyou shoudl be able to delete this #undef\n\nhttp://codereview.chromium.org/345056/diff/7001/7005#newcode60\nLine 60: const size_t maxPasswords = 3;\nmake this 'static'\n\nhttp://codereview.chromium.org/345056/diff/7001/7006\nFile webkit/api/src/WebPasswordFormUtils.h (right):\n\nhttp://codereview.chromium.org/345056/diff/7001/7006#newcode34\nLine 34: #include \"wtf/vector.h\"\nnit: <wtf/Vector.h>\n\nhttp://codereview.chromium.org/345056/diff/7001/7006#newcode42\nLine 42: //namespace WTF { template <typename T> class Vector; }\ndelete this comment\n\nhttp://codereview.chromium.org/345056/diff/7001/7006#newcode49\nLine 49: WTF::Vector<WebCore::HTMLInputElement*> passwords;\nnit: no WTF:: prefix\n\nhttp://codereview.chromium.org/345056/diff/7001/7007\nFile webkit/glue/password_form.h (right):\n\nhttp://codereview.chromium.org/345056/diff/7001/7007#newcode160\nLine 160: \nnit: no new line here\n\nhttp://codereview.chromium.org/345056/diff/7001/7007#newcode162\nLine 162: \nnit: no new line here\n\nhttp://codereview.chromium.org/345056/diff/7001/7008\nFile webkit/glue/password_form_dom_manager.cc (right):\n\nhttp://codereview.chromium.org/345056/diff/7001/7008#newcode18\nLine 18: WebPasswordFormData* web_password_form = new WebPasswordFormData(webform);\ni think you can avoid heap allocating WebPasswordFormData.  just allocate it on the stack.","disapproval":false,"date":"2009-11-04 19:50:19.051898","approval":false},{"sender":"yaar@chromium.org","recipients":["yaar@chromium.org","darin@chromium.org","chromium-reviews@googlegroups.com"],"text":"feedback is in.","disapproval":false,"date":"2009-11-05 00:29:19.590268","approval":false},{"sender":"darin@chromium.org","recipients":["yaar@chromium.org","darin@chromium.org","chromium-reviews@googlegroups.com"],"text":"LGTM w/ nits picked:\n\nplease go ahead and commit after fixing them.\n\nhttp://codereview.chromium.org/345056/diff/10001/7018\nFile webkit/api/src/WebPasswordFormData.cpp (right):\n\nhttp://codereview.chromium.org/345056/diff/10001/7018#newcode42\nLine 42: #undef LOG\nis this #undef really needed?  can it be removed?\n\nhttp://codereview.chromium.org/345056/diff/10001/7019\nFile webkit/api/src/WebPasswordFormUtils.cpp (right):\n\nhttp://codereview.chromium.org/345056/diff/10001/7019#newcode42\nLine 42: // Its license block is\nthis last phrase of the comment block is now a bit misplaced.  maybe just delete that?\n\nhttp://codereview.chromium.org/345056/diff/10001/7020\nFile webkit/api/src/WebPasswordFormUtils.h (right):\n\nhttp://codereview.chromium.org/345056/diff/10001/7020#newcode34\nLine 34: #include <wtf/vector.h>\nnit: v -> V, or else this won't compile on some filesystems","disapproval":false,"date":"2009-11-05 07:54:28.003931","approval":true},{"sender":"tim@chromium.org","recipients":["yaar@chromium.org","darin@chromium.org","tim@chromium.org","chromium-reviews@googlegroups.com"],"text":"sorry i'm late to the party, just some nitpicking.\n\nhttp://codereview.chromium.org/345056/diff/10001/7016\nFile webkit/api/public/WebPasswordFormData.h (right):\n\nhttp://codereview.chromium.org/345056/diff/10001/7016#newcode49\nLine 49: // PasswordManager for form autofill; that is, the action of the saved\nI reviewed this file bottom up for some reason, but I have the same comment here as I did below for |origin| and |userNameElement|.\n\nhttp://codereview.chromium.org/345056/diff/10001/7016#newcode61\nLine 61: // contains the HTTP realm for dialog-based forms).\nnit- the dialog-based forms comment (and mention of alernate SCHEME_'s) is probably not helpful here.\n\nhttp://codereview.chromium.org/345056/diff/10001/7016#newcode67\nLine 67: // data used by the PasswordManager to decide (in longest matching prefix\ndo we really want to mention PasswordManager and/or matching heuristics? [similar comment to what I wrote below at |userNameElement|]\n\nhttp://codereview.chromium.org/345056/diff/10001/7016#newcode79\nLine 79: // The name of the username input element. Optional (improves scoring).\ncomments that refer to scoring in here are really specific to the chromium implemenation.. do we care about that here / does that even make sense here? My feeling is it does not.","disapproval":false,"date":"2009-11-05 18:47:11.982358","approval":false},{"sender":"yaar@chromium.org","recipients":[],"text":"Sorry Tim, but the party is over. Already committed an hour ago:\nhttp://src.chromium.org/viewvc/chrome?view=rev&revision=31104\n\n\nOn Thu, Nov 5, 2009 at 10:47 AM, <tim@chromium.org> wrote:\n\n> sorry i'm late to the party, just some nitpicking.\n>\n>\n> http://codereview.chromium.org/345056/diff/10001/7016\n> File webkit/api/public/WebPasswordFormData.h (right):\n>\n> http://codereview.chromium.org/345056/diff/10001/7016#newcode49\n> Line 49: // PasswordManager for form autofill; that is, the action of\n> the saved\n> I reviewed this file bottom up for some reason, but I have the same\n> comment here as I did below for |origin| and |userNameElement|.\n>\n> http://codereview.chromium.org/345056/diff/10001/7016#newcode61\n> Line 61: // contains the HTTP realm for dialog-based forms).\n> nit- the dialog-based forms comment (and mention of alernate SCHEME_'s)\n> is probably not helpful here.\n>\n> http://codereview.chromium.org/345056/diff/10001/7016#newcode67\n> Line 67: // data used by the PasswordManager to decide (in longest\n> matching prefix\n> do we really want to mention PasswordManager and/or matching heuristics?\n> [similar comment to what I wrote below at |userNameElement|]\n>\n> http://codereview.chromium.org/345056/diff/10001/7016#newcode79\n> Line 79: // The name of the username input element. Optional (improves\n> scoring).\n> comments that refer to scoring in here are really specific to the\n> chromium implemenation.. do we care about that here / does that even\n> make sense here? My feeling is it does not.\n>\n>\n> http://codereview.chromium.org/345056\n>\n","disapproval":false,"date":"2009-11-05 18:59:20.741987","approval":false}],"owner_email":"yaar@chromium.org","private":false,"base_url":"","owner":"yaar","subject":"Move PasswordFormDomManager::CreatePassword into the WebKit API","created":"2009-11-04 00:44:26.042325","patchsets":[1006,7001,10001],"modified":"2011-05-09 13:20:41.960551","closed":true,"commit":false,"issue":345056}
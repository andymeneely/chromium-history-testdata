{"description":"Refactor some more BrowserMain code. Move the small bit of remaining code that's required by all embedders to content.\n\nBUG=90445\nCommitted: http://src.chromium.org/viewvc/chrome?view=rev&revision=100223","cc":["chromium-reviews@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","davemoore+watch@chromium.org","stevenjb@chromium.org"],"reviewers":["tony@chromium.org"],"messages":[{"sender":"jam@chromium.org","recipients":["jam@chromium.org","cpu@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","davemoore+watch@chromium.org","stevenjb@chromium.org","jam@chromium.org"],"text":"","disapproval":false,"date":"2011-09-07 22:33:22.375621","approval":false},{"sender":"jam@chromium.org","recipients":["jam@chromium.org","viettrungluu@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","davemoore+watch@chromium.org","stevenjb@chromium.org","jam@chromium.org"],"text":"oops, I meant to send this to Trung","disapproval":false,"date":"2011-09-08 01:34:27.316811","approval":false},{"sender":"jam@chromium.org","recipients":["jam@chromium.org","tony@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","davemoore+watch@chromium.org","stevenjb@chromium.org"],"text":"http://codereview.chromium.org/7840041/diff/15013/chrome/browser/browser_main.cc\nFile chrome/browser/browser_main.cc (right):\n\nhttp://codereview.chromium.org/7840041/diff/15013/chrome/browser/browser_main.cc#newcode1756\nchrome/browser/browser_main.cc:1756: \nfixed this spacing and also 1766","disapproval":false,"date":"2011-09-08 16:21:06.766302","approval":false},{"sender":"jam@chromium.org","recipients":["jam@chromium.org","tony@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","davemoore+watch@chromium.org","stevenjb@chromium.org"],"text":"http://codereview.chromium.org/7840041/diff/15013/content/browser/browser_main.cc\nFile content/browser/browser_main.cc (right):\n\nhttp://codereview.chromium.org/7840041/diff/15013/content/browser/browser_main.cc#newcode247\ncontent/browser/browser_main.cc:247: {\nI got rid of this unnecessary scope","disapproval":false,"date":"2011-09-08 16:38:01.188081","approval":false},{"sender":"tony@chromium.org","recipients":["jam@chromium.org","tony@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","davemoore+watch@chromium.org","stevenjb@chromium.org"],"text":"http://codereview.chromium.org/7840041/diff/15013/chrome/browser/browser_main.cc\nFile chrome/browser/browser_main.cc (right):\n\nhttp://codereview.chromium.org/7840041/diff/15013/chrome/browser/browser_main.cc#newcode1897\nchrome/browser/browser_main.cc:1897: if (parameters().ui_task == NULL && translate_manager_ != NULL)\nDo we need to make a member variable for translate_manager_ or can we just call TranslateManager::GetInstance() again?\n\nhttp://codereview.chromium.org/7840041/diff/15013/chrome/browser/browser_main.cc#newcode1905\nchrome/browser/browser_main.cc:1905: metrics_->Stop();\nIt looks like this is g_browser_process->metrics_service(), so we can probably use that instead of making a member variable for it.\n\nhttp://codereview.chromium.org/7840041/diff/15013/chrome/browser/browser_main.h\nFile chrome/browser/browser_main.h (right):\n\nhttp://codereview.chromium.org/7840041/diff/15013/chrome/browser/browser_main.h#newcode14\nchrome/browser/browser_main.h:14: #include \"chrome/browser/first_run/first_run.h\"\nNit: alphabetize\n\nhttp://codereview.chromium.org/7840041/diff/15013/chrome/browser/chromeos/browser_main_chromeos.cc\nFile chrome/browser/chromeos/browser_main_chromeos.cc (right):\n\nhttp://codereview.chromium.org/7840041/diff/15013/chrome/browser/chromeos/browser_main_chromeos.cc#newcode93\nchrome/browser/chromeos/browser_main_chromeos.cc:93: BrowserMainPartsGtk::PostMainMessageLoopStart();\nPosix seems better here since there is no BrowserMainPartsGtk::PostMainMessageLoopStart, but if we were to add one, it would be a good place for GTK (not chromeos) specific code.\n\nhttp://codereview.chromium.org/7840041/diff/15013/content/browser/browser_main.h\nFile content/browser/browser_main.h (right):\n\nhttp://codereview.chromium.org/7840041/diff/15013/content/browser/browser_main.h#newcode78\ncontent/browser/browser_main.h:78: void MainMessageLoopRunWrapper();\nNit: I would probably name this RunMainMessageLoopParts or something.  Wrapper isn't very descriptive.","disapproval":false,"date":"2011-09-08 17:21:04.291052","approval":false},{"sender":"jam@chromium.org","recipients":["jam@chromium.org","tony@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","davemoore+watch@chromium.org","stevenjb@chromium.org"],"text":"http://codereview.chromium.org/7840041/diff/15013/chrome/browser/browser_main.cc\nFile chrome/browser/browser_main.cc (right):\n\nhttp://codereview.chromium.org/7840041/diff/15013/chrome/browser/browser_main.cc#newcode1897\nchrome/browser/browser_main.cc:1897: if (parameters().ui_task == NULL && translate_manager_ != NULL)\nOn 2011/09/08 17:21:04, tony wrote:\n> Do we need to make a member variable for translate_manager_ or can we just call\n> TranslateManager::GetInstance() again?\n\nI had done this so that we don't end up constructing TranslateManager in PostMainMessageLoopRun() if it wasn't constructed before (to match the old behavior)\n\nhttp://codereview.chromium.org/7840041/diff/15013/chrome/browser/browser_main.cc#newcode1905\nchrome/browser/browser_main.cc:1905: metrics_->Stop();\nOn 2011/09/08 17:21:04, tony wrote:\n> It looks like this is g_browser_process->metrics_service(), so we can probably\n> use that instead of making a member variable for it.\n\nDone.\n\nhttp://codereview.chromium.org/7840041/diff/15013/chrome/browser/browser_main.h\nFile chrome/browser/browser_main.h (right):\n\nhttp://codereview.chromium.org/7840041/diff/15013/chrome/browser/browser_main.h#newcode14\nchrome/browser/browser_main.h:14: #include \"chrome/browser/first_run/first_run.h\"\nOn 2011/09/08 17:21:04, tony wrote:\n> Nit: alphabetize\n\nDone.\n\nhttp://codereview.chromium.org/7840041/diff/15013/chrome/browser/chromeos/browser_main_chromeos.cc\nFile chrome/browser/chromeos/browser_main_chromeos.cc (right):\n\nhttp://codereview.chromium.org/7840041/diff/15013/chrome/browser/chromeos/browser_main_chromeos.cc#newcode93\nchrome/browser/chromeos/browser_main_chromeos.cc:93: BrowserMainPartsGtk::PostMainMessageLoopStart();\nOn 2011/09/08 17:21:04, tony wrote:\n> Posix seems better here since there is no\n> BrowserMainPartsGtk::PostMainMessageLoopStart, but if we were to add one, it\n> would be a good place for GTK (not chromeos) specific code.\n\nok. it seemed odd to me that it wouldn't call its parent class, but what you say makes sense\n\nhttp://codereview.chromium.org/7840041/diff/15013/content/browser/browser_main.h\nFile content/browser/browser_main.h (right):\n\nhttp://codereview.chromium.org/7840041/diff/15013/content/browser/browser_main.h#newcode78\ncontent/browser/browser_main.h:78: void MainMessageLoopRunWrapper();\nOn 2011/09/08 17:21:04, tony wrote:\n> Nit: I would probably name this RunMainMessageLoopParts or something.  Wrapper\n> isn't very descriptive.\n\nDone.","disapproval":false,"date":"2011-09-08 17:43:01.401282","approval":false},{"sender":"tony@chromium.org","recipients":["jam@chromium.org","tony@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","davemoore+watch@chromium.org","stevenjb@chromium.org"],"text":"The net_unittests failure looks real, no?","disapproval":false,"date":"2011-09-08 18:37:26.934459","approval":false},{"sender":"tony@chromium.org","recipients":["jam@chromium.org","tony@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","davemoore+watch@chromium.org","stevenjb@chromium.org"],"text":"On 2011/09/08 18:37:26, tony wrote:\n> The net_unittests failure looks real, no?\n\nNevermind, looks like agl is looking into that failure.\n\nLGTM","disapproval":false,"date":"2011-09-08 19:33:38.393661","approval":true}],"owner_email":"jam@chromium.org","private":false,"base_url":"svn://chrome-svn/chrome/trunk/src/","owner":"jam","subject":"Refactor some more BrowserMain code. Move core code that's required by all embedders to content.","created":"2011-09-07 20:52:57.063930","patchsets":[1,5002,8001,9021,13026,12031,15011,15013,12068,12089],"modified":"2011-09-08 19:41:45.121661","closed":true,"commit":false,"issue":7840041}
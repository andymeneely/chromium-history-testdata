{"description":"Fixing possobility of some wizard View outlive its controller.\n\nBUG=none\nTEST=none\n\n\nCommitted: http://src.chromium.org/viewvc/chrome?view=rev&revision=44071","cc":["chromium-reviews@chromium.org","nkostylev+cc@chromium.org","ben+cc@chromium.org"],"reviewers":["avayvod@chromium.org","dpolukhin@chromium.org"],"messages":[{"sender":"glotov@chromium.org","recipients":["glotov@chromium.org","avayvod@chromium.org","dpolukhin@chromium.org","chromium-reviews@chromium.org","nkostylev+cc@chromium.org","ben+cc@chromium.org"],"text":"Simpler approach. Please have a look.","disapproval":false,"date":"2010-04-07 13:19:55.594489","approval":false},{"sender":"avayvod@chromium.org","recipients":["glotov@chromium.org","avayvod@chromium.org","dpolukhin@chromium.org","chromium-reviews@chromium.org","nkostylev+cc@chromium.org","ben+cc@chromium.org"],"text":"http://codereview.chromium.org/1595014/diff/1/3\nFile chrome/browser/chromeos/login/view_screen.h (left):\n\nhttp://codereview.chromium.org/1595014/diff/1/3#oldcode83\nchrome/browser/chromeos/login/view_screen.h:83: // becuase we are in message processing for the view.\nThe comment here is explicitly against the change you made.\n\nhttp://codereview.chromium.org/1595014/diff/1/3\nFile chrome/browser/chromeos/login/view_screen.h (right):\n\nhttp://codereview.chromium.org/1595014/diff/1/3#newcode62\nchrome/browser/chromeos/login/view_screen.h:62: }\nIf we call HideAndDelete here, probably we don't need to call anything in WizardController's dtor (which is a good thing since WizardController should not depend on its screens much).\n\nhttp://codereview.chromium.org/1595014/diff/1/3#newcode79\nchrome/browser/chromeos/login/view_screen.h:79: void ViewScreen<V>::HideAndDelete() {\nSince it's not explicitly hiding anything could we call it Destroy or Delete?\n\nhttp://codereview.chromium.org/1595014/diff/1/4\nFile chrome/browser/chromeos/login/wizard_controller.cc (right):\n\nhttp://codereview.chromium.org/1595014/diff/1/4#newcode157\nchrome/browser/chromeos/login/wizard_controller.cc:157: widget_->GetRootView()->RemoveAllChildViews(true);\nI'd rather remove all children of ContentsView or explicitly called HideAndDelete on each screen rather than root view since we can't guarantee that some children of root view and itself are not referenced by something we don't control.\n\nhttp://codereview.chromium.org/1595014/diff/1/2\nFile chrome/browser/chromeos/login/wizard_screen.h (right):\n\nhttp://codereview.chromium.org/1595014/diff/1/2#newcode37\nchrome/browser/chromeos/login/wizard_screen.h:37: // Makes wizard screen invisible and immediately deletes itself.\nIt deletes the view and makes the view invisible, not the screen object.","disapproval":false,"date":"2010-04-07 13:32:15.968774","approval":false},{"sender":"glotov@chromium.org","recipients":["glotov@chromium.org","avayvod@chromium.org","dpolukhin@chromium.org","chromium-reviews@chromium.org","nkostylev+cc@chromium.org","ben+cc@chromium.org"],"text":"http://codereview.chromium.org/1595014/diff/1/3\nFile chrome/browser/chromeos/login/view_screen.h (left):\n\nhttp://codereview.chromium.org/1595014/diff/1/3#oldcode83\nchrome/browser/chromeos/login/view_screen.h:83: // becuase we are in message processing for the view.\nOn 2010/04/07 13:32:16, whywhat wrote:\n> The comment here is explicitly against the change you made.\n\nDone.\n\nhttp://codereview.chromium.org/1595014/diff/1/3\nFile chrome/browser/chromeos/login/view_screen.h (right):\n\nhttp://codereview.chromium.org/1595014/diff/1/3#newcode62\nchrome/browser/chromeos/login/view_screen.h:62: }\nOn 2010/04/07 13:32:16, whywhat wrote:\n> If we call HideAndDelete here, probably we don't need to call anything in\n> WizardController's dtor (which is a good thing since WizardController should not\n> depend on its screens much).\n\nDone.\n\nhttp://codereview.chromium.org/1595014/diff/1/3#newcode79\nchrome/browser/chromeos/login/view_screen.h:79: void ViewScreen<V>::HideAndDelete() {\nOn 2010/04/07 13:32:16, whywhat wrote:\n> Since it's not explicitly hiding anything could we call it Destroy or Delete?\n\nDone.\n\nhttp://codereview.chromium.org/1595014/diff/1/4\nFile chrome/browser/chromeos/login/wizard_controller.cc (right):\n\nhttp://codereview.chromium.org/1595014/diff/1/4#newcode157\nchrome/browser/chromeos/login/wizard_controller.cc:157: widget_->GetRootView()->RemoveAllChildViews(true);\nOn 2010/04/07 13:32:16, whywhat wrote:\n> I'd rather remove all children of ContentsView or explicitly called\n> HideAndDelete on each screen rather than root view since we can't guarantee that\n> some children of root view and itself are not referenced by something we don't\n> control.\n\nDone.\n\nhttp://codereview.chromium.org/1595014/diff/1/2\nFile chrome/browser/chromeos/login/wizard_screen.h (right):\n\nhttp://codereview.chromium.org/1595014/diff/1/2#newcode37\nchrome/browser/chromeos/login/wizard_screen.h:37: // Makes wizard screen invisible and immediately deletes itself.\nOn 2010/04/07 13:32:16, whywhat wrote:\n> It deletes the view and makes the view invisible, not the screen object.\n\nDone.","disapproval":false,"date":"2010-04-08 15:31:27.887089","approval":false},{"sender":"avayvod@chromium.org","recipients":["glotov@chromium.org","avayvod@chromium.org","dpolukhin@chromium.org","chromium-reviews@chromium.org","nkostylev+cc@chromium.org","ben+cc@chromium.org"],"text":"LGTM","disapproval":false,"date":"2010-04-08 15:47:17.890571","approval":true}],"owner_email":"glotov@chromium.org","private":false,"base_url":"svn://chrome-svn/chrome/trunk/src/","owner":"glotov","subject":"Fixing possobility of some wizard View outlive its controller....","created":"2010-04-07 13:15:31.108001","patchsets":[1,7001,10001],"modified":"2011-05-09 13:44:48.812282","closed":true,"commit":false,"issue":1595014}
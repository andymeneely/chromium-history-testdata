{"description":"Fix crash when dropping crx to chrome:extensions from Google Drive on Chrome OS.\n\nWebDropData has two fields .path and .display_name.\nThe .path field points to the real path to the file, but it can be a random\nhash value or something like that when the file is mounted through HTML5\nfile system. In order to check the file name extension, .display_name\ncontaining a user-friendly name representation has to be used.\n\nBUG=238495\nTEST=Manually tested drag&drop on CrOS and non-CrOS build.\n\nCommitted: https://src.chromium.org/viewvc/chrome?view=rev&revision=200225","cc":["chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"reviewers":["estade@chromium.org","satorux@chromium.org"],"messages":[{"sender":"kinaba@chromium.org","recipients":["kinaba@chromium.org","estade@chromium.org","satorux@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"+estade from c/b/ui/webui/OWNER and\n+satorux who knows well about the path/display_name duality.\n\nCould you kindly take a look?","disapproval":false,"date":"2013-05-13 04:11:43.395630","approval":false},{"sender":"satorux@chromium.org","recipients":["kinaba@chromium.org","estade@chromium.org","satorux@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"LGTM with a nit.\n\nhttps://codereview.chromium.org/15089003/diff/4001/chrome/browser/ui/webui/extensions/install_extension_handler.cc\nFile chrome/browser/ui/webui/extensions/install_extension_handler.cc (right):\n\nhttps://codereview.chromium.org/15089003/diff/4001/chrome/browser/ui/webui/extensions/install_extension_handler.cc#newcode72\nchrome/browser/ui/webui/extensions/install_extension_handler.cc:72: } else {\nMaybe add some comment?\n\n// Use the display name if provided, for checking file names\n// (path() is likely a random hash value in that case).","disapproval":false,"date":"2013-05-13 04:34:41.810180","approval":true},{"sender":"kinaba@chromium.org","recipients":["kinaba@chromium.org","estade@chromium.org","satorux@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"https://codereview.chromium.org/15089003/diff/4001/chrome/browser/ui/webui/extensions/install_extension_handler.cc\nFile chrome/browser/ui/webui/extensions/install_extension_handler.cc (right):\n\nhttps://codereview.chromium.org/15089003/diff/4001/chrome/browser/ui/webui/extensions/install_extension_handler.cc#newcode72\nchrome/browser/ui/webui/extensions/install_extension_handler.cc:72: } else {\nOn 2013/05/13 04:34:41, satorux1 wrote:\n> Maybe add some comment?\n> \n> // Use the display name if provided, for checking file names\n> // (path() is likely a random hash value in that case).\n\nSounds good. Done.","disapproval":false,"date":"2013-05-13 04:38:06.243810","approval":false},{"sender":"estade@chromium.org","recipients":["kinaba@chromium.org","estade@chromium.org","satorux@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"https://codereview.chromium.org/15089003/diff/10001/chrome/browser/ui/webui/extensions/install_extension_handler.cc\nFile chrome/browser/ui/webui/extensions/install_extension_handler.cc (right):\n\nhttps://codereview.chromium.org/15089003/diff/10001/chrome/browser/ui/webui/extensions/install_extension_handler.cc#newcode75\nchrome/browser/ui/webui/extensions/install_extension_handler.cc:75: file_display_name_ = base::FilePath::FromWStringHack(\ndon't add more instances of FromWStringHack. It seems like you can just store this as a string16 (do you really need the BaseName() call below?)\n\nhttps://codereview.chromium.org/15089003/diff/10001/chrome/browser/ui/webui/extensions/install_extension_handler.cc#newcode104\nchrome/browser/ui/webui/extensions/install_extension_handler.cc:104: // Have to use EndsWith() because FilePath::Extension() would return \".js\" for\nI don't think this comment is true any more, judging by file_path_unittest.cc\n\nhttps://codereview.chromium.org/15089003/diff/10001/chrome/browser/ui/webui/extensions/install_extension_handler.h\nFile chrome/browser/ui/webui/extensions/install_extension_handler.h (right):\n\nhttps://codereview.chromium.org/15089003/diff/10001/chrome/browser/ui/webui/extensions/install_extension_handler.h#newcode46\nchrome/browser/ui/webui/extensions/install_extension_handler.h:46: base::FilePath file_to_install_;\nso this is just an extension? That's confusing, given the var name.","disapproval":false,"date":"2013-05-13 19:17:32.686950","approval":false},{"sender":"kinaba@chromium.org","recipients":["kinaba@chromium.org","estade@chromium.org","satorux@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"https://codereview.chromium.org/15089003/diff/10001/chrome/browser/ui/webui/extensions/install_extension_handler.cc\nFile chrome/browser/ui/webui/extensions/install_extension_handler.cc (right):\n\nhttps://codereview.chromium.org/15089003/diff/10001/chrome/browser/ui/webui/extensions/install_extension_handler.cc#newcode75\nchrome/browser/ui/webui/extensions/install_extension_handler.cc:75: file_display_name_ = base::FilePath::FromWStringHack(\nOn 2013/05/13 19:17:32, Evan Stade wrote:\n> don't add more instances of FromWStringHack. It seems like you can just store\n> this as a string16 (do you really need the BaseName() call below?)\n\nDone.\n\nhttps://codereview.chromium.org/15089003/diff/10001/chrome/browser/ui/webui/extensions/install_extension_handler.cc#newcode104\nchrome/browser/ui/webui/extensions/install_extension_handler.cc:104: // Have to use EndsWith() because FilePath::Extension() would return \".js\" for\nOn 2013/05/13 19:17:32, Evan Stade wrote:\n> I don't think this comment is true any more, judging by file_path_unittest.cc\n\nJust removed the comment.\n|file_display_name_| is now string16, so FilePath::Extension is not applicable.\n\nhttps://codereview.chromium.org/15089003/diff/10001/chrome/browser/ui/webui/extensions/install_extension_handler.h\nFile chrome/browser/ui/webui/extensions/install_extension_handler.h (right):\n\nhttps://codereview.chromium.org/15089003/diff/10001/chrome/browser/ui/webui/extensions/install_extension_handler.h#newcode46\nchrome/browser/ui/webui/extensions/install_extension_handler.h:46: base::FilePath file_to_install_;\nOn 2013/05/13 19:17:32, Evan Stade wrote:\n> so this is just an extension? That's confusing, given the var name.\n\nExtension here means the Chrome extension, not the file extension like \".crx\",\nso I think the var name is making sense. But tweaked the comment\na little to make it clearer.","disapproval":false,"date":"2013-05-14 03:33:51.101650","approval":false},{"sender":"estade@chromium.org","recipients":["kinaba@chromium.org","estade@chromium.org","satorux@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"lgtm","disapproval":false,"date":"2013-05-14 21:01:43.790090","approval":true},{"sender":"commit-bot@chromium.org","recipients":["kinaba@chromium.org","estade@chromium.org","satorux@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/kinaba@chromium.org/15089003/15001","disapproval":false,"date":"2013-05-15 02:11:03.487370","approval":false},{"sender":"commit-bot@chromium.org","recipients":["kinaba@chromium.org","estade@chromium.org","satorux@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"Change committed as 200225","disapproval":false,"date":"2013-05-15 09:50:54.173680","approval":false}],"owner_email":"kinaba@chromium.org","private":false,"base_url":"svn://svn.chromium.org/chrome/trunk/src","owner":"kinaba","subject":"Fix crash when dropping crx to chrome:extensions from Google Drive on Chrome OS.","created":"2013-05-13 03:22:48.262290","patchsets":[4001,10001,15001],"modified":"2013-05-15 09:50:54.380790","closed":true,"commit":false,"issue":15089003}
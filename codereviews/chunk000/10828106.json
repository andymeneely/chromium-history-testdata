{"description":"Support serial number requests in variations service.\n\nBUG=140073\nTEST=manual using inserted logging\n\nCommitted: http://src.chromium.org/viewvc/chrome?view=rev&revision=149979","cc":["chromium-reviews@chromium.org","mad@chromium.org","isherman@chromium.org","jar@chromium.org","finch-team@google.com"],"reviewers":["stevet@chromium.org","jar@chromium.org","isherman@chromium.org"],"messages":[{"sender":"asvitkine@chromium.org","recipients":["asvitkine@chromium.org","stevet@chromium.org","finch-team@google.com","chromium-reviews@chromium.org","mad@chromium.org","isherman@chromium.org","jar@chromium.org"],"text":"","disapproval":false,"date":"2012-08-01 20:24:52.884990","approval":false},{"sender":"stevet@chromium.org","recipients":["asvitkine@chromium.org","stevet@chromium.org","finch-team@google.com","chromium-reviews@chromium.org","mad@chromium.org","isherman@chromium.org","jar@chromium.org"],"text":"LGTM.\n\nTEST= is meant to be instructions for QA, not necessarily what you did. Could you provide some instructions that QA could use to test this?\n\nhttp://codereview.chromium.org/10828106/diff/4003/chrome/browser/metrics/variations_service.cc\nFile chrome/browser/metrics/variations_service.cc (right):\n\nhttp://codereview.chromium.org/10828106/diff/4003/chrome/browser/metrics/variations_service.cc#newcode169\nchrome/browser/metrics/variations_service.cc:169: variations_serial_number_);\nnit: This spans two lines, so I believe we want to wrap it in braces.","disapproval":false,"date":"2012-08-02 17:31:50.916630","approval":true},{"sender":"asvitkine@chromium.org","recipients":["asvitkine@chromium.org","stevet@chromium.org","finch-team@google.com","chromium-reviews@chromium.org","mad@chromium.org","isherman@chromium.org","jar@chromium.org"],"text":"> TEST= is meant to be instructions for QA, not necessarily what you did. Could\n> you provide some instructions that QA could use to test this?\n\nI'm not sure there's any way for QA to test this given their current practices. (i.e. it's unreasonable to expect them to bring up their own servers and validate the communicate stream between the two endpoints). QA mostly checks for visual / user experience issues, not how Chrome internals work.\n\nThe TEST= line is highly debated and I'm on the side where it's better to have it there to document how the change was tested then to omit it in the case where the change can't be verified by QA.\n\nhttp://codereview.chromium.org/10828106/diff/4003/chrome/browser/metrics/variations_service.cc\nFile chrome/browser/metrics/variations_service.cc (right):\n\nhttp://codereview.chromium.org/10828106/diff/4003/chrome/browser/metrics/variations_service.cc#newcode169\nchrome/browser/metrics/variations_service.cc:169: variations_serial_number_);\nOn 2012/08/02 17:31:51, SteveT wrote:\n> nit: This spans two lines, so I believe we want to wrap it in braces.\n\nDone.","disapproval":false,"date":"2012-08-02 18:37:51.626880","approval":false},{"sender":"commit-bot@chromium.org","recipients":["asvitkine@chromium.org","stevet@chromium.org","finch-team@google.com","chromium-reviews@chromium.org","mad@chromium.org","isherman@chromium.org","jar@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/asvitkine@chromium.org/10828106/2002","disapproval":false,"date":"2012-08-02 18:39:13.015040","approval":false},{"sender":"commit-bot@chromium.org","recipients":["asvitkine@chromium.org","stevet@chromium.org","finch-team@google.com","chromium-reviews@chromium.org","mad@chromium.org","isherman@chromium.org","jar@chromium.org"],"text":"Presubmit check for 10828106-2002 failed and returned exit status 1.\n\nRunning presubmit commit checks ...\n\n** Presubmit ERRORS **\nMissing LGTM from an OWNER for files in these directories:\n    chrome/browser/metrics\n\nPresubmit checks took 1.1s to calculate.\n\nWas the presubmit check useful? Please send feedback & hate mail to maruel@chromium.org!","disapproval":false,"date":"2012-08-02 18:39:16.117410","approval":false},{"sender":"asvitkine@chromium.org","recipients":["asvitkine@chromium.org","stevet@chromium.org","jar@chromium.org","finch-team@google.com","chromium-reviews@chromium.org","mad@chromium.org","isherman@chromium.org","jar@chromium.org"],"text":"+jar for chrome/browser/metrics/OWNERS","disapproval":false,"date":"2012-08-02 18:42:27.047730","approval":false},{"sender":"isherman@chromium.org","recipients":["asvitkine@chromium.org","stevet@chromium.org","jar@chromium.org","finch-team@google.com","isherman@chromium.org","chromium-reviews@chromium.org","mad@chromium.org","isherman@chromium.org","jar@chromium.org"],"text":"LGTM, with a couple of questions inline.\n\nhttps://chromiumcodereview.appspot.com/10828106/diff/2002/chrome/browser/metrics/variations_service.cc\nFile chrome/browser/metrics/variations_service.cc (right):\n\nhttps://chromiumcodereview.appspot.com/10828106/diff/2002/chrome/browser/metrics/variations_service.cc#newcode108\nchrome/browser/metrics/variations_service.cc:108: create_trials_from_seed_called_ = true;\nnit: Is it ok that this method can return |false| after this line?  Is the DCHECK below that uses this variable just making sure that we don't lose the optimization we gain in non-exceptional cases from caching the seed?\n\nhttps://chromiumcodereview.appspot.com/10828106/diff/2002/chrome/browser/metrics/variations_service.h\nFile chrome/browser/metrics/variations_service.h (right):\n\nhttps://chromiumcodereview.appspot.com/10828106/diff/2002/chrome/browser/metrics/variations_service.h#newcode136\nchrome/browser/metrics/variations_service.h:136: bool create_trials_from_seed_called_;\nnit: This seems a little hacky.  Is there any way to more directly check whether CreateTrialsFromSeed() initialized whatever data you're expecting to be initialized?","disapproval":false,"date":"2012-08-02 23:40:48.951800","approval":true},{"sender":"asvitkine@chromium.org","recipients":["asvitkine@chromium.org","stevet@chromium.org","jar@chromium.org","finch-team@google.com","isherman@chromium.org","chromium-reviews@chromium.org","mad@chromium.org","isherman@chromium.org","jar@chromium.org"],"text":"Thanks, Ilya.\n\nI still need an OWNERS approval from chrome/browser/metrics/OWNERS (you're not listed there).\n\nhttps://chromiumcodereview.appspot.com/10828106/diff/2002/chrome/browser/metrics/variations_service.cc\nFile chrome/browser/metrics/variations_service.cc (right):\n\nhttps://chromiumcodereview.appspot.com/10828106/diff/2002/chrome/browser/metrics/variations_service.cc#newcode108\nchrome/browser/metrics/variations_service.cc:108: create_trials_from_seed_called_ = true;\nOn 2012/08/02 23:40:49, Ilya Sherman wrote:\n> nit: Is it ok that this method can return |false| after this line?  Is the\n> DCHECK below that uses this variable just making sure that we don't lose the\n> optimization we gain in non-exceptional cases from caching the seed?\n\nRight, it's just making sure we don't lose the optimization. It's not necessary that |variations_serial_number_| actually got set (and it's valid for it not to be - e.g. on first run).\n\nhttps://chromiumcodereview.appspot.com/10828106/diff/2002/chrome/browser/metrics/variations_service.h\nFile chrome/browser/metrics/variations_service.h (right):\n\nhttps://chromiumcodereview.appspot.com/10828106/diff/2002/chrome/browser/metrics/variations_service.h#newcode136\nchrome/browser/metrics/variations_service.h:136: bool create_trials_from_seed_called_;\nOn 2012/08/02 23:40:49, Ilya Sherman wrote:\n> nit: This seems a little hacky.  Is there any way to more directly check whether\n> CreateTrialsFromSeed() initialized whatever data you're expecting to be\n> initialized?\n\nI can't think of a good way - the issue is that it's perfectly valid for CreateTrialsFromSeed() to return early if there's no seed stored in prefs yet.","disapproval":false,"date":"2012-08-02 23:51:02.604050","approval":false},{"sender":"commit-bot@chromium.org","recipients":["asvitkine@chromium.org","stevet@chromium.org","jar@chromium.org","isherman@chromium.org","chromium-reviews@chromium.org","mad@chromium.org","isherman@chromium.org","jar@chromium.org","finch-team@google.com"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/asvitkine@chromium.org/10828106/2002","disapproval":false,"date":"2012-08-03 20:15:46.838200","approval":false},{"sender":"commit-bot@chromium.org","recipients":["asvitkine@chromium.org","stevet@chromium.org","jar@chromium.org","isherman@chromium.org","chromium-reviews@chromium.org","mad@chromium.org","isherman@chromium.org","jar@chromium.org","finch-team@google.com"],"text":"Try job failure for 10828106-2002 (retry) (retry) on win_rel for step \"compile\" (clobber build).\nIt's a second try, previously, step \"compile\" failed.\nhttp://build.chromium.org/p/tryserver.chromium/buildstatus?builder=win_rel&number=49649","disapproval":false,"date":"2012-08-03 22:42:42.035310","approval":false},{"sender":"commit-bot@chromium.org","recipients":["asvitkine@chromium.org","stevet@chromium.org","jar@chromium.org","isherman@chromium.org","chromium-reviews@chromium.org","mad@chromium.org","isherman@chromium.org","jar@chromium.org","finch-team@google.com"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/asvitkine@chromium.org/10828106/2002","disapproval":false,"date":"2012-08-03 22:44:57.097880","approval":false},{"sender":"commit-bot@chromium.org","recipients":["asvitkine@chromium.org","stevet@chromium.org","jar@chromium.org","isherman@chromium.org","chromium-reviews@chromium.org","mad@chromium.org","isherman@chromium.org","jar@chromium.org","finch-team@google.com"],"text":"Change committed as 149979","disapproval":false,"date":"2012-08-04 00:02:22.795400","approval":false}],"owner_email":"asvitkine@chromium.org","private":false,"base_url":"svn://svn.chromium.org/chrome/trunk/src/","owner":"Alexei Svitkine","subject":"Support serial number requests in variations service.","created":"2012-08-01 01:56:17.363980","patchsets":[4003,2002],"modified":"2012-08-04 00:02:22.966860","closed":true,"commit":false,"issue":10828106}
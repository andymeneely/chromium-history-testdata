{"description":"Disable key-auto-repeat globally, instead of for individual keys.\r\n\r\nFor the duration of a Linux Chromoting session, globally\r\ndisable keyboard auto-repeat whenever any keys are pressed,\r\ninstead of disabling for individual keys as they are\r\npressed/released. The old behavior was generating a lot of X\r\nserver churn, creating lots of compiled keymaps on disk.\r\n\r\n\r\nBUG=168295\r\nTEST=manual (verify auto-repeat behavior is controlled by the client, not the host)\n\nCommitted: https://src.chromium.org/viewvc/chrome?view=rev&revision=188190","cc":["chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","dcaiafa+watch@chromium.org","simonmorris+watch@chromium.org","hclam+watch@chromium.org","wez+watch@chromium.org","amit@chromium.org","sanjeevr@chromium.org","garykac+watch@chromium.org","lambroslambrou+watch@chromium.org","rmsousa+watch@chromium.org","alexeypa+watch@chromium.org","sergeyu+watch@chromium.org"],"reviewers":["wez@chromium.org"],"messages":[{"sender":"lambroslambrou@chromium.org","recipients":["lambroslambrou@chromium.org","wez@chromium.org","chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","dcaiafa+watch@chromium.org","simonmorris+watch@chromium.org","hclam+watch@chromium.org","wez+watch@chromium.org","amit@chromium.org","sanjeevr@chromium.org","garykac+watch@chromium.org","lambroslambrou+watch@chromium.org","rmsousa+watch@chromium.org","alexeypa+watch@chromium.org","sergeyu+watch@chromium.org"],"text":"","disapproval":false,"date":"2013-03-09 03:18:36.615800","approval":false},{"sender":"wez@chromium.org","recipients":["lambroslambrou@chromium.org","wez@chromium.org","chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","dcaiafa+watch@chromium.org","simonmorris+watch@chromium.org","hclam+watch@chromium.org","wez+watch@chromium.org","amit@chromium.org","sanjeevr@chromium.org","garykac+watch@chromium.org","lambroslambrou+watch@chromium.org","rmsousa+watch@chromium.org","alexeypa+watch@chromium.org","sergeyu+watch@chromium.org"],"text":"This looks good for the Me2Me case.\n\nFor IT2Me it's important that auto-repeat works even during a session, so long as no keys are pressed remotely.  IIRC these controls affect the X server's \"software\" auto-repeat - do they affect the hardware auto-repeat in the keyboard? i.e. if we disable auto-repeat globally can the user e.g. navigate up & down a document by pressing and holding down the up/down keys, or would they need to keep pressing & releasing them?\n\nhttps://codereview.chromium.org/12663009/diff/1/remoting/host/event_executor_linux.cc\nFile remoting/host/event_executor_linux.cc (right):\n\nhttps://codereview.chromium.org/12663009/diff/1/remoting/host/event_executor_linux.cc#newcode86\nremoting/host/event_executor_linux.cc:86: bool GetAutoRepeatMode();\nnit: GetAutoRepeatMode -> IsAutoRepeatEnabled()\n\nhttps://codereview.chromium.org/12663009/diff/1/remoting/host/event_executor_linux.cc#newcode86\nremoting/host/event_executor_linux.cc:86: bool GetAutoRepeatMode();\nnit: Add a comment before these two methods to explain their purpose.\n\nhttps://codereview.chromium.org/12663009/diff/1/remoting/host/event_executor_linux.cc#newcode87\nremoting/host/event_executor_linux.cc:87: void SetAutoRepeatMode(bool mode);\nnit: SetAutoRepeatMode -> SetAutoRepeatEnabled\n\nhttps://codereview.chromium.org/12663009/diff/1/remoting/host/event_executor_linux.cc#newcode119\nremoting/host/event_executor_linux.cc:119: bool saved_auto_repeat_mode_;\nnit: auto_repeat_enabled_\n\nhttps://codereview.chromium.org/12663009/diff/1/remoting/host/event_executor_linux.cc#newcode481\nremoting/host/event_executor_linux.cc:481: XFlush(display_);\nIs the XFlush needed here in case we're about to tear-down the Display, and thereby lose any un-flushed data? If so then I'd suggest doing it after clipboard_->Stop(), so it'll apply to any X calls performed during Core::Stop().","disapproval":false,"date":"2013-03-11 16:22:04.249140","approval":false},{"sender":"lambroslambrou@chromium.org","recipients":["lambroslambrou@chromium.org","wez@chromium.org","chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","dcaiafa+watch@chromium.org","simonmorris+watch@chromium.org","hclam+watch@chromium.org","wez+watch@chromium.org","amit@chromium.org","sanjeevr@chromium.org","garykac+watch@chromium.org","lambroslambrou+watch@chromium.org","rmsousa+watch@chromium.org","alexeypa+watch@chromium.org","sergeyu+watch@chromium.org"],"text":"On 2013/03/11 16:22:04, Wez wrote:\n> This looks good for the Me2Me case.\n> \n> For IT2Me it's important that auto-repeat works even during a session, so long\n> as no keys are pressed remotely.  IIRC these controls affect the X server's\n> \"software\" auto-repeat - do they affect the hardware auto-repeat in the\n> keyboard? i.e. if we disable auto-repeat globally can the user e.g. navigate up\n> & down a document by pressing and holding down the up/down keys, or would they\n> need to keep pressing & releasing them?\nIn my test, I need to keep pressing & releasing them. But I don't think I have hardware auto-repeat anyway.\n\nThere is a possibility of disabling auto-repeat only for the XTEST device, using X{Get|Change}FeedbackControl(). I haven't tried it yet, and these APIs are a little tricky to use, with many error-paths.\n\nTake a look at Patch Set 2, and see if you think it's good enough, or whether it's important enough to go the XTEST route.","disapproval":false,"date":"2013-03-12 01:41:06.112670","approval":false},{"sender":"lambroslambrou@chromium.org","recipients":["lambroslambrou@chromium.org","wez@chromium.org","chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","dcaiafa+watch@chromium.org","simonmorris+watch@chromium.org","hclam+watch@chromium.org","wez+watch@chromium.org","amit@chromium.org","sanjeevr@chromium.org","garykac+watch@chromium.org","lambroslambrou+watch@chromium.org","rmsousa+watch@chromium.org","alexeypa+watch@chromium.org","sergeyu+watch@chromium.org"],"text":"https://codereview.chromium.org/12663009/diff/1/remoting/host/event_executor_linux.cc\nFile remoting/host/event_executor_linux.cc (right):\n\nhttps://codereview.chromium.org/12663009/diff/1/remoting/host/event_executor_linux.cc#newcode86\nremoting/host/event_executor_linux.cc:86: bool GetAutoRepeatMode();\nOn 2013/03/11 16:22:04, Wez wrote:\n> nit: GetAutoRepeatMode -> IsAutoRepeatEnabled()\n\nDone.\n\nhttps://codereview.chromium.org/12663009/diff/1/remoting/host/event_executor_linux.cc#newcode86\nremoting/host/event_executor_linux.cc:86: bool GetAutoRepeatMode();\nOn 2013/03/11 16:22:04, Wez wrote:\n> nit: Add a comment before these two methods to explain their purpose.\n\nDone.\n\nhttps://codereview.chromium.org/12663009/diff/1/remoting/host/event_executor_linux.cc#newcode87\nremoting/host/event_executor_linux.cc:87: void SetAutoRepeatMode(bool mode);\nOn 2013/03/11 16:22:04, Wez wrote:\n> nit: SetAutoRepeatMode -> SetAutoRepeatEnabled\n\nDone.\n\nhttps://codereview.chromium.org/12663009/diff/1/remoting/host/event_executor_linux.cc#newcode119\nremoting/host/event_executor_linux.cc:119: bool saved_auto_repeat_mode_;\nOn 2013/03/11 16:22:04, Wez wrote:\n> nit: auto_repeat_enabled_\nI've kept \"saved\" in the name, because otherwise your suggestions would cause this name to match the new Is/Set.. methods, making them look like getters/setters for this variable, when they're not.\n\nhttps://codereview.chromium.org/12663009/diff/1/remoting/host/event_executor_linux.cc#newcode481\nremoting/host/event_executor_linux.cc:481: XFlush(display_);\nOn 2013/03/11 16:22:04, Wez wrote:\n> Is the XFlush needed here in case we're about to tear-down the Display, and\n> thereby lose any un-flushed data? If so then I'd suggest doing it after\n> clipboard_->Stop(), so it'll apply to any X calls performed during Core::Stop().\nRemoved this block of code.","disapproval":false,"date":"2013-03-12 01:41:28.446010","approval":false},{"sender":"wez@chromium.org","recipients":["lambroslambrou@chromium.org","wez@chromium.org","chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","dcaiafa+watch@chromium.org","simonmorris+watch@chromium.org","hclam+watch@chromium.org","wez+watch@chromium.org","amit@chromium.org","sanjeevr@chromium.org","garykac+watch@chromium.org","lambroslambrou+watch@chromium.org","rmsousa+watch@chromium.org","alexeypa+watch@chromium.org","sergeyu+watch@chromium.org"],"text":"So now you're disabling auto-repeat globally while one or more keys are pressed, and re-enabling it when all keys are released, IIUC.  The idea being that we'll end up with precisely two compiled keymap files, one w/ auto-repeat, the other without?\n\nIf so then that sounds reasonable, but please update the CL description accordingly.\n\nhttps://codereview.chromium.org/12663009/diff/5001/remoting/host/event_executor_linux.cc\nFile remoting/host/event_executor_linux.cc (right):\n\nhttps://codereview.chromium.org/12663009/diff/5001/remoting/host/event_executor_linux.cc#newcode86\nremoting/host/event_executor_linux.cc:86: // Queries whether keyboard auto-repeat is currently enabled. This is used\nnit: globally disabled?\n\nhttps://codereview.chromium.org/12663009/diff/5001/remoting/host/event_executor_linux.cc#newcode92\nremoting/host/event_executor_linux.cc:92: // Enables or disables keyboard auto-repeat.\nnit: globally","disapproval":false,"date":"2013-03-12 02:00:54.532100","approval":false},{"sender":"lambroslambrou@chromium.org","recipients":["lambroslambrou@chromium.org","wez@chromium.org","chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","dcaiafa+watch@chromium.org","simonmorris+watch@chromium.org","hclam+watch@chromium.org","wez+watch@chromium.org","amit@chromium.org","sanjeevr@chromium.org","garykac+watch@chromium.org","lambroslambrou+watch@chromium.org","rmsousa+watch@chromium.org","alexeypa+watch@chromium.org","sergeyu+watch@chromium.org"],"text":"Updated description.\n\nhttps://codereview.chromium.org/12663009/diff/5001/remoting/host/event_executor_linux.cc\nFile remoting/host/event_executor_linux.cc (right):\n\nhttps://codereview.chromium.org/12663009/diff/5001/remoting/host/event_executor_linux.cc#newcode86\nremoting/host/event_executor_linux.cc:86: // Queries whether keyboard auto-repeat is currently enabled. This is used\nOn 2013/03/12 02:00:54, Wez wrote:\n> nit: globally disabled?\n\nDone.\n\nhttps://codereview.chromium.org/12663009/diff/5001/remoting/host/event_executor_linux.cc#newcode92\nremoting/host/event_executor_linux.cc:92: // Enables or disables keyboard auto-repeat.\nOn 2013/03/12 02:00:54, Wez wrote:\n> nit: globally\n\nDone.","disapproval":false,"date":"2013-03-12 20:16:23.481340","approval":false},{"sender":"lambroslambrou@chromium.org","recipients":["lambroslambrou@chromium.org","wez@chromium.org","chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","dcaiafa+watch@chromium.org","simonmorris+watch@chromium.org","hclam+watch@chromium.org","wez+watch@chromium.org","amit@chromium.org","sanjeevr@chromium.org","garykac+watch@chromium.org","lambroslambrou+watch@chromium.org","rmsousa+watch@chromium.org","alexeypa+watch@chromium.org","sergeyu+watch@chromium.org"],"text":"LG?","disapproval":false,"date":"2013-03-12 23:03:47.444920","approval":false},{"sender":"wez@chromium.org","recipients":["lambroslambrou@chromium.org","wez@chromium.org","chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","dcaiafa+watch@chromium.org","simonmorris+watch@chromium.org","hclam+watch@chromium.org","wez+watch@chromium.org","amit@chromium.org","sanjeevr@chromium.org","garykac+watch@chromium.org","lambroslambrou+watch@chromium.org","rmsousa+watch@chromium.org","alexeypa+watch@chromium.org","sergeyu+watch@chromium.org"],"text":"lgtm","disapproval":false,"date":"2013-03-13 04:35:11.501090","approval":true},{"sender":"commit-bot@chromium.org","recipients":["lambroslambrou@chromium.org","wez@chromium.org","chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","dcaiafa+watch@chromium.org","simonmorris+watch@chromium.org","hclam+watch@chromium.org","wez+watch@chromium.org","amit@chromium.org","sanjeevr@chromium.org","garykac+watch@chromium.org","lambroslambrou+watch@chromium.org","rmsousa+watch@chromium.org","alexeypa+watch@chromium.org","sergeyu+watch@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/lambroslambrou@chromium.org/12663009/8001","disapproval":false,"date":"2013-03-13 19:00:48.403260","approval":false},{"sender":"commit-bot@chromium.org","recipients":["lambroslambrou@chromium.org","wez@chromium.org","chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","dcaiafa+watch@chromium.org","simonmorris+watch@chromium.org","hclam+watch@chromium.org","wez+watch@chromium.org","amit@chromium.org","sanjeevr@chromium.org","garykac+watch@chromium.org","lambroslambrou+watch@chromium.org","rmsousa+watch@chromium.org","alexeypa+watch@chromium.org","sergeyu+watch@chromium.org"],"text":"Step \"update\" is always a major failure.\nLook at the try server FAQ for more details.\nhttp://build.chromium.org/p/tryserver.chromium/buildstatus?builder=linux_chromeos&number=92669","disapproval":false,"date":"2013-03-14 00:15:11.656990","approval":false},{"sender":"lambroslambrou@chromium.org","recipients":["lambroslambrou@chromium.org","wez@chromium.org","chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","dcaiafa+watch@chromium.org","simonmorris+watch@chromium.org","hclam+watch@chromium.org","wez+watch@chromium.org","amit@chromium.org","sanjeevr@chromium.org","garykac+watch@chromium.org","lambroslambrou+watch@chromium.org","rmsousa+watch@chromium.org","alexeypa+watch@chromium.org","sergeyu+watch@chromium.org"],"text":"Committed patchset #3 manually as r188190 (presubmit successful).","disapproval":false,"date":"2013-03-14 20:57:57.262910","approval":false}],"owner_email":"lambroslambrou@chromium.org","private":false,"base_url":"svn://svn.chromium.org/chrome/trunk/src","owner":"Lambros","subject":"Disable key-auto-repeat globally, instead of for individual keys.","created":"2013-03-09 03:18:12.688360","patchsets":[1,5001,8001],"modified":"2013-03-14 20:57:57.357910","closed":true,"commit":false,"issue":12663009}
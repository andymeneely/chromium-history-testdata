{"description":"Disable Firefox password protected profile tests on Win64 build\n\nWhen reading a password protected profile, the importer loads\nthe NSS libraries for the currently installed Firefox. Since\nthose are 32-bit libraries, they fail in the Win64 build.\n\nBUG=179688\nR=isherman@chromium.org\nCommitted: https://src.chromium.org/viewvc/chrome?view=rev&revision=185809","cc":["chromium-reviews@chromium.org","tfarina@chromium.org"],"reviewers":["isherman@chromium.org","jochen@chromium.org"],"messages":[{"sender":"jschuh@chromium.org","recipients":["jschuh@chromium.org","jochen@chromium.org","isherman@chromium.org","chromium-reviews@chromium.org","tfarina@chromium.org"],"text":"","disapproval":false,"date":"2013-03-03 05:58:22.294950","approval":false},{"sender":"jochen@chromium.org","recipients":["reply@chromiumcodereview-hr.appspotmail.com"],"text":"lgtm\r\nOn Mar 3, 2013 6:58 AM, <jschuh@chromium.org> wrote:\r\n\r\n> Reviewers: jochen, Ilya Sherman,\r\n>\r\n> Description:\r\n> Disable Firefox password protected profile tests on Win64 build\r\n>\r\n> When reading a password protected profile, the importer loads\r\n> the NSS libraries for the currently installed Firefox. Since\r\n> those are 32-bit libraries, they fail in the Win64 build.\r\n>\r\n> BUG=179688\r\n> R=isherman@chromium.org\r\n>\r\n> Please review this at https://codereview.chromium.**org/12387071/<https://codereview.chromium.org/12387071/>\r\n>\r\n> SVN Base: svn://svn.chromium.org/chrome/**trunk/src/<http://svn.chromium.org/chrome/trunk/src/>\r\n>\r\n> Affected files:\r\n>   M     chrome/browser/importer/**firefox_importer_unittest.cc\r\n>\r\n>\r\n> Index: chrome/browser/importer/**firefox_importer_unittest.cc\r\n> ==============================**==============================**=======\r\n> --- chrome/browser/importer/**firefox_importer_unittest.cc\r\n>  (revision 185796)\r\n> +++ chrome/browser/importer/**firefox_importer_unittest.cc\r\n>  (working copy)\r\n> @@ -28,12 +28,20 @@\r\n>  #include \"content/public/common/**password_form.h\"\r\n>\r\n>  // TODO(estade): some of these are disabled on mac.\r\n> http://crbug.com/48007\r\n> -#if defined(OS_MACOSX)\r\n> -#define MAYBE(x) DISABLED_##x\r\n> +// TODO(jschuh): Disabled on Win64 build. http://crbug.com/179688\r\n> +#if defined(OS_MACOSX) || (defined(OS_WIN) && defined(ARCH_CPU_X86_64))\r\n> +#define MAYBE_IMPORTER(x) DISABLED_##x\r\n>  #else\r\n> -#define MAYBE(x) x\r\n> +#define MAYBE_IMPORTER(x) x\r\n>  #endif\r\n>\r\n> +// TODO(jschuh): Disabled on Win64 build. http://crbug.com/179688\r\n> +#if defined(OS_WIN) && defined(ARCH_CPU_X86_64)\r\n> +#define MAYBE_NSS(x) DISABLED_##x\r\n> +#else\r\n> +#define MAYBE_NSS(x) x\r\n> +#endif\r\n> +\r\n>  namespace {\r\n>\r\n>  const BookmarkInfo kFirefox2Bookmarks[] = {\r\n> @@ -428,7 +436,7 @@\r\n>    base::FilePath app_path_;\r\n>  };\r\n>\r\n> -TEST_F(**FirefoxProfileImporterTest, MAYBE(Firefox2Importer)) {\r\n> +TEST_F(**FirefoxProfileImporterTest, MAYBE_IMPORTER(**Firefox2Importer))\r\n> {\r\n>    base::FilePath data_path;\r\n>    ASSERT_TRUE(PathService::Get(**chrome::DIR_TEST_DATA, &data_path));\r\n>    data_path = data_path.AppendASCII(\"**firefox2_profile\");\r\n> @@ -470,13 +478,13 @@\r\n>    loop->Run();\r\n>  }\r\n>\r\n> -TEST_F(**FirefoxProfileImporterTest, MAYBE(Firefox30Importer)) {\r\n> +TEST_F(**FirefoxProfileImporterTest, MAYBE_IMPORTER(**Firefox30Importer))\r\n> {\r\n>    scoped_refptr<**Firefox3Observer> observer(new Firefox3Observer());\r\n>    Firefox3xImporterTest(\"**firefox3_profile\", observer.get(),\r\n> observer.get(),\r\n>                          true);\r\n>  }\r\n>\r\n> -TEST_F(**FirefoxProfileImporterTest, MAYBE(Firefox35Importer)) {\r\n> +TEST_F(**FirefoxProfileImporterTest, MAYBE_IMPORTER(**Firefox35Importer))\r\n> {\r\n>    bool import_search_engines = false;\r\n>    scoped_refptr<**Firefox3Observer> observer(\r\n>        new Firefox3Observer(import_**search_engines));\r\n> @@ -487,7 +495,7 @@\r\n>  // The following 2 tests require the use of the NSSDecryptor, on OSX this\r\n> needs\r\n>  // to run in a separate process, so we use a proxy object so we can share\r\n> the\r\n>  // same test between platforms.\r\n> -TEST(FirefoxImporterTest, Firefox2NSS3Decryptor) {\r\n> +TEST(FirefoxImporterTest, MAYBE_NSS(**Firefox2NSS3Decryptor)) {\r\n>    base::FilePath nss_path;\r\n>    ASSERT_TRUE(PathService::Get(**chrome::DIR_TEST_DATA, &nss_path));\r\n>  #ifdef OS_MACOSX\r\n> @@ -512,7 +520,7 @@\r\n>                                \"OQ5ZFmhb8BAiFo1Z+fUvaIQ==\"));\r\n>  }\r\n>\r\n> -TEST(FirefoxImporterTest, Firefox3NSS3Decryptor) {\r\n> +TEST(FirefoxImporterTest, MAYBE_NSS(**Firefox3NSS3Decryptor)) {\r\n>    base::FilePath nss_path;\r\n>    ASSERT_TRUE(PathService::Get(**chrome::DIR_TEST_DATA, &nss_path));\r\n>  #ifdef OS_MACOSX\r\n>\r\n>\r\n>\r\n","disapproval":false,"date":"2013-03-03 07:49:42.048980","approval":true},{"sender":"commit-bot@chromium.org","recipients":["jschuh@chromium.org","isherman@chromium.org","jochen@chromium.org","chromium-reviews@chromium.org","tfarina@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/jschuh@chromium.org/12387071/1","disapproval":false,"date":"2013-03-03 14:14:04.840930","approval":false},{"sender":"commit-bot@chromium.org","recipients":["jschuh@chromium.org","isherman@chromium.org","jochen@chromium.org","chromium-reviews@chromium.org","tfarina@chromium.org"],"text":"Sorry for I got bad news for ya.\nCompile failed with a clobber build on win_rel.\nhttp://build.chromium.org/p/tryserver.chromium/buildstatus?builder=win_rel&number=117613\nYour code is likely broken or HEAD is junk. Please ensure your\ncode is not broken then alert the build sheriffs.\nLook at the try server FAQ for more details.","disapproval":false,"date":"2013-03-03 15:27:53.257860","approval":false},{"sender":"commit-bot@chromium.org","recipients":["jschuh@chromium.org","isherman@chromium.org","jochen@chromium.org","chromium-reviews@chromium.org","tfarina@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/jschuh@chromium.org/12387071/1","disapproval":false,"date":"2013-03-03 15:36:57.230880","approval":false},{"sender":"jschuh@chromium.org","recipients":["jschuh@chromium.org","isherman@chromium.org","jochen@chromium.org","chromium-reviews@chromium.org","tfarina@chromium.org"],"text":"Committed patchset #1 manually as r185809 (presubmit successful).","disapproval":false,"date":"2013-03-03 16:27:11.755160","approval":false}],"owner_email":"jschuh@chromium.org","private":false,"base_url":"svn://svn.chromium.org/chrome/trunk/src/","owner":"Justin Schuh","subject":"Disable Firefox password protected profile tests on Win64 build","created":"2013-03-03 05:55:59.106920","patchsets":[1],"modified":"2013-03-03 16:27:11.921900","closed":true,"commit":false,"issue":12387071}
{"files":{"chrome/browser/prerender/prerender_contents.cc":{"status":"M    ","num_chunks":4,"no_base_file":false,"property_changes":"","num_added":24,"num_removed":1,"messages":[],"id":23002,"is_binary":false},"chrome/browser/prerender/prerender_contents.h":{"status":"M    ","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":1,"num_removed":0,"messages":[],"id":23003,"is_binary":false},"chrome/common/notification_type.h":{"status":"M    ","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":7,"num_removed":0,"messages":[],"id":23006,"is_binary":false},"chrome/test/data/prerender/prerender_download_iframe.html":{"status":"A    ","num_chunks":1,"no_base_file":false,"property_changes":"\nAdded: svn:eol-style\n   + LF\n","num_added":7,"num_removed":0,"messages":[],"id":23007,"is_binary":false},"chrome/browser/prerender/prerender_browsertest.cc":{"status":"M    ","num_chunks":2,"no_base_file":false,"property_changes":"","num_added":22,"num_removed":2,"messages":[],"id":23001,"is_binary":false},"chrome/test/data/prerender/prerender_download_refresh.html":{"status":"A    ","num_chunks":1,"no_base_file":false,"property_changes":"\nAdded: svn:eol-style\n   + LF\n","num_added":6,"num_removed":0,"messages":[],"id":23009,"is_binary":false},"chrome/browser/renderer_host/download_resource_handler.cc":{"status":"M    ","num_chunks":2,"no_base_file":false,"property_changes":"","num_added":20,"num_removed":0,"messages":[{"author":"rdsmith","author_email":"rdsmith@chromium.org","text":"I'd rather not notify from the DownloadResourceHandler constructor, as that'll mean in the case where a download comes off of the usual path (i.e. through the DownloadThrottlingResourceHandler) you'll get two notifications that the same download is starting.  I don't like the fragility of putting the notification in ResourceDispatcherHost::BeginDownload, but it has the advantage of covering all the (current :-{) pathways through which a download can be initiated while still giving you the notification you're looking for when the initiation doesn't actually go through to creating a DownloadResourceHandler.\n","draft":false,"lineno":68,"date":"2011-02-13 03:08:36.276590","left":false},{"author":"dominich","author_email":"dominich@chromium.org","text":"On 2011/02/13 03:08:36, rdsmith wrote:\n> I'd rather not notify from the DownloadResourceHandler constructor, as that'll\n> mean in the case where a download comes off of the usual path (i.e. through the\n> DownloadThrottlingResourceHandler) you'll get two notifications that the same\n> download is starting.  I don't like the fragility of putting the notification in\n> ResourceDispatcherHost::BeginDownload, but it has the advantage of covering all\n> the (current :-{) pathways through which a download can be initiated while still\n> giving you the notification you're looking for when the initiation doesn't\n> actually go through to creating a DownloadResourceHandler.\n\nI was considering download_util::DownloadUrl as an alternative to RDH::BeginDownload as it may be a little more future-proof. What do you think?","draft":false,"lineno":68,"date":"2011-02-14 16:07:12.258951","left":false},{"author":"rdsmith","author_email":"rdsmith@chromium.org","text":"On 2011/02/14 16:07:12, dominic wrote:\n> On 2011/02/13 03:08:36, rdsmith wrote:\n> > I'd rather not notify from the DownloadResourceHandler constructor, as that'll\n> > mean in the case where a download comes off of the usual path (i.e. through\n> the\n> > DownloadThrottlingResourceHandler) you'll get two notifications that the same\n> > download is starting.  I don't like the fragility of putting the notification\n> in\n> > ResourceDispatcherHost::BeginDownload, but it has the advantage of covering\n> all\n> > the (current :-{) pathways through which a download can be initiated while\n> still\n> > giving you the notification you're looking for when the initiation doesn't\n> > actually go through to creating a DownloadResourceHandler.\n> \n> I was considering download_util::DownloadUrl as an alternative to\n> RDH::BeginDownload as it may be a little more future-proof. What do you think?\n\nNeither one's particularly future-proof, I'm afraid :-{.  I have (vague) plans to get rid of download_util based on a recent rant of Brett's on chromium-dev, and no current plans to get rid of RDH::BeginDownload, but I don't consider either of them part of a particularly clean architecture.  It's sort of like the breakfast cereal adds: \"Standing next to ^W ^W Part of this complete architecture\" :-} :-J.\n\nHaving said that, I'd vote in favor of RDH just because there's a path that initiales a download that doesn't get notified if we use download_util: ResourceMessageFilter::OnDownloadUrl -> ResourceDispatcherHost::BeginDownload-> DownloadResourceHandler().  That happens when the renderer processes sends us a message requesting a download; I'm still not sure under what circumstances that happens, but if the path's in the code, I'd like to catch it.\n","draft":false,"lineno":68,"date":"2011-02-14 19:20:51.509316","left":false}],"id":23004,"is_binary":false},"chrome/test/data/prerender/prerender_download_location.html":{"status":"A    ","num_chunks":1,"no_base_file":false,"property_changes":"\nAdded: svn:eol-style\n   + LF\n","num_added":11,"num_removed":0,"messages":[],"id":23008,"is_binary":false},"chrome/browser/renderer_host/download_throttling_resource_handler.cc":{"status":"M    ","num_chunks":2,"no_base_file":false,"property_changes":"","num_added":21,"num_removed":1,"messages":[{"author":"rdsmith","author_email":"rdsmith@chromium.org","text":"Is dislike duplicating this code; is there anywhere more appropriate to put it?  I'll admit I'm not coming up with anything :-{.  Maybe make it specific to DOWNLOAD_INITIATED and make it a static function on DownloadResourceHandler?\n\n(I'd also accept leaving it here--I'm not coming up with great options on this one.)\n","draft":false,"lineno":28,"date":"2011-02-13 03:08:36.276737","left":false},{"author":"dominich","author_email":"dominich@chromium.org","text":"On 2011/02/13 03:08:36, rdsmith wrote:\n> Is dislike duplicating this code; is there anywhere more appropriate to put it? \n> I'll admit I'm not coming up with anything :-{.  Maybe make it specific to\n> DOWNLOAD_INITIATED and make it a static function on DownloadResourceHandler?\n> \n> (I'd also accept leaving it here--I'm not coming up with great options on this\n> one.)\n\nI do want to keep it generic as I can see this being extended to include download cancelation notifications in the future, but I agree it isn't great. Maybe download_util makes sense for this too.\n","draft":false,"lineno":28,"date":"2011-02-14 16:07:12.259107","left":false}],"id":23005,"is_binary":false}},"owner_email":"dominich@chromium.org","owner":"dominich","message":"Moved notification to ctor and added notification for manual downloads","try_job_results":[{"parent_name":null,"tests":[],"slave":null,"url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=linux&number=12301","timestamp":"2011-02-14 19:20:51.534072","builder":"linux","clobber":null,"project":null,"reason":null,"result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIyCxIFSXNzdWUY_ZyKAwwLEghQYXRjaFNldBjxqwEMCxIMVHJ5Sm9iUmVzdWx0GKvvAgw","requester":null,"buildnumber":null,"revision":null},{"parent_name":null,"tests":[],"slave":null,"url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=mac&number=12750","timestamp":"2011-02-14 19:20:51.534072","builder":"mac","clobber":null,"project":null,"reason":null,"result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIyCxIFSXNzdWUY_ZyKAwwLEghQYXRjaFNldBjxqwEMCxIMVHJ5Sm9iUmVzdWx0GKzvAgw","requester":null,"buildnumber":null,"revision":null},{"parent_name":null,"tests":[],"slave":null,"url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=win&number=15521","timestamp":"2011-02-14 19:20:51.534072","builder":"win","clobber":null,"project":null,"reason":null,"result":"2","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIyCxIFSXNzdWUY_ZyKAwwLEghQYXRjaFNldBjxqwEMCxIMVHJ5Sm9iUmVzdWx0GK3vAgw","requester":null,"buildnumber":null,"revision":null}],"created":"2011-02-11 22:22:46.657468","url":null,"num_comments":5,"modified":"2012-01-13 14:36:19.051579","patchset":22001,"issue":6459005}
{"description":"Make specch input extension api a PKS.\n\nBUG=159265\nTEST=SpeechInputExtensionApiTest.*\n\nCommitted: https://src.chromium.org/viewvc/chrome?view=rev&revision=177105","cc":["chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"reviewers":["yoz@chromium.org","mirandac@chromium.org","tommi@chromium.org"],"messages":[{"sender":"ncj674@motorola.com","recipients":["ncj674@motorola.com","yoz@chromium.org","mirandac@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"Please review.","disapproval":false,"date":"2013-01-04 19:37:29.639740","approval":false},{"sender":"mirandac@chromium.org","recipients":["ncj674@motorola.com","yoz@chromium.org","mirandac@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"On 2013/01/04 19:37:29, SanjoyPal wrote:\n> Please review.\n\nprofiles/* LGTM.","disapproval":false,"date":"2013-01-04 19:42:39.497180","approval":true},{"sender":"yoz@chromium.org","recipients":["ncj674@motorola.com","yoz@chromium.org","mirandac@chromium.org","tommi@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"+tommi for speech\n\nThere is already a SpeechInputExtensionManager::Factory. Can you use that instead? At least, I think you should be able to change it to use ProfileKeyedAPIFactory, in any case.\n\nIt's already using ServiceIsCreatedWithProfile = true, but because it's not declared in ProfileDependencyManager, I don't think that it actually behaves that way.","disapproval":false,"date":"2013-01-04 20:13:24.961190","approval":false},{"sender":"ncj674@motorola.com","recipients":["ncj674@motorola.com","yoz@chromium.org","mirandac@chromium.org","tommi@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"Make specch input extension api a PKS.\n\nBUG=159265\nTEST=SpeechInputExtensionApiTest.*","disapproval":false,"date":"2013-01-10 18:57:28.489940","approval":false},{"sender":"ncj674@motorola.com","recipients":["ncj674@motorola.com","yoz@chromium.org","mirandac@chromium.org","tommi@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"Moved speech input function registration to SpeechInputExtensionManager. PTAL. Thanks","disapproval":false,"date":"2013-01-10 19:29:11.584040","approval":false},{"sender":"tommi@chromium.org","recipients":["ncj674@motorola.com","yoz@chromium.org","mirandac@chromium.org","tommi@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"lgtm","disapproval":false,"date":"2013-01-14 11:59:38.911280","approval":true},{"sender":"ncj674@motorola.com","recipients":["ncj674@motorola.com","yoz@chromium.org","mirandac@chromium.org","tommi@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"Converted SpeechInputExtensionManager::Factory to ProfileKeyedAPIFactory. Please review again.\nThanks.\n\nOn 2013/01/04 20:13:24, Yoyo Zhou wrote:\n> +tommi for speech\n> \n> There is already a SpeechInputExtensionManager::Factory. Can you use that\n> instead? At least, I think you should be able to change it to use\n> ProfileKeyedAPIFactory, in any case.\n> \n> It's already using ServiceIsCreatedWithProfile = true, but because it's not\n> declared in ProfileDependencyManager, I don't think that it actually behaves\n> that way.","disapproval":false,"date":"2013-01-15 02:20:40.148830","approval":false},{"sender":"tommi@chromium.org","recipients":["ncj674@motorola.com","yoz@chromium.org","mirandac@chromium.org","tommi@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"lgtm with a couple of requests.\n\nhttps://codereview.chromium.org/11779002/diff/13001/chrome/browser/speech/speech_input_extension_manager.cc\nFile chrome/browser/speech/speech_input_extension_manager.cc (right):\n\nhttps://codereview.chromium.org/11779002/diff/13001/chrome/browser/speech/speech_input_extension_manager.cc#newcode695\nchrome/browser/speech/speech_input_extension_manager.cc:695: manager_ = new SpeechInputExtensionManager(profile);\ninitializer list?\n\nhttps://codereview.chromium.org/11779002/diff/13001/chrome/browser/speech/speech_input_extension_manager.cc#newcode716\nchrome/browser/speech/speech_input_extension_manager.cc:716: SpeechInputAPI::GetFactoryInstance() {\nI don't think you need to wrap here","disapproval":false,"date":"2013-01-15 16:59:41.939690","approval":true},{"sender":"ncj674@motorola.com","recipients":["ncj674@motorola.com","yoz@chromium.org","mirandac@chromium.org","tommi@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"Updated the patch. Please review.\n\nOn 2013/01/15 16:59:41, tommi wrote:\n> lgtm with a couple of requests.\n> \n> https://codereview.chromium.org/11779002/diff/13001/chrome/browser/speech/speech_input_extension_manager.cc\n> File chrome/browser/speech/speech_input_extension_manager.cc (right):\n> \n> https://codereview.chromium.org/11779002/diff/13001/chrome/browser/speech/speech_input_extension_manager.cc#newcode695\n> chrome/browser/speech/speech_input_extension_manager.cc:695: manager_ = new\n> SpeechInputExtensionManager(profile);\n> initializer list?\n> \n> https://codereview.chromium.org/11779002/diff/13001/chrome/browser/speech/speech_input_extension_manager.cc#newcode716\n> chrome/browser/speech/speech_input_extension_manager.cc:716:\n> SpeechInputAPI::GetFactoryInstance() {\n> I don't think you need to wrap here","disapproval":false,"date":"2013-01-16 01:15:07.002050","approval":false},{"sender":"ncj674@motorola.com","recipients":["ncj674@motorola.com","yoz@chromium.org","mirandac@chromium.org","tommi@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"Updated the patch. Please review.\n\nhttps://codereview.chromium.org/11779002/diff/13001/chrome/browser/speech/speech_input_extension_manager.cc\nFile chrome/browser/speech/speech_input_extension_manager.cc (right):\n\nhttps://codereview.chromium.org/11779002/diff/13001/chrome/browser/speech/speech_input_extension_manager.cc#newcode695\nchrome/browser/speech/speech_input_extension_manager.cc:695: manager_ = new SpeechInputExtensionManager(profile);\nOn 2013/01/15 16:59:42, tommi wrote:\n> initializer list?\n\nDone.\n\nhttps://codereview.chromium.org/11779002/diff/13001/chrome/browser/speech/speech_input_extension_manager.cc#newcode716\nchrome/browser/speech/speech_input_extension_manager.cc:716: SpeechInputAPI::GetFactoryInstance() {\nDo you mean, I need to implement ProfileKeyedAPI stuff inside SpeechInputExtensionManager, instead of wrapping it with SpeechInputAPI? But, it leads to same error as before \"ref_counted.cc(67)] Check failed: in_dtor_. RefCountedThreadSafe object deleted without calling Release()\"\n\nOn 2013/01/15 16:59:42, tommi wrote:\n> I don't think you need to wrap here","disapproval":false,"date":"2013-01-16 01:15:41.618890","approval":false},{"sender":"yoz@chromium.org","recipients":["ncj674@motorola.com","yoz@chromium.org","mirandac@chromium.org","tommi@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"https://codereview.chromium.org/11779002/diff/13001/chrome/browser/speech/speech_input_extension_manager.cc\nFile chrome/browser/speech/speech_input_extension_manager.cc (right):\n\nhttps://codereview.chromium.org/11779002/diff/13001/chrome/browser/speech/speech_input_extension_manager.cc#newcode716\nchrome/browser/speech/speech_input_extension_manager.cc:716: SpeechInputAPI::GetFactoryInstance() {\nOn 2013/01/16 01:15:41, SanjoyPal wrote:\n> Do you mean, I need to implement ProfileKeyedAPI stuff inside\n> SpeechInputExtensionManager, instead of wrapping it with SpeechInputAPI? But, it\n> leads to same error as before \"ref_counted.cc(67)] Check failed: in_dtor_.\n> RefCountedThreadSafe object deleted without calling Release()\"\n> \n> On 2013/01/15 16:59:42, tommi wrote:\n> > I don't think you need to wrap here\n> \n\nI think he's referring to line wrapping.\n\nhttps://codereview.chromium.org/11779002/diff/13001/chrome/browser/speech/speech_input_extension_manager.h\nFile chrome/browser/speech/speech_input_extension_manager.h (right):\n\nhttps://codereview.chromium.org/11779002/diff/13001/chrome/browser/speech/speech_input_extension_manager.h#newcode235\nchrome/browser/speech/speech_input_extension_manager.h:235: static const bool kServiceRedirectedInIncognito = false;\nfalse is the default.\n\nhttps://codereview.chromium.org/11779002/diff/13001/chrome/browser/speech/speech_input_extension_manager.h#newcode238\nchrome/browser/speech/speech_input_extension_manager.h:238: virtual void Shutdown() OVERRIDE {\nI would prefer if this was not inlined in the header file.\n\nhttps://codereview.chromium.org/11779002/diff/19001/chrome/browser/speech/speech_input_extension_manager.cc\nFile chrome/browser/speech/speech_input_extension_manager.cc (right):\n\nhttps://codereview.chromium.org/11779002/diff/19001/chrome/browser/speech/speech_input_extension_manager.cc#newcode89\nchrome/browser/speech/speech_input_extension_manager.cc:89: extensions::SpeechInputAPI* speech_input =\nCall this speech_input_api","disapproval":false,"date":"2013-01-16 01:37:19.614820","approval":false},{"sender":"ncj674@motorola.com","recipients":["ncj674@motorola.com","yoz@chromium.org","mirandac@chromium.org","tommi@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"Done. Please review.\n\nhttps://codereview.chromium.org/11779002/diff/13001/chrome/browser/speech/speech_input_extension_manager.cc\nFile chrome/browser/speech/speech_input_extension_manager.cc (right):\n\nhttps://codereview.chromium.org/11779002/diff/13001/chrome/browser/speech/speech_input_extension_manager.cc#newcode716\nchrome/browser/speech/speech_input_extension_manager.cc:716: SpeechInputAPI::GetFactoryInstance() {\nOn 2013/01/16 01:37:19, Yoyo Zhou wrote:\n> On 2013/01/16 01:15:41, SanjoyPal wrote:\n> > Do you mean, I need to implement ProfileKeyedAPI stuff inside\n> > SpeechInputExtensionManager, instead of wrapping it with SpeechInputAPI? But,\n> it\n> > leads to same error as before \"ref_counted.cc(67)] Check failed: in_dtor_.\n> > RefCountedThreadSafe object deleted without calling Release()\"\n> > \n> > On 2013/01/15 16:59:42, tommi wrote:\n> > > I don't think you need to wrap here\n> > \n> \n> I think he's referring to line wrapping.\n\nDone.\n\nhttps://codereview.chromium.org/11779002/diff/13001/chrome/browser/speech/speech_input_extension_manager.h\nFile chrome/browser/speech/speech_input_extension_manager.h (right):\n\nhttps://codereview.chromium.org/11779002/diff/13001/chrome/browser/speech/speech_input_extension_manager.h#newcode235\nchrome/browser/speech/speech_input_extension_manager.h:235: static const bool kServiceRedirectedInIncognito = false;\nOn 2013/01/16 01:37:19, Yoyo Zhou wrote:\n> false is the default.\n\nDone.\n\nhttps://codereview.chromium.org/11779002/diff/13001/chrome/browser/speech/speech_input_extension_manager.h#newcode238\nchrome/browser/speech/speech_input_extension_manager.h:238: virtual void Shutdown() OVERRIDE {\nOn 2013/01/16 01:37:19, Yoyo Zhou wrote:\n> I would prefer if this was not inlined in the header file.\n\nDone.\n\nhttps://codereview.chromium.org/11779002/diff/19001/chrome/browser/speech/speech_input_extension_manager.cc\nFile chrome/browser/speech/speech_input_extension_manager.cc (right):\n\nhttps://codereview.chromium.org/11779002/diff/19001/chrome/browser/speech/speech_input_extension_manager.cc#newcode89\nchrome/browser/speech/speech_input_extension_manager.cc:89: extensions::SpeechInputAPI* speech_input =\nOn 2013/01/16 01:37:19, Yoyo Zhou wrote:\n> Call this speech_input_api\n\nDone.","disapproval":false,"date":"2013-01-16 01:52:23.744730","approval":false},{"sender":"yoz@chromium.org","recipients":["ncj674@motorola.com","yoz@chromium.org","mirandac@chromium.org","tommi@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"https://codereview.chromium.org/11779002/diff/13001/chrome/browser/speech/speech_input_extension_manager.cc\nFile chrome/browser/speech/speech_input_extension_manager.cc (right):\n\nhttps://codereview.chromium.org/11779002/diff/13001/chrome/browser/speech/speech_input_extension_manager.cc#newcode716\nchrome/browser/speech/speech_input_extension_manager.cc:716: SpeechInputAPI::GetFactoryInstance() {\nOn 2013/01/16 01:52:23, SanjoyPal wrote:\n> On 2013/01/16 01:37:19, Yoyo Zhou wrote:\n> > On 2013/01/16 01:15:41, SanjoyPal wrote:\n> > > Do you mean, I need to implement ProfileKeyedAPI stuff inside\n> > > SpeechInputExtensionManager, instead of wrapping it with SpeechInputAPI?\n> But,\n> > it\n> > > leads to same error as before \"ref_counted.cc(67)] Check failed: in_dtor_.\n> > > RefCountedThreadSafe object deleted without calling Release()\"\n> > > \n> > > On 2013/01/15 16:59:42, tommi wrote:\n> > > > I don't think you need to wrap here\n> > > \n> > \n> > I think he's referring to line wrapping.\n> \n> Done.\n\nIt's still wrapped.\n\nhttps://codereview.chromium.org/11779002/diff/24001/chrome/browser/speech/speech_input_extension_manager.cc\nFile chrome/browser/speech/speech_input_extension_manager.cc (right):\n\nhttps://codereview.chromium.org/11779002/diff/24001/chrome/browser/speech/speech_input_extension_manager.cc#newcode91\nchrome/browser/speech/speech_input_extension_manager.cc:91: extensions::SpeechInputAPI>::GetForProfile(profile);\nLine breaking is awkward: break after the last ::","disapproval":false,"date":"2013-01-16 02:07:46.011610","approval":false},{"sender":"ncj674@motorola.com","recipients":["ncj674@motorola.com","yoz@chromium.org","mirandac@chromium.org","tommi@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"Updated.\n\nhttps://codereview.chromium.org/11779002/diff/13001/chrome/browser/speech/speech_input_extension_manager.cc\nFile chrome/browser/speech/speech_input_extension_manager.cc (right):\n\nhttps://codereview.chromium.org/11779002/diff/13001/chrome/browser/speech/speech_input_extension_manager.cc#newcode716\nchrome/browser/speech/speech_input_extension_manager.cc:716: SpeechInputAPI::GetFactoryInstance() {\nOn 2013/01/16 02:07:46, Yoyo Zhou wrote:\n> On 2013/01/16 01:52:23, SanjoyPal wrote:\n> > On 2013/01/16 01:37:19, Yoyo Zhou wrote:\n> > > On 2013/01/16 01:15:41, SanjoyPal wrote:\n> > > > Do you mean, I need to implement ProfileKeyedAPI stuff inside\n> > > > SpeechInputExtensionManager, instead of wrapping it with SpeechInputAPI?\n> > But,\n> > > it\n> > > > leads to same error as before \"ref_counted.cc(67)] Check failed: in_dtor_.\n> > > > RefCountedThreadSafe object deleted without calling Release()\"\n> > > > \n> > > > On 2013/01/15 16:59:42, tommi wrote:\n> > > > > I don't think you need to wrap here\n> > > > \n> > > \n> > > I think he's referring to line wrapping.\n> > \n> > Done.\n> \n> It's still wrapped.\n\nDone.\n\nhttps://codereview.chromium.org/11779002/diff/24001/chrome/browser/speech/speech_input_extension_manager.cc\nFile chrome/browser/speech/speech_input_extension_manager.cc (right):\n\nhttps://codereview.chromium.org/11779002/diff/24001/chrome/browser/speech/speech_input_extension_manager.cc#newcode91\nchrome/browser/speech/speech_input_extension_manager.cc:91: extensions::SpeechInputAPI>::GetForProfile(profile);\nOn 2013/01/16 02:07:46, Yoyo Zhou wrote:\n> Line breaking is awkward: break after the last ::\n\nDone.","disapproval":false,"date":"2013-01-16 02:19:22.447010","approval":false},{"sender":"yoz@chromium.org","recipients":["ncj674@motorola.com","yoz@chromium.org","mirandac@chromium.org","tommi@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"LGTM","disapproval":false,"date":"2013-01-16 02:21:19.616470","approval":true},{"sender":"commit-bot@chromium.org","recipients":["ncj674@motorola.com","yoz@chromium.org","mirandac@chromium.org","tommi@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/ncj674@motorola.com/11779002/24002","disapproval":false,"date":"2013-01-16 02:29:38.596390","approval":false},{"sender":"commit-bot@chromium.org","recipients":["ncj674@motorola.com","yoz@chromium.org","mirandac@chromium.org","tommi@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"Retried try job too often on win for step(s) compile","disapproval":false,"date":"2013-01-16 04:09:20.232290","approval":false},{"sender":"commit-bot@chromium.org","recipients":["ncj674@motorola.com","yoz@chromium.org","mirandac@chromium.org","tommi@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/ncj674@motorola.com/11779002/24002","disapproval":false,"date":"2013-01-16 06:23:00.070620","approval":false},{"sender":"commit-bot@chromium.org","recipients":["ncj674@motorola.com","yoz@chromium.org","mirandac@chromium.org","tommi@chromium.org","chromium-reviews@chromium.org","aa@chromium.org","chromium-apps-reviews@chromium.org"],"text":"Change committed as 177105","disapproval":false,"date":"2013-01-16 08:52:08.699680","approval":false}],"owner_email":"ncj674@motorola.com","private":false,"base_url":"http://src.chromium.org/svn/trunk/src/","owner":"SanjoyPal","subject":"Make specch input extension api a PKS.","created":"2013-01-04 19:34:27.580450","patchsets":[1,6001,13001,19001,24001,24002],"modified":"2013-01-16 08:52:08.782590","closed":true,"commit":false,"issue":11779002}
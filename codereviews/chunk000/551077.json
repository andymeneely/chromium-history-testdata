{"description":"Implement NetworkChangeNotifierWin.\r\nUses the NotifyAddrChange() API to detect ip address changes.\r\nBUG=http://crbug.com/26156\n\nCommitted: http://src.chromium.org/viewvc/chrome?view=rev&revision=36837","cc":["chromium-reviews@googlegroups.com"],"reviewers":["eroman@chromium.org","rvargas@chromium.org","evan@chromium.org"],"messages":[{"sender":"willchan@chromium.org","recipients":["willchan@chromium.org","eroman@chromium.org","chromium-reviews@googlegroups.com"],"text":"","disapproval":false,"date":"2010-01-20 01:32:08.637918","approval":false},{"sender":"eroman@chromium.org","recipients":["willchan@chromium.org","eroman@chromium.org","rvargas@chromium.org","chromium-reviews@googlegroups.com"],"text":"LGTM.\n\nRicardo, can you give this a look-over? Your windows-fu is strong!\n\nhttp://codereview.chromium.org/551077/diff/2001/3001\nFile net/base/network_change_notifier_win.cc (right):\n\nhttp://codereview.chromium.org/551077/diff/2001/3001#newcode50\nnet/base/network_change_notifier_win.cc:50: LOG(DFATAL) << \"NotifyAddrChange() error: \" << ret;\nCan it legitimately fail with ERRROR_NOT_SUPPORTED or ERROR_CANCELLED ?\n\nI suggest making this a CHECK() instead.","disapproval":false,"date":"2010-01-21 00:58:17.108240","approval":true},{"sender":"rvargas@chromium.org","recipients":["willchan@chromium.org","eroman@chromium.org","rvargas@chromium.org","chromium-reviews@googlegroups.com"],"text":"lgtm\n\nhttp://codereview.chromium.org/551077/diff/2001/3001\nFile net/base/network_change_notifier_win.cc (right):\n\nhttp://codereview.chromium.org/551077/diff/2001/3001#newcode38\nnet/base/network_change_notifier_win.cc:38: addr_overlapped_.hEvent = WSACreateEvent();\nPlease init the rest of the structure to 0.\n\nhttp://codereview.chromium.org/551077/diff/2001/3001#newcode42\nnet/base/network_change_notifier_win.cc:42: addr_watcher_.StopWatching();\nBefore stopping the watcher you have to call CancelIPChangeNotify (actually, before closing the handle)\n\nhttp://codereview.chromium.org/551077/diff/2001/3002\nFile net/base/network_change_notifier_win.h (right):\n\nhttp://codereview.chromium.org/551077/diff/2001/3002#newcode18\nnet/base/network_change_notifier_win.h:18: void OnIPAddressChanged() { helper_.OnIPAddressChanged(); }\nCould you add a note about this method being only intended to be used by Impl.","disapproval":false,"date":"2010-01-21 02:05:15.080183","approval":true},{"sender":"willchan@chromium.org","recipients":["willchan@chromium.org","eroman@chromium.org","rvargas@chromium.org","chromium-reviews@googlegroups.com"],"text":"http://codereview.chromium.org/551077/diff/2001/3001\nFile net/base/network_change_notifier_win.cc (right):\n\nhttp://codereview.chromium.org/551077/diff/2001/3001#newcode38\nnet/base/network_change_notifier_win.cc:38: addr_overlapped_.hEvent = WSACreateEvent();\nOn 2010/01/21 02:05:15, rvargas wrote:\n> Please init the rest of the structure to 0.\n\nDone.\n\nhttp://codereview.chromium.org/551077/diff/2001/3001#newcode42\nnet/base/network_change_notifier_win.cc:42: addr_watcher_.StopWatching();\nOn 2010/01/21 02:05:15, rvargas wrote:\n> Before stopping the watcher you have to call CancelIPChangeNotify (actually,\n> before closing the handle)\n\nDone.\n\nhttp://codereview.chromium.org/551077/diff/2001/3001#newcode50\nnet/base/network_change_notifier_win.cc:50: LOG(DFATAL) << \"NotifyAddrChange() error: \" << ret;\nOn 2010/01/21 00:58:17, eroman wrote:\n> Can it legitimately fail with ERRROR_NOT_SUPPORTED or ERROR_CANCELLED ?\n> \n> I suggest making this a CHECK() instead.\n\nDone.\n\nhttp://codereview.chromium.org/551077/diff/2001/3002\nFile net/base/network_change_notifier_win.h (right):\n\nhttp://codereview.chromium.org/551077/diff/2001/3002#newcode18\nnet/base/network_change_notifier_win.h:18: void OnIPAddressChanged() { helper_.OnIPAddressChanged(); }\nOn 2010/01/21 02:05:15, rvargas wrote:\n> Could you add a note about this method being only intended to be used by Impl.\n\nDone.","disapproval":false,"date":"2010-01-22 00:36:12.104626","approval":false},{"sender":"eroman@chromium.org","recipients":["willchan@chromium.org","eroman@chromium.org","rvargas@chromium.org","chromium-reviews@googlegroups.com"],"text":"LGTM","disapproval":false,"date":"2010-01-22 00:38:12.183014","approval":true},{"sender":"rvargas@chromium.org","recipients":["willchan@chromium.org","eroman@chromium.org","rvargas@chromium.org","chromium-reviews@googlegroups.com"],"text":"lgtm","disapproval":false,"date":"2010-01-22 00:54:19.914245","approval":true},{"sender":"evan@chromium.org","recipients":["willchan@chromium.org","eroman@chromium.org","rvargas@chromium.org","evan@chromium.org","chromium-reviews@googlegroups.com"],"text":"http://codereview.chromium.org/551077/diff/7001/7002\nFile net/base/network_change_notifier_win.cc (right):\n\nhttp://codereview.chromium.org/551077/diff/7001/7002#newcode5\nnet/base/network_change_notifier_win.cc:5: #include \"net/base/network_change_notifier_win.h\"\nnewline here\n\nhttp://codereview.chromium.org/551077/diff/7001/7002#newcode8\nnet/base/network_change_notifier_win.cc:8: #include <winsock2.h>\nnewline here\n\nhttp://codereview.chromium.org/551077/diff/7001/7003\nFile net/base/network_change_notifier_win.h (right):\n\nhttp://codereview.chromium.org/551077/diff/7001/7003#newcode9\nnet/base/network_change_notifier_win.h:9: #include \"base/object_watcher.h\"\nthis include looks unnecessary","disapproval":false,"date":"2010-01-22 02:50:35.915472","approval":false}],"owner_email":"willchan@chromium.org","private":false,"base_url":"","owner":"willchan","subject":"Implement NetworkChangeNotifierWin.","created":"2010-01-20 01:26:58.454661","patchsets":[1,2001,7001],"modified":"2011-05-20 02:39:17.963428","closed":true,"commit":false,"issue":551077}
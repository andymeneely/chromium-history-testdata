{"description":"Attempting to fix perf regression on Linux of nacl_helper-data/data.\n\nRevert 195188 - Add interface to set the sub resource crash key from Flash\n\nBUG=N/A\nTEST=N/A\n\nReview URL: https://chromiumcodereview.appspot.com/14311004\n\nTBR=cdn@chromium.org\nCommitted: https://src.chromium.org/viewvc/chrome?view=rev&revision=195344","cc":["chromium-reviews@chromium.org","piman+watch@chromium.org","raymes+watch@chromium.org","yusukes+watch@chromium.org","yzshen+watch@chromium.org","ihf+watch@chromium.org"],"reviewers":["cdn@chromium.org","raymes@google.com"],"messages":[{"sender":"rlp@chromium.org","recipients":["rlp@chromium.org","cdn@chromium.org","chromium-reviews@chromium.org","piman+watch@chromium.org","raymes+watch@chromium.org","yusukes+watch@chromium.org","yzshen+watch@chromium.org","ihf+watch@chromium.org"],"text":"","disapproval":false,"date":"2013-04-20 00:01:46.264800","approval":false},{"sender":"raymes@google.com","recipients":["reply@chromiumcodereview-hr.appspotmail.com"],"text":"Did this have any impact? This change should have been fairly innocuous.\r\n\r\nOn Fri, Apr 19, 2013 at 5:01 PM,  <rlp@chromium.org> wrote:\r\n> Reviewers: Cris Neckar,\r\n>\r\n> Description:\r\n> Attempting to fix perf regression on Linux of nacl_helper-data/data.\r\n>\r\n> Revert 195188 - Add interface to set the sub resource crash key from Flash\r\n>\r\n> BUG=N/A\r\n> TEST=N/A\r\n>\r\n> Review URL: https://chromiumcodereview.appspot.com/14311004\r\n>\r\n> TBR=cdn@chromium.org\r\n>\r\n> Please review this at https://codereview.chromium.org/13875006/\r\n>\r\n> SVN Base: svn://svn.chromium.org/chrome/trunk/src/\r\n>\r\n> Affected files:\r\n>   M     ppapi/api/private/ppb_flash.idl\r\n>   M     ppapi/c/private/ppb_flash.h\r\n>   M     ppapi/proxy/flash_resource.cc\r\n>\r\n>\r\n> Index: ppapi/api/private/ppb_flash.idl\r\n> ===================================================================\r\n> --- ppapi/api/private/ppb_flash.idl     (revision 195342)\r\n> +++ ppapi/api/private/ppb_flash.idl     (working copy)\r\n> @@ -103,12 +103,7 @@\r\n>    /**\r\n>     * Specifies the document URL which contains the flash instance.\r\n>     */\r\n> -  PP_FLASHCRASHKEY_URL = 1,\r\n> -\r\n> -  /**\r\n> -   * Specifies the URL of the current swf.\r\n> -   */\r\n> -  PP_FLASHCRASHKEY_RESOURCE_URL = 2\r\n> +  PP_FLASHCRASHKEY_URL = 1\r\n>  };\r\n>\r\n>  /**\r\n> Index: ppapi/c/private/ppb_flash.h\r\n> ===================================================================\r\n> --- ppapi/c/private/ppb_flash.h (revision 195342)\r\n> +++ ppapi/c/private/ppb_flash.h (working copy)\r\n> @@ -3,7 +3,7 @@\r\n>   * found in the LICENSE file.\r\n>   */\r\n>\r\n> -/* From private/ppb_flash.idl modified Thu Apr 18 15:06:12 2013. */\r\n> +/* From private/ppb_flash.idl modified Thu Mar 28 10:30:53 2013. */\r\n>\r\n>  #ifndef PPAPI_C_PRIVATE_PPB_FLASH_H_\r\n>  #define PPAPI_C_PRIVATE_PPB_FLASH_H_\r\n> @@ -118,11 +118,7 @@\r\n>    /**\r\n>     * Specifies the document URL which contains the flash instance.\r\n>     */\r\n> -  PP_FLASHCRASHKEY_URL = 1,\r\n> -  /**\r\n> -   * Specifies the URL of the current swf.\r\n> -   */\r\n> -  PP_FLASHCRASHKEY_RESOURCE_URL = 2\r\n> +  PP_FLASHCRASHKEY_URL = 1\r\n>  } PP_FlashCrashKey;\r\n>  PP_COMPILE_ASSERT_SIZE_IN_BYTES(PP_FlashCrashKey, 4);\r\n>  /**\r\n> Index: ppapi/proxy/flash_resource.cc\r\n> ===================================================================\r\n> --- ppapi/proxy/flash_resource.cc       (revision 195342)\r\n> +++ ppapi/proxy/flash_resource.cc       (working copy)\r\n> @@ -7,7 +7,6 @@\r\n>  #include <cmath>\r\n>\r\n>  #include \"base/containers/mru_cache.h\"\r\n> -#include \"base/debug/crash_logging.h\"\r\n>  #include \"base/lazy_instance.h\"\r\n>  #include \"base/time.h\"\r\n>  #include \"ppapi/c/pp_errors.h\"\r\n> @@ -84,18 +83,14 @@\r\n>  PP_Bool FlashResource::SetCrashData(PP_Instance instance,\r\n>                                      PP_FlashCrashKey key,\r\n>                                      PP_Var value) {\r\n> -  StringVar* url_string_var(StringVar::FromPPVar(value));\r\n> -  if (!url_string_var)\r\n> -    return PP_FALSE;\r\n>    switch (key) {\r\n>      case PP_FLASHCRASHKEY_URL: {\r\n> +      StringVar* url_string_var(StringVar::FromPPVar(value));\r\n> +      if (!url_string_var)\r\n> +        return PP_FALSE;\r\n>        PluginGlobals::Get()->SetActiveURL(url_string_var->value());\r\n>        return PP_TRUE;\r\n>      }\r\n> -    case PP_FLASHCRASHKEY_RESOURCE_URL: {\r\n> -      base::debug::SetCrashKeyValue(\"subresource_url\",\r\n> url_string_var->value());\r\n> -      return PP_TRUE;\r\n> -    }\r\n>    }\r\n>    return PP_FALSE;\r\n>  }\r\n>\r\n>\r\n","disapproval":false,"date":"2013-04-20 20:57:29.927630","approval":false},{"sender":"rlp@chromium.org","recipients":["reply@chromiumcodereview-hr.appspotmail.com"],"text":"I think these questions have been resolved at this point, but please let me\r\nknow if there are other qeustions. Apologies for reverting your change\r\nwhile trying to diagnose the problem. Hopefully you've had a chance to\r\nrecommit at this point.\r\n\r\nThanks,\r\n\r\nRachel\r\nOn Apr 20, 2013 1:57 PM, \"Raymes Khoury\" <raymes@google.com> wrote:\r\n\r\n> Did this have any impact? This change should have been fairly innocuous.\r\n>\r\n> On Fri, Apr 19, 2013 at 5:01 PM,  <rlp@chromium.org> wrote:\r\n> > Reviewers: Cris Neckar,\r\n> >\r\n> > Description:\r\n> > Attempting to fix perf regression on Linux of nacl_helper-data/data.\r\n> >\r\n> > Revert 195188 - Add interface to set the sub resource crash key from\r\n> Flash\r\n> >\r\n> > BUG=N/A\r\n> > TEST=N/A\r\n> >\r\n> > Review URL: https://chromiumcodereview.appspot.com/14311004\r\n> >\r\n> > TBR=cdn@chromium.org\r\n> >\r\n> > Please review this at https://codereview.chromium.org/13875006/\r\n> >\r\n> > SVN Base: svn://svn.chromium.org/chrome/trunk/src/\r\n> >\r\n> > Affected files:\r\n> >   M     ppapi/api/private/ppb_flash.idl\r\n> >   M     ppapi/c/private/ppb_flash.h\r\n> >   M     ppapi/proxy/flash_resource.cc\r\n> >\r\n> >\r\n> > Index: ppapi/api/private/ppb_flash.idl\r\n> > ===================================================================\r\n> > --- ppapi/api/private/ppb_flash.idl     (revision 195342)\r\n> > +++ ppapi/api/private/ppb_flash.idl     (working copy)\r\n> > @@ -103,12 +103,7 @@\r\n> >    /**\r\n> >     * Specifies the document URL which contains the flash instance.\r\n> >     */\r\n> > -  PP_FLASHCRASHKEY_URL = 1,\r\n> > -\r\n> > -  /**\r\n> > -   * Specifies the URL of the current swf.\r\n> > -   */\r\n> > -  PP_FLASHCRASHKEY_RESOURCE_URL = 2\r\n> > +  PP_FLASHCRASHKEY_URL = 1\r\n> >  };\r\n> >\r\n> >  /**\r\n> > Index: ppapi/c/private/ppb_flash.h\r\n> > ===================================================================\r\n> > --- ppapi/c/private/ppb_flash.h (revision 195342)\r\n> > +++ ppapi/c/private/ppb_flash.h (working copy)\r\n> > @@ -3,7 +3,7 @@\r\n> >   * found in the LICENSE file.\r\n> >   */\r\n> >\r\n> > -/* From private/ppb_flash.idl modified Thu Apr 18 15:06:12 2013. */\r\n> > +/* From private/ppb_flash.idl modified Thu Mar 28 10:30:53 2013. */\r\n> >\r\n> >  #ifndef PPAPI_C_PRIVATE_PPB_FLASH_H_\r\n> >  #define PPAPI_C_PRIVATE_PPB_FLASH_H_\r\n> > @@ -118,11 +118,7 @@\r\n> >    /**\r\n> >     * Specifies the document URL which contains the flash instance.\r\n> >     */\r\n> > -  PP_FLASHCRASHKEY_URL = 1,\r\n> > -  /**\r\n> > -   * Specifies the URL of the current swf.\r\n> > -   */\r\n> > -  PP_FLASHCRASHKEY_RESOURCE_URL = 2\r\n> > +  PP_FLASHCRASHKEY_URL = 1\r\n> >  } PP_FlashCrashKey;\r\n> >  PP_COMPILE_ASSERT_SIZE_IN_BYTES(PP_FlashCrashKey, 4);\r\n> >  /**\r\n> > Index: ppapi/proxy/flash_resource.cc\r\n> > ===================================================================\r\n> > --- ppapi/proxy/flash_resource.cc       (revision 195342)\r\n> > +++ ppapi/proxy/flash_resource.cc       (working copy)\r\n> > @@ -7,7 +7,6 @@\r\n> >  #include <cmath>\r\n> >\r\n> >  #include \"base/containers/mru_cache.h\"\r\n> > -#include \"base/debug/crash_logging.h\"\r\n> >  #include \"base/lazy_instance.h\"\r\n> >  #include \"base/time.h\"\r\n> >  #include \"ppapi/c/pp_errors.h\"\r\n> > @@ -84,18 +83,14 @@\r\n> >  PP_Bool FlashResource::SetCrashData(PP_Instance instance,\r\n> >                                      PP_FlashCrashKey key,\r\n> >                                      PP_Var value) {\r\n> > -  StringVar* url_string_var(StringVar::FromPPVar(value));\r\n> > -  if (!url_string_var)\r\n> > -    return PP_FALSE;\r\n> >    switch (key) {\r\n> >      case PP_FLASHCRASHKEY_URL: {\r\n> > +      StringVar* url_string_var(StringVar::FromPPVar(value));\r\n> > +      if (!url_string_var)\r\n> > +        return PP_FALSE;\r\n> >        PluginGlobals::Get()->SetActiveURL(url_string_var->value());\r\n> >        return PP_TRUE;\r\n> >      }\r\n> > -    case PP_FLASHCRASHKEY_RESOURCE_URL: {\r\n> > -      base::debug::SetCrashKeyValue(\"subresource_url\",\r\n> > url_string_var->value());\r\n> > -      return PP_TRUE;\r\n> > -    }\r\n> >    }\r\n> >    return PP_FALSE;\r\n> >  }\r\n> >\r\n> >\r\n>\r\n","disapproval":false,"date":"2013-04-22 17:46:38.674570","approval":false}],"owner_email":"rlp@chromium.org","private":false,"base_url":"svn://svn.chromium.org/chrome/trunk/src/","owner":"rpetterson","subject":"Attempting to fix perf regression on Linux of nacl_helper-data/data.","created":"2013-04-20 00:01:42.982990","patchsets":[1],"modified":"2013-04-20 20:57:30.113730","closed":true,"commit":false,"issue":13875006}
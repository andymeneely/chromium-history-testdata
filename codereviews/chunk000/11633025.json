{"description":"Provide image data on the dragging pasteboard.\n\nNote that this was tested against Mail with a sample jpg: http://upload.wikimedia.org/wikipedia/commons/e/ed/Lossy-circle.jpg . For some reason TextEdit doesn't accept image drags.\n\nBUG=55879\nTEST=as in bug\n\nCommitted: https://src.chromium.org/viewvc/chrome?view=rev&revision=174044","cc":["chromium-reviews@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","jam@chromium.org","sail+watch@chromium.org","dcheng@chromium.org"],"reviewers":["thakis@chromium.org"],"messages":[{"sender":"avi@chromium.org","recipients":["avi@chromium.org","thakis@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","jam@chromium.org","sail+watch@chromium.org","dcheng@chromium.org"],"text":"I'm pretty sure this code has never worked correctly. This doesn't break file promises and now correctly delivers image data on the clipboard. Tested on 10.6 and 10.8.\n\nI'd like to move to a more modern file promise, but that doesn't look fun. (I tried briefly to put that into this CL but quickly backed away.)","disapproval":false,"date":"2012-12-19 21:20:35.466040","approval":false},{"sender":"thakis@chromium.org","recipients":["avi@chromium.org","thakis@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","jam@chromium.org","sail+watch@chromium.org","dcheng@chromium.org"],"text":"I patched this in and didn't find any behavior difference (didn't try Mail.app though).\n\nWhat I tried:\n1. Open http://static.tumblr.com/lsuaio0/0pjm520gr/happy-kitten-kittens-5890512-1600-1200.jpg\n2. Drag it to TextEdit. Didn't work.\n3. Drag it to Acorn (image editor). Did work.\n4. Right-click, \"copy image\", paste in TextEdit. Works.\n\nThe behavior was the same for both with and without this patch. Since this is impossible to write tests for, please provide a fairly explicit TEST= section.\n\nhttps://codereview.chromium.org/11633025/diff/1/content/browser/web_contents/web_drag_source_mac.mm\nFile content/browser/web_contents/web_drag_source_mac.mm (left):\n\nhttps://codereview.chromium.org/11633025/diff/1/content/browser/web_contents/web_drag_source_mac.mm#oldcode203\ncontent/browser/web_contents/web_drag_source_mac.mm:203: } else if ([type isEqualToString:NSTIFFPboardType]) {\nIs TIFFPboardType not fairly universal? Should we really drop this?","disapproval":false,"date":"2012-12-19 21:38:31.061410","approval":false},{"sender":"avi@chromium.org","recipients":["avi@chromium.org","thakis@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","jam@chromium.org","sail+watch@chromium.org","dcheng@chromium.org"],"text":"I don't know what flavor TextEdit is looking for and why it's not working. As for repro, that's in the bug: drag an image into a new mail message.\n\nhttps://codereview.chromium.org/11633025/diff/1/content/browser/web_contents/web_drag_source_mac.mm\nFile content/browser/web_contents/web_drag_source_mac.mm (left):\n\nhttps://codereview.chromium.org/11633025/diff/1/content/browser/web_contents/web_drag_source_mac.mm#oldcode203\ncontent/browser/web_contents/web_drag_source_mac.mm:203: } else if ([type isEqualToString:NSTIFFPboardType]) {\nOn 2012/12/19 21:38:31, Nico wrote:\n> Is TIFFPboardType not fairly universal? Should we really drop this?\n\nAbsolutely.\n\nThrowing crap onto the clipboard as TIFF is so Rhapsody. Whatever we _actually_ have, we should provide. Note that the recipient can pull it off as a TIFF since when you put _any_ image onto a pasteboard, the pasteboard manager converts it to any image format the recipient tries to pull.","disapproval":false,"date":"2012-12-19 21:43:14.613850","approval":false},{"sender":"avi@chromium.org","recipients":["avi@chromium.org","thakis@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","jam@chromium.org","sail+watch@chromium.org","dcheng@chromium.org"],"text":"I just grabbed the TextEdit source from http://developer.apple.com/library/mac/#samplecode/TextEdit/Introduction/Intro.html and ran it. Dragging images from us works fine in that version, so I don't know what's up with the one that comes with the system.","disapproval":false,"date":"2012-12-19 22:02:40.695710","approval":false},{"sender":"thakis@chromium.org","recipients":["avi@chromium.org","thakis@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","jam@chromium.org","sail+watch@chromium.org","dcheng@chromium.org"],"text":"On 2012/12/19 22:02:40, Avi wrote:\n> I just grabbed the TextEdit source from\n> http://developer.apple.com/library/mac/#samplecode/TextEdit/Introduction/Intro.html\n> and ran it. Dragging images from us works fine in that version, so I don't know\n> what's up with the one that comes with the system.\n\nPlease list the apps you tried and the urls you tried etc in the TEST= section, as mentioned above.\n\nCode lgtm","disapproval":false,"date":"2012-12-19 22:06:23.407890","approval":true},{"sender":"commit-bot@chromium.org","recipients":["avi@chromium.org","thakis@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","jam@chromium.org","sail+watch@chromium.org","dcheng@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/avi@chromium.org/11633025/1","disapproval":false,"date":"2012-12-19 22:09:27.767520","approval":false},{"sender":"commit-bot@chromium.org","recipients":["avi@chromium.org","thakis@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","jam@chromium.org","sail+watch@chromium.org","dcheng@chromium.org"],"text":"Change committed as 174044","disapproval":false,"date":"2012-12-20 00:12:45.962330","approval":false}],"owner_email":"avi@chromium.org","private":false,"base_url":"svn://svn.chromium.org/chrome/trunk/src","owner":"Avi","subject":"Provide image data on the dragging pasteboard.","created":"2012-12-19 21:04:17.243320","patchsets":[1],"modified":"2012-12-20 00:12:46.101550","closed":true,"commit":false,"issue":11633025}
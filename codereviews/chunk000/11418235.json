{"description":"Add perf tests based on json representation of layer tree\n\nThis extends cc_perftests to run perf tests based on a json dump of a layer tree\nwith minimal code changes and adds a tree representing a tab switch UI with\ntwo stacks of 10 layers each.\n\nBUG=\n\n\nCommitted: https://src.chromium.org/viewvc/chrome?view=rev&revision=170411","cc":["chromium-reviews@chromium.org","cc-bugs@chromium.org","jscholler@google.com"],"reviewers":["danakj@chromium.org","enne@chromium.org"],"messages":[{"sender":"jamesr@chromium.org","recipients":["jamesr@chromium.org","danakj@chromium.org","enne@chromium.org","chromium-reviews@chromium.org","cc-bugs@chromium.org","jscholler@google.com"],"text":"This isn't fully clean yet, but it's darn handy.\n\nI generated the JSON by dumping layerTreeAsText() and then running some very ugly processing code on it.  It's not the prettiest JSON - in particular it could be a lot more fewer newlines and could deal with omitting useless fields - but it's a start.\n\nSince there's file I/O and a good bit of processing in the test setup now we need a way to separate that from the normal timing.  Will think about that next.","disapproval":false,"date":"2012-11-29 08:36:02.720660","approval":false},{"sender":"jamesr@chromium.org","recipients":["jamesr@chromium.org","danakj@chromium.org","enne@chromium.org","chromium-reviews@chromium.org","cc-bugs@chromium.org","jscholler@google.com"],"text":"I think this is good enough for a first cut.  Can you do a review, Dana?\n\nOnce this is in TonyG has offered to help us get this up+running on the perf infrastructure so we can monitor the results of all the optimization work across all platforms, etc","disapproval":false,"date":"2012-11-30 00:12:04.751710","approval":false},{"sender":"danakj@chromium.org","recipients":["jamesr@chromium.org","danakj@chromium.org","enne@chromium.org","chromium-reviews@chromium.org","cc-bugs@chromium.org","jscholler@google.com"],"text":"LGTM with some minor comments\n\nhttps://codereview.chromium.org/11418235/diff/3001/cc/layer_tree_host_perftest.cc\nFile cc/layer_tree_host_perftest.cc (right):\n\nhttps://codereview.chromium.org/11418235/diff/3001/cc/layer_tree_host_perftest.cc#newcode38\ncc/layer_tree_host_perftest.cc:38: impl->setNeedsRedraw();\nProbly won't matter, but this should be the else clause of endTest() so we get a reliable # of frames.\n\nhttps://codereview.chromium.org/11418235/diff/3001/cc/layer_tree_host_perftest.cc#newcode270\ncc/layer_tree_host_perftest.cc:270: } else if (layer_type == \"ContentLayer\") {\naside: we should dump the opaque info for these and parse it. i was just assuming fully opaque for this scenario since it's tab contents. for solid color too, as color affects opacity.\n\nhttps://codereview.chromium.org/11418235/diff/3001/cc/layer_tree_host_perftest.cc#newcode284\ncc/layer_tree_host_perftest.cc:284: } else { // Type \"Layer\" or unknown\"\nmismatched \"\n\nhttps://codereview.chromium.org/11418235/diff/3001/cc/layer_tree_host_perftest.cc#newcode290\ncc/layer_tree_host_perftest.cc:290: for (int i=0; i<16; ++i) {\nno {}\n\nhttps://codereview.chromium.org/11418235/diff/3001/cc/layer_tree_host_perftest.cc#newcode290\ncc/layer_tree_host_perftest.cc:290: for (int i=0; i<16; ++i) {\nspaces around operators\n\nhttps://codereview.chromium.org/11418235/diff/3001/cc/layer_tree_host_perftest.cc#newcode305\ncc/layer_tree_host_perftest.cc:305: ADD_FAILURE();\n<< \"Unable to parse layer.\"\n\nhttps://codereview.chromium.org/11418235/diff/3001/cc/layer_tree_host_perftest.cc#newcode311\ncc/layer_tree_host_perftest.cc:311: gfx::Size viewport = gfx::Size(720, 1038);\naside: maybe this should be in the json too, or be set in TEST_F where we choose the data file.","disapproval":false,"date":"2012-11-30 01:21:00.110830","approval":true},{"sender":"danakj@chromium.org","recipients":["jamesr@chromium.org","danakj@chromium.org","enne@chromium.org","chromium-reviews@chromium.org","cc-bugs@chromium.org","jscholler@google.com"],"text":"LGTM still","disapproval":false,"date":"2012-11-30 01:53:03.445490","approval":true},{"sender":"commit-bot@chromium.org","recipients":["jamesr@chromium.org","danakj@chromium.org","enne@chromium.org","chromium-reviews@chromium.org","cc-bugs@chromium.org","jscholler@google.com"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/jamesr@chromium.org/11418235/11001","disapproval":false,"date":"2012-11-30 02:07:59.607370","approval":false},{"sender":"commit-bot@chromium.org","recipients":["jamesr@chromium.org","danakj@chromium.org","enne@chromium.org","chromium-reviews@chromium.org","cc-bugs@chromium.org","jscholler@google.com"],"text":"Step \"update\" is always a major failure.\nLook at the try server FAQ for more details.","disapproval":false,"date":"2012-11-30 03:34:01.531130","approval":false},{"sender":"commit-bot@chromium.org","recipients":["jamesr@chromium.org","danakj@chromium.org","enne@chromium.org","chromium-reviews@chromium.org","cc-bugs@chromium.org","jscholler@google.com"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/jamesr@chromium.org/11418235/11001","disapproval":false,"date":"2012-11-30 04:43:48.325970","approval":false},{"sender":"commit-bot@chromium.org","recipients":["jamesr@chromium.org","danakj@chromium.org","enne@chromium.org","chromium-reviews@chromium.org","cc-bugs@chromium.org","jscholler@google.com"],"text":"Change committed as 170411","disapproval":false,"date":"2012-11-30 05:51:47.026600","approval":false}],"owner_email":"jamesr@chromium.org","private":false,"base_url":"svn://svn.chromium.org/chrome/trunk/src","owner":"jamesr","subject":"Add perf tests based on json representation of layer tree","created":"2012-11-29 08:31:36.067410","patchsets":[1,3001,3002,3003,11001],"modified":"2012-11-30 05:51:47.139280","closed":true,"commit":false,"issue":11418235}
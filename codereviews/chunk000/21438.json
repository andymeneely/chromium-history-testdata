{"description":"Display the current URL and connect the entry widget to OpenURLFromTab().\r\n\r\nThis currently crashes when trying to load a new URL. (It looks like some housekeeping isn't being done in RenderWidgetHostViewGtk, the underlying widget isn't attached to any GTK window...)","cc":["chromium-reviews@googlegroups.com"],"reviewers":["evan@chromium.org","estade@chromium.org"],"messages":[{"sender":"erg@chromium.org","recipients":["erg@chromium.org","evan@chromium.org","estade@chromium.org","chromium-reviews@googlegroups.com"],"text":"","disapproval":false,"date":"2009-02-17 23:56:40.495979","approval":false},{"sender":"evan@chromium.org","recipients":["erg@chromium.org","evan@chromium.org","estade@chromium.org","chromium-reviews@googlegroups.com"],"text":"http://codereview.chromium.org/21438/diff/1/2\nFile chrome/browser/gtk/browser_toolbar_view_gtk.cc (right):\n\nhttp://codereview.chromium.org/21438/diff/1/2#newcode286\nLine 286: case GDK_ISO_Enter: {\nYou should use:\nhttp://library.gnome.org/devel/gtk/unstable/GtkEntry.html#GtkEntry-activate\n\n\"The default bindings for this signal are all forms of the Enter key.\"\n\nhttp://codereview.chromium.org/21438/diff/1/2#newcode290\nLine 290: PageTransition::TYPED);\nI think you shoudl instead call up through a browser API and have it contact the contents instead of going to the contents directly.  (Consider that conceptually a url in here could cause the browser to switch the kind of TabContents we're using.)\n\nhttp://codereview.chromium.org/21438/diff/1/3\nFile chrome/browser/gtk/browser_toolbar_view_gtk.h (right):\n\nhttp://codereview.chromium.org/21438/diff/1/3#newcode46\nLine 46: void Update(TabContents* contents, bool should_restore_state);\nCan you pick a more specific name?  E.g. UpdateFromTabContents or some such.","disapproval":false,"date":"2009-02-18 00:08:22.789128","approval":false},{"sender":"erg@chromium.org","recipients":["erg@chromium.org","evan@chromium.org","estade@chromium.org","chromium-reviews@googlegroups.com"],"text":"http://codereview.chromium.org/21438/diff/1/2\nFile chrome/browser/gtk/browser_toolbar_view_gtk.cc (right):\n\nhttp://codereview.chromium.org/21438/diff/1/2#newcode286\nLine 286: case GDK_ISO_Enter: {\nOn 2009/02/18 00:08:22, Evan Martin wrote:\n> You should use:\n> http://library.gnome.org/devel/gtk/unstable/GtkEntry.html#GtkEntry-activate\n> \n> \"The default bindings for this signal are all forms of the Enter key.\"\n\nI looked at that signal, but didn't use it because is says that \"Applications should not connect to it\".\n\nhttp://codereview.chromium.org/21438/diff/1/2#newcode290\nLine 290: PageTransition::TYPED);\nOn 2009/02/18 00:08:22, Evan Martin wrote:\n> I think you shoudl instead call up through a browser API and have it contact the\n> contents instead of going to the contents directly.  (Consider that conceptually\n> a url in here could cause the browser to switch the kind of TabContents we're\n> using.)\n\nDone.\n\nhttp://codereview.chromium.org/21438/diff/1/3\nFile chrome/browser/gtk/browser_toolbar_view_gtk.h (right):\n\nhttp://codereview.chromium.org/21438/diff/1/3#newcode46\nLine 46: void Update(TabContents* contents, bool should_restore_state);\nOn 2009/02/18 00:08:22, Evan Martin wrote:\n> Can you pick a more specific name?  E.g. UpdateFromTabContents or some such.\n\nDone. (I picked Update() for parity with the windows equivalent class.)","disapproval":false,"date":"2009-02-18 00:19:43.104467","approval":false},{"sender":"evan@chromium.org","recipients":["erg@chromium.org","evan@chromium.org","estade@chromium.org","chromium-reviews@googlegroups.com"],"text":"On 2009/02/18 00:19:43, Elliot Glaysher wrote:\n> I looked at that signal, but didn't use it because is says that \"Applications\n> should not connect to it\".\n\nWha...?  That is crazy talk.  I have no idea why the manual says that.\nThe Gtk newbie tutorial on text widgets says to use it:\nhttp://library.gnome.org/devel/gtk-tutorial/stable/x941.html\n\nI would ignore that recommendation.\n\n\n> \n> http://codereview.chromium.org/21438/diff/1/2#newcode290\n> Line 290: PageTransition::TYPED);\n> On 2009/02/18 00:08:22, Evan Martin wrote:\n> > I think you shoudl instead call up through a browser API and have it contact\n> the\n> > contents instead of going to the contents directly.  (Consider that\n> conceptually\n> > a url in here could cause the browser to switch the kind of TabContents we're\n> > using.)\n> \n> Done.\n> \n> http://codereview.chromium.org/21438/diff/1/3\n> File chrome/browser/gtk/browser_toolbar_view_gtk.h (right):\n> \n> http://codereview.chromium.org/21438/diff/1/3#newcode46\n> Line 46: void Update(TabContents* contents, bool should_restore_state);\n> On 2009/02/18 00:08:22, Evan Martin wrote:\n> > Can you pick a more specific name?  E.g. UpdateFromTabContents or some such.\n> \n> Done. (I picked Update() for parity with the windows equivalent class.)","disapproval":false,"date":"2009-02-18 00:25:41.921376","approval":false},{"sender":"erg@chromium.org","recipients":["erg@chromium.org","evan@chromium.org","estade@chromium.org","chromium-reviews@googlegroups.com"],"text":"On 2009/02/18 00:25:41, Evan Martin wrote:\n> On 2009/02/18 00:19:43, Elliot Glaysher wrote:\n> > I looked at that signal, but didn't use it because is says that \"Applications\n> > should not connect to it\".\n> \n> Wha...?  That is crazy talk.  I have no idea why the manual says that.\n> The Gtk newbie tutorial on text widgets says to use it:\n> http://library.gnome.org/devel/gtk-tutorial/stable/x941.html\n> \n> I would ignore that recommendation.\n\nDone.","disapproval":false,"date":"2009-02-18 00:33:39.632235","approval":false},{"sender":"evan@chromium.org","recipients":["erg@chromium.org","evan@chromium.org","estade@chromium.org","chromium-reviews@googlegroups.com"],"text":"LGTM, nits below\n\nhttp://codereview.chromium.org/21438/diff/7/8\nFile chrome/browser/gtk/browser_toolbar_view_gtk.cc (right):\n\nhttp://codereview.chromium.org/21438/diff/7/8#newcode7\nLine 7: #include <gdk/gdkkeysyms.h>\nno longer necessary\n\nhttp://codereview.chromium.org/21438/diff/7/8#newcode279\nLine 279: GURL dest(std::string(gtk_entry_get_text(entry)));\nhooray, for once utf-8 everywhere pays off.\n\nhttp://codereview.chromium.org/21438/diff/7/8#newcode281\nLine 281: OpenURL(dest, GURL(), CURRENT_TAB, PageTransition::TYPED);\nI still think this is wrong -- I think it should be some API on browser directly.  Maybe browser_->Go() would do it?  Oh, but we lose the transition type.  Maybe via the navigation controller?  In any case, can be fixed later.\n\nhttp://codereview.chromium.org/21438/diff/7/9\nFile chrome/browser/gtk/browser_toolbar_view_gtk.h (right):\n\nhttp://codereview.chromium.org/21438/diff/7/9#newcode45\nLine 45: // Messagte that we should react to a state change.\ntypo","disapproval":false,"date":"2009-02-18 00:44:35.392806","approval":true},{"sender":"estade@chromium.org","recipients":["erg@chromium.org","evan@chromium.org","estade@chromium.org","chromium-reviews@googlegroups.com"],"text":"http://codereview.chromium.org/21438/diff/7/8\nFile chrome/browser/gtk/browser_toolbar_view_gtk.cc (right):\n\nhttp://codereview.chromium.org/21438/diff/7/8#newcode281\nLine 281: OpenURL(dest, GURL(), CURRENT_TAB, PageTransition::TYPED);\nOn 2009/02/18 00:44:35, Evan Martin wrote:\n> I still think this is wrong -- I think it should be some API on browser\n> directly.  Maybe browser_->Go() would do it?  Oh, but we lose the transition\n> type.  Maybe via the navigation controller?  In any case, can be fixed later.\n\nI believe it would be:\n\nbrowser->OpenURLFromTab(NULL, GURL(url), GURL(),\n                        CURRENT_TAB,      PageTransition::TYPED);\n\nbut when I tried to do this before, it didn't work because it created a new RenderWidgetHostView, so our hack in BrowserWindowGtk broke it.","disapproval":false,"date":"2009-02-18 00:59:32.218111","approval":false},{"sender":"erg@chromium.org","recipients":["erg@chromium.org","evan@chromium.org","estade@chromium.org","chromium-reviews@googlegroups.com"],"text":"On 2009/02/18 00:59:32, estade wrote:\n> browser->OpenURLFromTab(NULL, GURL(url), GURL(),\n>                         CURRENT_TAB,      PageTransition::TYPED);\n> \n> but when I tried to do this before, it didn't work because it created a new\n> RenderWidgetHostView, so our hack in BrowserWindowGtk broke it.\n\nI believe that estade is correct and I've uploaded a new version. (BTW, it doesn't crash if you edit the URL so that it's within the same SiteInstance. e.g., add \"for-testers\" to the end of dev.chromium.org.)","disapproval":false,"date":"2009-02-18 01:06:05.434521","approval":false},{"sender":"evan@chromium.org","recipients":["erg@chromium.org","evan@chromium.org","estade@chromium.org","chromium-reviews@googlegroups.com"],"text":"On 2009/02/18 01:06:05, Elliot Glaysher wrote:\n> On 2009/02/18 00:59:32, estade wrote:\n> > browser->OpenURLFromTab(NULL, GURL(url), GURL(),\n> >                         CURRENT_TAB,      PageTransition::TYPED);\n> > \n> > but when I tried to do this before, it didn't work because it created a new\n> > RenderWidgetHostView, so our hack in BrowserWindowGtk broke it.\n> \n> I believe that estade is correct and I've uploaded a new version. (BTW, it\n> doesn't crash if you edit the URL so that it's within the same SiteInstance.\n> e.g., add \"for-testers\" to the end of dev.chromium.org.)\n\nOK","disapproval":false,"date":"2009-02-18 01:07:43.263454","approval":false}],"owner_email":"erg@chromium.org","private":false,"base_url":"","owner":"Elliot Glaysher","subject":"Display the current URL and connect the entry widget to OpenURL().","created":"2009-02-17 23:53:27.825409","patchsets":[1,1007,7,17],"modified":"2011-05-09 13:45:59.257591","closed":true,"commit":false,"issue":21438}
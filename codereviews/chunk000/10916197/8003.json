{"files":{"chrome/browser/extensions/api/system_info_cpu/cpu_info_provider_win.cc":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":61,"num_removed":2,"messages":[{"author":"alexeypa (please no reviews)","author_email":"alexeypa@chromium.org","text":"Actually, you don't need to test |times| for being NULL here at all. AV while trying to dereference |times| is a better  indication that something is wrong. The return value is too easy to ignore.","draft":false,"lineno":28,"date":"2012-09-12 15:41:55.435590","left":false},{"author":"alexeypa (please no reviews)","author_email":"alexeypa@chromium.org","text":"DCHECK -> CHECK","draft":false,"lineno":34,"date":"2012-09-12 15:41:55.451450","left":false},{"author":"alexeypa (please no reviews)","author_email":"alexeypa@chromium.org","text":"This also can be CHECK(NtQuerySystemInformation != NULL).","draft":false,"lineno":39,"date":"2012-09-12 15:41:55.468440","left":false},{"author":"alexeypa (please no reviews)","author_email":"alexeypa@chromium.org","text":"You can merge this line with line #48.","draft":false,"lineno":46,"date":"2012-09-12 15:41:55.472940","left":false},{"author":"alexeypa (please no reviews)","author_email":"alexeypa@chromium.org","text":"Use NT_SUCCESS macro to test whether NtQuerySystemInformation succeeded.","draft":false,"lineno":49,"date":"2012-09-12 15:41:55.475470","left":false},{"author":"alexeypa (please no reviews)","author_email":"alexeypa@chromium.org","text":"Remove this DCHECK. It is legal (though unlikely) situation when NtQuerySystemInformation will return different number of processors than requested. ","draft":false,"lineno":57,"date":"2012-09-12 15:41:55.520640","left":false},{"author":"alexeypa (please no reviews)","author_email":"alexeypa@chromium.org","text":"Since you know the number of elements you are going to put to the vector, preallocate them with std::vector::reserve() call before the loop.","draft":false,"lineno":61,"date":"2012-09-12 15:41:55.551270","left":false},{"author":"Hongbo Min","author_email":"hongbo.min@intel.com","text":"On 2012/09/12 15:41:55, alexeypa wrote:\n> Actually, you don't need to test |times| for being NULL here at all. AV while\n> trying to dereference |times| is a better  indication that something is wrong.\n> The return value is too easy to ignore.\nWhat does AV stand for? Although it is too easy, it guarantees that the QueryCpuTimePerProcessor works as normal in any case,even a null point is passed. It is just for the API's completeness:)\n\n","draft":false,"lineno":28,"date":"2012-09-13 13:16:59.197150","left":false},{"author":"Hongbo Min","author_email":"hongbo.min@intel.com","text":"On 2012/09/12 15:41:55, alexeypa wrote:\n> DCHECK -> CHECK\n\nDone.","draft":false,"lineno":34,"date":"2012-09-13 13:16:59.197520","left":false},{"author":"Hongbo Min","author_email":"hongbo.min@intel.com","text":"On 2012/09/12 15:41:55, alexeypa wrote:\n> This also can be CHECK(NtQuerySystemInformation != NULL).\n\nDone.","draft":false,"lineno":39,"date":"2012-09-13 13:16:59.197850","left":false},{"author":"Hongbo Min","author_email":"hongbo.min@intel.com","text":"On 2012/09/12 15:41:55, alexeypa wrote:\n> You can merge this line with line #48.\n\nDone.","draft":false,"lineno":46,"date":"2012-09-13 13:16:59.198390","left":false},{"author":"Hongbo Min","author_email":"hongbo.min@intel.com","text":"On 2012/09/12 15:41:55, alexeypa wrote:\n> Use NT_SUCCESS macro to test whether NtQuerySystemInformation succeeded.\n\nDone.","draft":false,"lineno":49,"date":"2012-09-13 13:16:59.198650","left":false},{"author":"Hongbo Min","author_email":"hongbo.min@intel.com","text":"On 2012/09/12 15:41:55, alexeypa wrote:\n> Remove this DCHECK. It is legal (though unlikely) situation when\n> NtQuerySystemInformation will return different number of processors than\n> requested. \n\nRemoved the DCHECK stmt, but still return false if their values are different to avoid the inconsistency if the consumer also use SysInfo::NumberOfProcessors to get the number of processors.","draft":false,"lineno":57,"date":"2012-09-13 13:16:59.198910","left":false},{"author":"Hongbo Min","author_email":"hongbo.min@intel.com","text":"On 2012/09/12 15:41:55, alexeypa wrote:\n> Since you know the number of elements you are going to put to the vector,\n> preallocate them with std::vector::reserve() call before the loop.\n\nDone.","draft":false,"lineno":61,"date":"2012-09-13 13:16:59.199200","left":false},{"author":"alexeypa (please no reviews)","author_email":"alexeypa@chromium.org","text":"On 2012/09/13 13:16:59, Hongbo Min wrote:\n> On 2012/09/12 15:41:55, alexeypa wrote:\n> > Actually, you don't need to test |times| for being NULL here at all. AV while\n> > trying to dereference |times| is a better  indication that something is wrong.\n> > The return value is too easy to ignore.\n> What does AV stand for?\n\nAccess violation.\n\n> Although it is too easy, it guarantees that the\n> QueryCpuTimePerProcessor works as normal in any case,even a null point is\n> passed. It is just for the API's completeness:)\n\nProbing a pointer parameter is a good idea if the API crosses trust boundary (user -> kernel) or it is a public API. In this case however, no trust boundaries are crossed. Both the caller and the callee live in the same binary. If a caller passes a bogus pointer it will be immediately seen as a crash, and so it will be fixed. Returning an error does not guarantee anything, since it can be easily ignored.\n\nThere is a different way to put it. Without the check if a caller passes an invalid pointer (either NULL or not-NULL invalid pointer) the function will generate access violation. With the check the function return false if the pointer is NULL and crash if the pointer is invalid but not NULL. So you have an additional variation in behavior that needs to be tested.\n\n","draft":false,"lineno":28,"date":"2012-09-13 16:45:48.013180","left":false}],"id":7003,"is_binary":false},"chrome/browser/extensions/api/system_info_cpu/cpu_info_provider.h":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":1,"num_removed":2,"messages":[],"id":7002,"is_binary":false}},"owner_email":"hongbo.min@intel.com","owner":"Hongbo Min","message":"updated patch","try_job_results":[],"created":"2012-09-12 12:27:08.145930","url":null,"num_comments":15,"modified":"2012-09-13 16:45:48.129520","patchset":8003,"issue":10916197}
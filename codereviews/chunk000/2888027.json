{"description":"GTK: when closing a browser window, cancel the active drag session.\n\nThis speculatively works around an issue where users' windows would get stuck open in rare (non-reproducible, but widely reported) cases.\n\nBUG=23733\nTEST=none :(\n\nCommitted: http://src.chromium.org/viewvc/chrome?view=rev&revision=53268","cc":["chromium-reviews@chromium.org","ben+cc@chromium.org"],"reviewers":["tony@chromium.org"],"messages":[{"sender":"estade@chromium.org","recipients":["estade@chromium.org","tony@chromium.org","chromium-reviews@chromium.org","ben+cc@chromium.org"],"text":"","disapproval":false,"date":"2010-07-21 02:27:17.106038","approval":false},{"sender":"tony@chromium.org","recipients":["estade@chromium.org","tony@chromium.org","chromium-reviews@chromium.org","ben+cc@chromium.org"],"text":"LG\n\nhttp://codereview.chromium.org/2888027/diff/2001/3001\nFile chrome/browser/gtk/browser_window_gtk.cc (right):\n\nhttp://codereview.chromium.org/2888027/diff/2001/3001#newcode670\nchrome/browser/gtk/browser_window_gtk.cc:670: tabstrip_->CancelActiveDragSession();\nNit: Should this go after the CanClose check right below it?  In which case it'll be near the tabstrip_->StopAnimation(). Maybe there should be a generic tabstrip_->WindowClosing() or something?  Having 2 separate methods is fine too (probably more readable).","disapproval":false,"date":"2010-07-21 16:46:19.170293","approval":false},{"sender":"estade@chromium.org","recipients":["estade@chromium.org","tony@chromium.org","chromium-reviews@chromium.org","ben+cc@chromium.org"],"text":"http://codereview.chromium.org/2888027/diff/2001/3001\nFile chrome/browser/gtk/browser_window_gtk.cc (right):\n\nhttp://codereview.chromium.org/2888027/diff/2001/3001#newcode670\nchrome/browser/gtk/browser_window_gtk.cc:670: tabstrip_->CancelActiveDragSession();\nOn 2010/07/21 16:46:19, tony wrote:\n> Nit: Should this go after the CanClose check right below it?  In which case\n> it'll be near the tabstrip_->StopAnimation(). Maybe there should be a generic\n> tabstrip_->WindowClosing() or something? \n\nI like this idea, but I think that StopAnimation() needs to come after CanClose() has returned true (so we know we are actually closing), whereas CancelActiveDragSession() has to come before CanClose() (or it will never get hit in the active drag case).","disapproval":false,"date":"2010-07-21 19:01:03.460369","approval":false},{"sender":"tony@chromium.org","recipients":["estade@chromium.org","tony@chromium.org","chromium-reviews@chromium.org","ben+cc@chromium.org"],"text":"http://codereview.chromium.org/2888027/diff/2001/3001\nFile chrome/browser/gtk/browser_window_gtk.cc (right):\n\nhttp://codereview.chromium.org/2888027/diff/2001/3001#newcode670\nchrome/browser/gtk/browser_window_gtk.cc:670: tabstrip_->CancelActiveDragSession();\nI see, CanClose checks for IsDragSessionActive.  Maybe we should remove that check now since it will now always be false?  Then we can move CancelActiveDragSession() below the call to CanClose().\n\nOn 2010/07/21 19:01:03, Evan Stade wrote:\n> On 2010/07/21 16:46:19, tony wrote:\n> > Nit: Should this go after the CanClose check right below it?  In which case\n> > it'll be near the tabstrip_->StopAnimation(). Maybe there should be a generic\n> > tabstrip_->WindowClosing() or something? \n> \n> I like this idea, but I think that StopAnimation() needs to come after\n> CanClose() has returned true (so we know we are actually closing), whereas\n> CancelActiveDragSession() has to come before CanClose() (or it will never get\n> hit in the active drag case).\n>","disapproval":false,"date":"2010-07-21 19:06:38.207462","approval":false},{"sender":"estade@chromium.org","recipients":["estade@chromium.org","tony@chromium.org","chromium-reviews@chromium.org","ben+cc@chromium.org"],"text":"http://codereview.chromium.org/2888027/diff/2001/3001\nFile chrome/browser/gtk/browser_window_gtk.cc (right):\n\nhttp://codereview.chromium.org/2888027/diff/2001/3001#newcode670\nchrome/browser/gtk/browser_window_gtk.cc:670: tabstrip_->CancelActiveDragSession();\nOn 2010/07/21 19:06:38, tony wrote:\n> I see, CanClose checks for IsDragSessionActive.  Maybe we should remove that\n> check now since it will now always be false?  Then we can move\n> CancelActiveDragSession() below the call to CanClose().\n\nCanClose() is a part of the public API. I tried removing that check but it broke the action of dragging the last tab out of a window.","disapproval":false,"date":"2010-07-21 21:33:04.838310","approval":false},{"sender":"tony@chromium.org","recipients":["estade@chromium.org","tony@chromium.org","chromium-reviews@chromium.org","ben+cc@chromium.org"],"text":"I see, then the original change LGTM.","disapproval":false,"date":"2010-07-21 21:36:39.608908","approval":true}],"owner_email":"estade@chromium.org","private":false,"base_url":"http://src.chromium.org/git/chromium.git","owner":"Evan Stade","subject":"GTK: when closing a browser window, cancel the active drag session.","created":"2010-07-21 01:48:53.539357","patchsets":[1,2001],"modified":"2011-06-22 20:24:07.398338","closed":true,"commit":false,"issue":2888027}
{"files":{"chrome/common/pref_names.cc":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":5,"num_removed":1,"messages":[{"author":"grt","author_email":"grt@chromium.org","text":"kRestoreStartupURLsMigrated is not a delta, nor is it in milliseconds. it is the time at which the last migration took place, measured in the (fractional) number number of seconds since the UNIX epoch. given that this is an internal value used for our own computations, why not use an int64 to hold it, and use Time::{From,To}InternalValue to store/load it? this seems more efficient and more accurate.","draft":false,"lineno":87,"date":"2013-10-07 20:15:16.972710","left":false},{"author":"robertshield","author_email":"robertshield@chromium.org","text":"On 2013/10/07 20:15:16, grt wrote:\n> kRestoreStartupURLsMigrated is not a delta, nor is it in milliseconds. \n\nThis is true, I'll update the comment.\n\nit is the\n> time at which the last migration took place, measured in the (fractional) number\n> number of seconds since the UNIX epoch. given that this is an internal value\n> used for our own computations, why not use an int64 to hold it, and use\n> Time::{From,To}InternalValue to store/load it? this seems more efficient and\n> more accurate.\n\nProbably not more efficient as json doesn't have a big int type, while it does have a double type. The prefs system will convert int64s to strings and back under the hood. Likely more accurate, though not sure if meaningfully so. \n\nI'll change it anyway since this value appears to only be used for serialization and base::Time explicitly recommends using int64s (via ToInternalValue) for serialization.","draft":false,"lineno":87,"date":"2013-10-08 01:52:13.368940","left":false}],"id":35003,"is_binary":false},"chrome/common/pref_names.h":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":4,"num_removed":0,"messages":[{"author":"grt","author_email":"grt@chromium.org","text":"is there an echo in here?","draft":false,"lineno":37,"date":"2013-10-07 20:15:16.973060","left":false},{"author":"robertshield","author_email":"robertshield@chromium.org","text":"On 2013/10/07 20:15:16, grt wrote:\n> is there an echo in here?\n\nhere here here... \n\nugh, merge splatter, thanks for catching.\n\n","draft":false,"lineno":37,"date":"2013-10-08 01:52:13.369240","left":false}],"id":35004,"is_binary":false},"chrome/browser/prefs/pref_model_associator.cc":{"status":"M","num_chunks":7,"no_base_file":false,"property_changes":"","num_added":97,"num_removed":12,"messages":[{"author":"grt","author_email":"grt@chromium.org","text":"what is \"the right thing\"? maybe spell out that it causes values under the old name that come down from sync to warp to the new name (assuming that's what it means).","draft":false,"lineno":52,"date":"2013-10-07 20:15:16.970060","left":false},{"author":"grt","author_email":"grt@chromium.org","text":"const struct\nmega nit: this type doesn't need a name, but maybe it's happier with one.","draft":false,"lineno":55,"date":"2013-10-07 20:15:16.970390","left":false},{"author":"grt","author_email":"grt@chromium.org","text":"const char* const","draft":false,"lineno":56,"date":"2013-10-07 20:15:16.970740","left":false},{"author":"grt","author_email":"grt@chromium.org","text":"int -> size_t since you're comparing with arraysize, which returns size_t (here and line 71).","draft":false,"lineno":63,"date":"2013-10-07 20:15:16.971070","left":false},{"author":"grt","author_email":"grt@chromium.org","text":"\"\" -> std::string() here and line 75","draft":false,"lineno":67,"date":"2013-10-07 20:15:16.971440","left":false},{"author":"grt","author_email":"grt@chromium.org","text":"in the block above, it's safe to assume that new_name.c_str() is always registered?","draft":false,"lineno":460,"date":"2013-10-07 20:15:16.971840","left":false},{"author":"robertshield","author_email":"robertshield@chromium.org","text":"On 2013/10/07 20:15:16, grt wrote:\n> what is \"the right thing\"? maybe spell out that it causes values under the old\n> name that come down from sync to warp to the new name (assuming that's what it\n> means).\n\nDone.","draft":false,"lineno":52,"date":"2013-10-08 01:52:13.367010","left":false},{"author":"robertshield","author_email":"robertshield@chromium.org","text":"On 2013/10/07 20:15:16, grt wrote:\n> const struct\n\nDone. \n\n> mega nit: this type doesn't need a name, but maybe it's happier with one.\n\nI prefer useful symbol names and dislike anonymous types.","draft":false,"lineno":55,"date":"2013-10-08 01:52:13.367310","left":false},{"author":"robertshield","author_email":"robertshield@chromium.org","text":"On 2013/10/07 20:15:16, grt wrote:\n> const char* const\n\nDone.","draft":false,"lineno":56,"date":"2013-10-08 01:52:13.367570","left":false},{"author":"robertshield","author_email":"robertshield@chromium.org","text":"On 2013/10/07 20:15:16, grt wrote:\n> int -> size_t since you're comparing with arraysize, which returns size_t (here\n> and line 71).\n\nDone.","draft":false,"lineno":63,"date":"2013-10-08 01:52:13.367840","left":false},{"author":"robertshield","author_email":"robertshield@chromium.org","text":"On 2013/10/07 20:15:16, grt wrote:\n> \"\" -> std::string() here and line 75\n\nDone.","draft":false,"lineno":67,"date":"2013-10-08 01:52:13.368150","left":false},{"author":"robertshield","author_email":"robertshield@chromium.org","text":"On 2013/10/07 20:15:16, grt wrote:\n> in the block above, it's safe to assume that new_name.c_str() is always\n> registered?\n\nThat's interesting. MAD's patch was doing so, but looking at line 464 I am not so sure.\n\nI see no reason to bypass the IsPrefRegistered check here just because of the migration, so I'll drop the 'else'.\n\n@Nicolas, please holler if you object.\n\n","draft":false,"lineno":460,"date":"2013-10-08 01:52:13.368390","left":false}],"id":35001,"is_binary":false},"tools/metrics/histograms/histograms.xml":{"status":"M","num_chunks":2,"no_base_file":true,"property_changes":"","num_added":16,"num_removed":0,"messages":[],"id":35005,"is_binary":false},"chrome/browser/prefs/session_startup_pref.cc":{"status":"M","num_chunks":4,"no_base_file":false,"property_changes":"","num_added":59,"num_removed":1,"messages":[{"author":"grt","author_email":"grt@chromium.org","text":"DCHECK_GT\nfor safety, i suggest adding:\n  if (now < last_migration_time)\n    last_migration_time = now;\ni don't know what exactly happens around DST, leap seconds, flaky BIOS clocks, unpredictable rounding, IEEE doubles, etc, but may as well play it safe.","draft":false,"lineno":185,"date":"2013-10-07 20:15:16.972270","left":false},{"author":"robertshield","author_email":"robertshield@chromium.org","text":"On 2013/10/07 20:15:16, grt wrote:\n> DCHECK_GT\n\nDoesn't seem to work with base::Time objects.\n\n> for safety, i suggest adding:\n>   if (now < last_migration_time)\n>     last_migration_time = now;\n> i don't know what exactly happens around DST, leap seconds, flaky BIOS clocks,\n> unpredictable rounding, IEEE doubles, etc, but may as well play it safe.\n\nI asked MAD about this here: https://codereview.chromium.org/24930003/diff/14001/chrome/browser/prefs/session_startup_pref.cc#newcode187\nand the behaviour is apparently that 0 will be recorded anyway for negative values. \n\nI'll clamp it to zero anyway to make it explicit.","draft":false,"lineno":185,"date":"2013-10-08 01:52:13.368690","left":false},{"author":"grt","author_email":"grt@chromium.org","text":"On 2013/10/08 01:52:13, robertshield wrote:\n> On 2013/10/07 20:15:16, grt wrote:\n> > DCHECK_GT\n> \n> Doesn't seem to work with base::Time objects.\n\npity.\n> > for safety, i suggest adding:\n> >   if (now < last_migration_time)\n> >     last_migration_time = now;\n> > i don't know what exactly happens around DST, leap seconds, flaky BIOS clocks,\n> > unpredictable rounding, IEEE doubles, etc, but may as well play it safe.\n> \n> I asked MAD about this here:\n> https://codereview.chromium.org/24930003/diff/14001/chrome/browser/prefs/session_startup_pref.cc#newcode187\n> and the behaviour is apparently that 0 will be recorded anyway for negative\n> values. \n\noh, sorry for repeating.","draft":false,"lineno":185,"date":"2013-10-08 13:20:11.289880","left":false}],"id":35002,"is_binary":false}},"owner_email":"mad@chromium.org","owner":"MAD","message":"Address Nicolas' nit, Greg's feedback.","try_job_results":[{"parent_name":null,"tests":["defaulttests"],"slave":"vm304-m4","url":"http://build.chromium.org/p/tryserver.chromium/builders/win_rel/builds/206096","timestamp":"2013-10-07 20:54:41.053182","builder":"win_rel","clobber":false,"project":"Chromium Try Server","reason":"mad2","result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnI3CxIFSXNzdWUY083xCwwLEghQYXRjaFNldBjRiQIMCxIMVHJ5Sm9iUmVzdWx0GICAgICAtu0JDA","requester":"robertshield@chromium.org","buildnumber":"206096","revision":"227293"},{"parent_name":null,"tests":["compile"],"slave":"vm327-m4","url":"http://build.chromium.org/p/tryserver.chromium/builders/win/builds/114430","timestamp":"2013-10-07 20:33:37.363251","builder":"win","clobber":false,"project":"Chromium Try Server","reason":"mad2","result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnI3CxIFSXNzdWUY083xCwwLEghQYXRjaFNldBjRiQIMCxIMVHJ5Sm9iUmVzdWx0GICAgICAts0LDA","requester":"robertshield@chromium.org","buildnumber":"114430","revision":"227293"},{"parent_name":"win_rel","tests":["defaulttests"],"slave":"slave514-c4#3","url":"http://build.chromium.org/p/tryserver.chromium/builders/swarm_triggered/builds/52300","timestamp":"2013-10-07 20:13:41.375643","builder":"swarm_triggered","clobber":false,"project":"Chromium Try Server","reason":"Triggerable(swarm_triggered)","result":"2","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnI3CxIFSXNzdWUY083xCwwLEghQYXRjaFNldBjRiQIMCxIMVHJ5Sm9iUmVzdWx0GICAgICAjqUKDA","requester":null,"buildnumber":"52300","revision":"227293"},{"parent_name":null,"tests":["defaulttests"],"slave":"vm208-m4","url":"http://build.chromium.org/p/tryserver.chromium/builders/win7_aura/builds/86385","timestamp":"2013-10-07 20:04:55.236375","builder":"win7_aura","clobber":false,"project":"Chromium Try Server","reason":"mad2","result":"2","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnI3CxIFSXNzdWUY083xCwwLEghQYXRjaFNldBjRiQIMCxIMVHJ5Sm9iUmVzdWx0GICAgICAts0IDA","requester":"robertshield@chromium.org","buildnumber":"86385","revision":"227293"},{"parent_name":null,"tests":["compile"],"slave":"vm750-m4","url":"http://build.chromium.org/p/tryserver.chromium/builders/win_x64_rel/builds/43511","timestamp":"2013-10-07 19:58:09.572923","builder":"win_x64_rel","clobber":false,"project":"Chromium Try Server","reason":"mad2","result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnI3CxIFSXNzdWUY083xCwwLEghQYXRjaFNldBjRiQIMCxIMVHJ5Sm9iUmVzdWx0GICAgICAtu0LDA","requester":"robertshield@chromium.org","buildnumber":"43511","revision":"227293"},{"parent_name":null,"tests":["compile"],"slave":"vm697-m4","url":"http://build.chromium.org/p/tryserver.chromium/builders/mac/builds/91090","timestamp":"2013-10-07 19:50:14.342916","builder":"mac","clobber":false,"project":"Chromium Try Server","reason":"mad2","result":"2","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnI3CxIFSXNzdWUY083xCwwLEghQYXRjaFNldBjRiQIMCxIMVHJ5Sm9iUmVzdWx0GICAgICAtq0LDA","requester":"robertshield@chromium.org","buildnumber":"91090","revision":"227293"},{"parent_name":null,"tests":["compile"],"slave":"slave370-c4","url":"http://build.chromium.org/p/tryserver.chromium/builders/linux_clang/builds/145015","timestamp":"2013-10-07 19:41:33.951915","builder":"linux_clang","clobber":false,"project":"Chromium Try Server","reason":"mad2","result":"2","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnI3CxIFSXNzdWUY083xCwwLEghQYXRjaFNldBjRiQIMCxIMVHJ5Sm9iUmVzdWx0GICAgICAtu0KDA","requester":"robertshield@chromium.org","buildnumber":"145015","revision":"227293"},{"parent_name":null,"tests":["defaulttests"],"slave":"slave543-c4","url":"http://build.chromium.org/p/tryserver.chromium/builders/android_aosp/builds/18109","timestamp":"2013-10-07 19:38:15.009210","builder":"android_aosp","clobber":false,"project":"Chromium Try Server","reason":"mad2","result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnI3CxIFSXNzdWUY083xCwwLEghQYXRjaFNldBjRiQIMCxIMVHJ5Sm9iUmVzdWx0GICAgICAto0KDA","requester":"robertshield@chromium.org","buildnumber":"18109","revision":"227293"},{"parent_name":null,"tests":["defaulttests"],"slave":"slave303-c4","url":"http://build.chromium.org/p/tryserver.chromium/builders/linux_rel/builds/175694","timestamp":"2013-10-07 19:37:25.870128","builder":"linux_rel","clobber":false,"project":"Chromium Try Server","reason":"mad2","result":"2","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnI3CxIFSXNzdWUY083xCwwLEghQYXRjaFNldBjRiQIMCxIMVHJ5Sm9iUmVzdWx0GICAgICAtp0IDA","requester":"robertshield@chromium.org","buildnumber":"175694","revision":"227293"},{"parent_name":null,"tests":["defaulttests"],"slave":"slave262-c4","url":"http://build.chromium.org/p/tryserver.chromium/builders/linux_aura/builds/85173","timestamp":"2013-10-07 19:37:21.574022","builder":"linux_aura","clobber":false,"project":"Chromium Try Server","reason":"mad2","result":"2","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnI3CxIFSXNzdWUY083xCwwLEghQYXRjaFNldBjRiQIMCxIMVHJ5Sm9iUmVzdWx0GICAgICAto0JDA","requester":"robertshield@chromium.org","buildnumber":"85173","revision":"227293"},{"parent_name":null,"tests":["defaulttests"],"slave":"slave341-c4","url":"http://build.chromium.org/p/tryserver.chromium/builders/linux_chromeos/builds/162371","timestamp":"2013-10-07 19:36:56.641415","builder":"linux_chromeos","clobber":false,"project":"Chromium Try Server","reason":"mad2","result":"2","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnI3CxIFSXNzdWUY083xCwwLEghQYXRjaFNldBjRiQIMCxIMVHJ5Sm9iUmVzdWx0GICAgICAto0LDA","requester":"robertshield@chromium.org","buildnumber":"162371","revision":"227293"},{"parent_name":null,"tests":["defaulttests"],"slave":"mini31-l1","url":"http://build.chromium.org/p/tryserver.chromium/builders/ios_dbg_simulator/builds/90958","timestamp":"2013-10-07 19:34:21.028753","builder":"ios_dbg_simulator","clobber":false,"project":"Chromium Try Server","reason":"mad2","result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnI3CxIFSXNzdWUY083xCwwLEghQYXRjaFNldBjRiQIMCxIMVHJ5Sm9iUmVzdWx0GICAgICAtq0KDA","requester":"robertshield@chromium.org","buildnumber":"90958","revision":"227293"},{"parent_name":null,"tests":["defaulttests"],"slave":"vm733-m4","url":"http://build.chromium.org/p/tryserver.chromium/builders/mac_rel/builds/175289","timestamp":"2013-10-07 19:30:29.506882","builder":"mac_rel","clobber":false,"project":"Chromium Try Server","reason":"mad2","result":"2","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnI3CxIFSXNzdWUY083xCwwLEghQYXRjaFNldBjRiQIMCxIMVHJ5Sm9iUmVzdWx0GICAgICAtq0IDA","requester":"robertshield@chromium.org","buildnumber":"175289","revision":"227293"},{"parent_name":null,"tests":["defaulttests"],"slave":"vm410-m4","url":"http://build.chromium.org/p/tryserver.chromium/builders/android_dbg/builds/109887","timestamp":"2013-10-07 19:26:52.642390","builder":"android_dbg","clobber":false,"project":"Chromium Try Server","reason":"mad2","result":"2","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnI3CxIFSXNzdWUY083xCwwLEghQYXRjaFNldBjRiQIMCxIMVHJ5Sm9iUmVzdWx0GICAgICAtu0IDA","requester":"robertshield@chromium.org","buildnumber":"109887","revision":"227293"},{"parent_name":null,"tests":["defaulttests"],"slave":"vm413-m4","url":"http://build.chromium.org/p/tryserver.chromium/builders/android_clang_dbg/builds/82160","timestamp":"2013-10-07 19:26:43.548094","builder":"android_clang_dbg","clobber":false,"project":"Chromium Try Server","reason":"mad2","result":"2","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnI3CxIFSXNzdWUY083xCwwLEghQYXRjaFNldBjRiQIMCxIMVHJ5Sm9iUmVzdWx0GICAgICAts0KDA","requester":"robertshield@chromium.org","buildnumber":"82160","revision":"227293"},{"parent_name":null,"tests":["defaulttests"],"slave":"mini39-l1","url":"http://build.chromium.org/p/tryserver.chromium/builders/ios_rel_device/builds/85542","timestamp":"2013-10-07 19:26:24.886026","builder":"ios_rel_device","clobber":false,"project":"Chromium Try Server","reason":"mad2","result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnI3CxIFSXNzdWUY083xCwwLEghQYXRjaFNldBjRiQIMCxIMVHJ5Sm9iUmVzdWx0GICAgICAtq0JDA","requester":"robertshield@chromium.org","buildnumber":"85542","revision":"227293"},{"parent_name":null,"tests":["defaulttests"],"slave":"slave374-c4","url":"http://build.chromium.org/p/tryserver.chromium/builders/linux_asan/builds/49334","timestamp":"2013-10-07 19:21:05.678688","builder":"linux_asan","clobber":false,"project":"Chromium Try Server","reason":"mad2","result":"2","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnI3CxIFSXNzdWUY083xCwwLEghQYXRjaFNldBjRiQIMCxIMVHJ5Sm9iUmVzdWx0GICAgICAts0JDA","requester":"robertshield@chromium.org","buildnumber":"49334","revision":"227293"}],"created":"2013-10-07 19:16:33.049890","url":null,"num_comments":19,"modified":"2013-10-08 13:20:11.351830","patchset":34001,"issue":24930003}
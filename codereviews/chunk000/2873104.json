{"description":"Allow per-plugin content settings.\r\n\r\nRun with --enable-resource-content-settings and --enable-click-to-play to enable.\r\n\r\nTabSpecificContentSettings now keeps track of which resources were blocked. The content setting bubble displays those resource, and selecting the \"allow radio buttons adds exceptions for these resources.\r\n\r\nThe infobar for non-sandboxed plug-ins now also shows a button to always allow the blocked plug-in on that site.\r\n\r\nScreenshot of the plugin bubble: ï»¿http://imgur.com/6npqv.png\r\n\r\nBecause we need to change the title and radio button labels depending on whether we track specific plug-ins, we copy them from the ContentSettingBubbleModel.\r\n\r\nXIB changes: Add a text field for the blocked plug-ins to ContentBlockedPlugins.xib, hooked up to the |blockedResourcesField_| outlet.\r\n\r\nBUG=39252,38432\r\nTEST=manual\n\nCommitted: http://src.chromium.org/viewvc/chrome?view=rev&revision=55888","cc":["chromium-reviews@chromium.org","ben+cc@chromium.org","jrg@chromium.org","phajdan.jr@chromium.org","jam@chromium.org","darin-cc@chromium.org","brettw-cc@chromium.org","pam+watch@chromium.org"],"reviewers":["jochen@chromium.org","brettw@chromium.org","pam@chromium.org"],"messages":[{"sender":"bauerb@chromium.org","recipients":["bauerb@chromium.org","jochen@chromium.org","chromium-reviews@chromium.org","ben+cc@chromium.org","jrg@chromium.org","phajdan.jr@chromium.org","jam@chromium.org","darin-cc@chromium.org","brettw-cc@chromium.org","pam+watch@chromium.org"],"text":"Please review. \n\nThe Mac UI changes are pretty minor, do you feel like reviewing them yourself?\n\nAlso, there's some stuff I'm not sure about myself below:\n\nhttp://codereview.chromium.org/2873104/diff/10001/11031\nFile chrome/renderer/render_view.cc (right):\n\nhttp://codereview.chromium.org/2873104/diff/10001/11031#newcode2239\nchrome/renderer/render_view.cc:2239: frame->top()->url(),\nIn the browser process, we use TabContents::GetURL to get the URL for content settings. Is that always the same URL as this one, or am I missing some edge case?","disapproval":false,"date":"2010-08-10 13:37:25.047008","approval":false},{"sender":"brettw@chromium.org","recipients":["bauerb@chromium.org","jochen@chromium.org","brettw@chromium.org","chromium-reviews@chromium.org","ben+cc@chromium.org","jrg@chromium.org","phajdan.jr@chromium.org","jam@chromium.org","darin-cc@chromium.org","brettw-cc@chromium.org","pam+watch@chromium.org"],"text":"We prefer std::string() for arguments that need empty strings rather than \"\", which implicitly calls the std::string constructor, which then has to do extra work to check your string. When you use the explicit empty constructor, there is no implicit conversion which is more clear, and it can also initialize the data and length without looking at any input.","disapproval":false,"date":"2010-08-10 20:28:27.010165","approval":false},{"sender":"jochen@chromium.org","recipients":["bauerb@chromium.org","jochen@chromium.org","brettw@chromium.org","chromium-reviews@chromium.org","ben+cc@chromium.org","jrg@chromium.org","phajdan.jr@chromium.org","jam@chromium.org","darin-cc@chromium.org","brettw-cc@chromium.org","pam+watch@chromium.org"],"text":"a few comments. the general underlying logic looks good, you might want to get the final lgtm from another reviewer, since i'm on vacation for the rest of the week\n\nhttp://codereview.chromium.org/2873104/diff/14001/15002\nFile base/file_path.h (right):\n\nhttp://codereview.chromium.org/2873104/diff/14001/15002#newcode296\nbase/file_path.h:296: static FilePath FromUTF8String(const std::string& string);\nnit. add a comment when to use and when to not use.\n\nhttp://codereview.chromium.org/2873104/diff/14001/15003\nFile chrome/app/generated_resources.grd (right):\n\nhttp://codereview.chromium.org/2873104/diff/14001/15003#newcode2380\nchrome/app/generated_resources.grd:2380: The following plug-ins were blocked on this page:\nstrange text for a tooltip, esp with the colon at the end, maybe fork?\n\nhttp://codereview.chromium.org/2873104/diff/14001/15008\nFile chrome/browser/cocoa/content_blocked_bubble_controller.mm (right):\n\nhttp://codereview.chromium.org/2873104/diff/14001/15008#newcode243\nchrome/browser/cocoa/content_blocked_bubble_controller.mm:243: it != plugins.end(); ++it) {\nnit. one more space\n\nhttp://codereview.chromium.org/2873104/diff/14001/15009\nFile chrome/browser/content_setting_bubble_model.cc (right):\n\nhttp://codereview.chromium.org/2873104/diff/14001/15009#newcode44\nchrome/browser/content_setting_bubble_model.cc:44: it != resources.end(); ++it) {\nnit. one more space\n\nhttp://codereview.chromium.org/2873104/diff/14001/15009#newcode60\nchrome/browser/content_setting_bubble_model.cc:60: 0,  // No resource-specific content settings for cookies.\nnit. i don't think you need all these comments\n\nhttp://codereview.chromium.org/2873104/diff/14001/15009#newcode199\nchrome/browser/content_setting_bubble_model.cc:199: 0,  // We don't manage cookies here.\nnit. i don't think you need all of these comments\n\nhttp://codereview.chromium.org/2873104/diff/14001/15009#newcode245\nchrome/browser/content_setting_bubble_model.cc:245: content_type(), *it);\nnit. put all parameters in one line with 4 space indent\n\nhttp://codereview.chromium.org/2873104/diff/14001/15009#newcode256\nchrome/browser/content_setting_bubble_model.cc:256: const std::string& resource_identifier) {\nnit. Just AddException, because it's also used without a special resource\n\nhttp://codereview.chromium.org/2873104/diff/14001/15023\nFile chrome/browser/tab_contents/tab_specific_content_settings.cc (right):\n\nhttp://codereview.chromium.org/2873104/diff/14001/15023#newcode174\nchrome/browser/tab_contents/tab_specific_content_settings.cc:174: void TabSpecificContentSettings::ClearBlockedContentSettings() {\n also clear resources?","disapproval":false,"date":"2010-08-12 09:23:21.198848","approval":true},{"sender":"bauerb@chromium.org","recipients":["bauerb@chromium.org","jochen@chromium.org","brettw@chromium.org","pam@chromium.org","chromium-reviews@chromium.org","ben+cc@chromium.org","jrg@chromium.org","phajdan.jr@chromium.org","jam@chromium.org","darin-cc@chromium.org","brettw-cc@chromium.org","pam+watch@chromium.org"],"text":"re-routing to pam.\n\nhttp://codereview.chromium.org/2873104/diff/14001/15002\nFile base/file_path.h (right):\n\nhttp://codereview.chromium.org/2873104/diff/14001/15002#newcode296\nbase/file_path.h:296: static FilePath FromUTF8String(const std::string& string);\nOn 2010/08/12 09:23:21, jochen wrote:\n> nit. add a comment when to use and when to not use.\n\nDone. I also changed the name to FromString, because it's only using UTF8 when the native filename encoding is UTF8, or when converting from wstring (on Windows).\n\nhttp://codereview.chromium.org/2873104/diff/14001/15003\nFile chrome/app/generated_resources.grd (right):\n\nhttp://codereview.chromium.org/2873104/diff/14001/15003#newcode2380\nchrome/app/generated_resources.grd:2380: The following plug-ins were blocked on this page:\nOn 2010/08/12 09:23:21, jochen wrote:\n> strange text for a tooltip, esp with the colon at the end, maybe fork?\n\nDone. I just use IDS_BLOCKED_PLUGINS_MESSAGE for the tooltip.\n\nhttp://codereview.chromium.org/2873104/diff/14001/15008\nFile chrome/browser/cocoa/content_blocked_bubble_controller.mm (right):\n\nhttp://codereview.chromium.org/2873104/diff/14001/15008#newcode243\nchrome/browser/cocoa/content_blocked_bubble_controller.mm:243: it != plugins.end(); ++it) {\nOn 2010/08/12 09:23:21, jochen wrote:\n> nit. one more space\n\nDone.\n\nhttp://codereview.chromium.org/2873104/diff/14001/15009\nFile chrome/browser/content_setting_bubble_model.cc (right):\n\nhttp://codereview.chromium.org/2873104/diff/14001/15009#newcode44\nchrome/browser/content_setting_bubble_model.cc:44: it != resources.end(); ++it) {\nOn 2010/08/12 09:23:21, jochen wrote:\n> nit. one more space\n\nDone.\n\nhttp://codereview.chromium.org/2873104/diff/14001/15009#newcode60\nchrome/browser/content_setting_bubble_model.cc:60: 0,  // No resource-specific content settings for cookies.\nOn 2010/08/12 09:23:21, jochen wrote:\n> nit. i don't think you need all these comments\n\nOK, done.\n\nhttp://codereview.chromium.org/2873104/diff/14001/15009#newcode199\nchrome/browser/content_setting_bubble_model.cc:199: 0,  // We don't manage cookies here.\nOn 2010/08/12 09:23:21, jochen wrote:\n> nit. i don't think you need all of these comments\n\nDone.\n\nhttp://codereview.chromium.org/2873104/diff/14001/15009#newcode245\nchrome/browser/content_setting_bubble_model.cc:245: content_type(), *it);\nOn 2010/08/12 09:23:21, jochen wrote:\n> nit. put all parameters in one line with 4 space indent\n\nDone.\n\nhttp://codereview.chromium.org/2873104/diff/14001/15009#newcode256\nchrome/browser/content_setting_bubble_model.cc:256: const std::string& resource_identifier) {\nOn 2010/08/12 09:23:21, jochen wrote:\n> nit. Just AddException, because it's also used without a special resource\n\nDone.\n\nhttp://codereview.chromium.org/2873104/diff/14001/15023\nFile chrome/browser/tab_contents/tab_specific_content_settings.cc (right):\n\nhttp://codereview.chromium.org/2873104/diff/14001/15023#newcode174\nchrome/browser/tab_contents/tab_specific_content_settings.cc:174: void TabSpecificContentSettings::ClearBlockedContentSettings() {\nOn 2010/08/12 09:23:21, jochen wrote:\n>  also clear resources?\n\nRight, done.","disapproval":false,"date":"2010-08-12 13:33:39.145362","approval":false},{"sender":"pam@chromium.org","recipients":["bauerb@chromium.org","jochen@chromium.org","brettw@chromium.org","pam@chromium.org","chromium-reviews@chromium.org","ben+cc@chromium.org","jrg@chromium.org","phajdan.jr@chromium.org","jam@chromium.org","darin-cc@chromium.org","brettw-cc@chromium.org","pam+watch@chromium.org"],"text":"Since this is a big patch and Jochen already reviewed most of it, I only looked at the files that changed since his review of patch set 6.\n\nLGTM with small comments, below, addressed. No need for re-review unless there's something you're not sure of.\n\n- Pam\n\nhttp://codereview.chromium.org/2873104/diff/8034/9009\nFile base/file_path.h (right):\n\nhttp://codereview.chromium.org/2873104/diff/8034/9009#newcode298\nbase/file_path.h:298: // directly takes a FilePath or a (deprecated) wstring, they're probably not\nThe bikeshed should be blue! How about \"...probably only useful for storage.\" Also, can you be more specific about \"storage\"? Is that storing in a database, in JSON, in user prefs (which is also JSON), any kind of serialization, none or all of the above?\n\nFinally, please add to the comment that it will use UTF8 when needed for the native encoding or wstrings.\n\nhttp://codereview.chromium.org/2873104/diff/8034/9010\nFile chrome/app/generated_resources.grd (right):\n\nhttp://codereview.chromium.org/2873104/diff/8034/9010#newcode2385\nchrome/app/generated_resources.grd:2385: <message name=\"IDS_BLOCKED_PLUGINS_UNBLOCK_UNSPECIFIC\" desc=\"Radio button choice to unblock a site from using plug-ins, displayed in bubble when a page tries to use plug-ins.\">\nMaybe _UNBLOCK_ALL?\n\nhttp://codereview.chromium.org/2873104/diff/8034/9015\nFile chrome/browser/cocoa/content_setting_bubble_cocoa.mm (right):\n\nhttp://codereview.chromium.org/2873104/diff/8034/9015#newcode247\nchrome/browser/cocoa/content_setting_bubble_cocoa.mm:247: &plugin)) {\nThis formatting is pretty hard to read. Consider breaking it at the ->\n\nhttp://codereview.chromium.org/2873104/diff/8034/9016\nFile chrome/browser/content_setting_bubble_model.cc (right):\n\nhttp://codereview.chromium.org/2873104/diff/8034/9016#newcode60\nchrome/browser/content_setting_bubble_model.cc:60: 0,\nPerhaps a single comment, something like\n// Fields as for kBlockedTitleIDs, above.\n\nhttp://codereview.chromium.org/2873104/diff/8034/9016#newcode199\nchrome/browser/content_setting_bubble_model.cc:199: 0,\nSame here, a comment-reference would be both helpful and sufficient.","disapproval":false,"date":"2010-08-12 14:33:41.275634","approval":true}],"owner_email":"bauerb@chromium.org","private":false,"base_url":"ssh://toughcitysushi.muc/usr/local/google/home/eisinger/chrome/trunk/src","owner":"Bernhard Bauer","subject":"Allow per-plugin content settings.","created":"2010-08-06 11:12:20.758218","patchsets":[1,2001,4022,7001,10001,14001,8034,39002,20002,55001],"modified":"2011-05-24 13:20:20.287800","closed":true,"commit":false,"issue":2873104}
{"description":"Add dependency on allocator.gyp from 'base' and export it\r\n\r\nThis is so that other targets don't have to depend on allocator.gyp\r\nthemselves if they only depend on it via base.\r\n\r\nAdd explicit dependency on allocator.gyp from base_unittests.\r\n\r\nAdd 'toolsets' property to 'allocator' target (for ChromeOS builds).\r\n\r\nBUG=162998\r\n\r\nCommitted: https://src.chromium.org/viewvc/chrome?view=rev&revision=170287","cc":["chromium-reviews@chromium.org","erikwright+watch@chromium.org"],"reviewers":["mark@chromium.org","willchan@chromium.org","jar@chromium.org"],"messages":[{"sender":"akalin@chromium.org","recipients":["akalin@chromium.org","mark@chromium.org","chromium-reviews@chromium.org","erikwright+watch@chromium.org"],"text":"+mark for review\n\n(Our exchange on the other CL prompted me to give this another try -- this time, incrementally.)","disapproval":false,"date":"2012-11-28 22:26:35.680340","approval":false},{"sender":"mark@chromium.org","recipients":["akalin@chromium.org","mark@chromium.org","chromium-reviews@chromium.org","erikwright+watch@chromium.org"],"text":"LGTM","disapproval":false,"date":"2012-11-28 22:27:19.824750","approval":true},{"sender":"commit-bot@chromium.org","recipients":["akalin@chromium.org","mark@chromium.org","chromium-reviews@chromium.org","erikwright+watch@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/akalin@chromium.org/11411243/1","disapproval":false,"date":"2012-11-29 19:22:22.800150","approval":false},{"sender":"commit-bot@chromium.org","recipients":["akalin@chromium.org","mark@chromium.org","chromium-reviews@chromium.org","erikwright+watch@chromium.org"],"text":"Sorry for I got bad news for ya.\nCompile failed with a clobber build on ios_rel_device.\nhttp://build.chromium.org/p/tryserver.chromium/buildstatus?builder=ios_rel_device&number=10221\nYour code is likely broken or HEAD is junk. Please ensure your\ncode is not broken then alert the build sheriffs.\nLook at the try server FAQ for more details.","disapproval":false,"date":"2012-11-29 19:28:42.802700","approval":false},{"sender":"akalin@chromium.org","recipients":["akalin@chromium.org","mark@chromium.org","chromium-reviews@chromium.org","erikwright+watch@chromium.org"],"text":"Looks like I had to move that condition inside a use_glib==1 condition. (I guess linux_use_tcmalloc is set even on non-linux platforms.)","disapproval":false,"date":"2012-11-29 19:42:03.150780","approval":false},{"sender":"commit-bot@chromium.org","recipients":["akalin@chromium.org","mark@chromium.org","chromium-reviews@chromium.org","erikwright+watch@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/akalin@chromium.org/11411243/12001","disapproval":false,"date":"2012-11-29 19:44:22.274990","approval":false},{"sender":"commit-bot@chromium.org","recipients":["akalin@chromium.org","mark@chromium.org","chromium-reviews@chromium.org","erikwright+watch@chromium.org"],"text":"Retried try job too often on linux_chromeos for step(s) aura_unittests, base_unittests, browser_tests, cacheinvalidation_unittests, check_deps, chromeos_unittests, content_browsertests, content_unittests, crypto_unittests, dbus_unittests, device_unittests, gpu_unittests, interactive_ui_tests, ipc_tests, jingle_unittests, media_unittests, net_unittests, ppapi_unittests, printing_unittests, sandbox_linux_unittests, sql_unittests, sync_unit_tests, unit_tests","disapproval":false,"date":"2012-11-29 21:20:07.958530","approval":false},{"sender":"akalin@chromium.org","recipients":["akalin@chromium.org","mark@chromium.org","chromium-reviews@chromium.org","erikwright+watch@chromium.org"],"text":"Looks like I need to add:\n\n'toolsets': ['host', 'target']\n\nto the 'allocator' target to get the linux_chromeos build to work.\n\nLet me know if I shouldn't do that.","disapproval":false,"date":"2012-11-29 22:37:36.400620","approval":false},{"sender":"commit-bot@chromium.org","recipients":["akalin@chromium.org","mark@chromium.org","chromium-reviews@chromium.org","erikwright+watch@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/akalin@chromium.org/11411243/9004","disapproval":false,"date":"2012-11-29 22:52:42.712760","approval":false},{"sender":"akalin@chromium.org","recipients":["akalin@chromium.org","mark@chromium.org","willchan@chromium.org","jar@chromium.org","chromium-reviews@chromium.org","erikwright+watch@chromium.org"],"text":"+willchan, +jar for review (suggested by rsleevi):\n\n < rsleevi_cloud> akalin: I'd suggest touching base with one of them, \n                         yeah. They have more of the history mapped in as to \n                         why it was setup that way. I *thought* that the goal \n                         was that allocator.gyp should *only* be dependeded on \n                         by the final executable (on Linux), due to how \n                         malloc_hooks work. I don't remember the dealio though\n\nTo provide some background, my intention is to make the 'base' target export its allocator dependency so that the final executables didn't have to directly depend on it themselves.  Is that the wrong thing to do?","disapproval":false,"date":"2012-11-30 01:17:57.757060","approval":false},{"sender":"akalin@chromium.org","recipients":["akalin@chromium.org","mark@chromium.org","willchan@chromium.org","jar@chromium.org","chromium-reviews@chromium.org","erikwright+watch@chromium.org"],"text":"I think the addition of the toolset line was what broke the 32-bit linux buildbot, so I reverted it.  It shouldn't be pulled in now, anyway, since the dep is now behind linux_use_heapchecker.","disapproval":false,"date":"2012-11-30 02:41:32.763410","approval":false},{"sender":"akalin@chromium.org","recipients":[],"text":"Okay, that's good to know.  I'll abandon this CL and instead write one to\r\nadd comments in various places to make this policy clear.\r\n\r\n\r\nOn Fri, Nov 30, 2012 at 12:38 AM, William Chan (陈智昌)\r\n<willchan@chromium.org>wrote:\r\n\r\n> Only final executables should depend on the allocator target. The reason\r\n> is that a library should not decide what allocator the application uses,\r\n> only the application (the final executable) knows what allocator makes\r\n> sense.\r\n>\r\n>\r\n> On Thu, Nov 29, 2012 at 4:41 PM, <akalin@chromium.org> wrote:\r\n>\r\n>> I think the addition of the toolset line was what broke the 32-bit linux\r\n>> buildbot, so I reverted it.  It shouldn't be pulled in now, anyway, since\r\n>> the\r\n>> dep is now behind linux_use_heapchecker.\r\n>>\r\n>> https://codereview.chromium.**org/11411243/<https://codereview.chromium.org/11411243/>\r\n>>\r\n>\r\n>\r\n","disapproval":false,"date":"2012-12-04 17:08:33.391890","approval":false}],"owner_email":"akalin@chromium.org","private":false,"base_url":"svn://svn.chromium.org/chrome/trunk/src","owner":"akalin","subject":"Add dependency on allocator.gyp from 'base' and export it","created":"2012-11-28 22:21:57.501520","patchsets":[1,12001,9004,8008,14002],"modified":"2012-12-05 23:37:35.271940","closed":true,"commit":false,"issue":11411243}
{"description":"Implement IBusDaemonController.\n\nMost of part is copied from IBusController in chrome/browser/chromeos/input_method.\nThe difference is IBusDaemonController now requires UI/FILE thread task runner instead of direct posting task to BrowserThread.\n\nBUG=170671\nTEST=None\n\nCommitted: https://src.chromium.org/viewvc/chrome?view=rev&revision=185689","cc":["chromium-reviews@chromium.org","stevenjb+watch@chromium.org","oshima+watch@chromium.org"],"reviewers":["satorux@chromium.org"],"messages":[{"sender":"nona@chromium.org","recipients":["nona@chromium.org","satorux@chromium.org","chromium-reviews@chromium.org","stevenjb+watch@chromium.org","oshima+watch@chromium.org"],"text":"","disapproval":false,"date":"2013-01-21 14:00:52.108720","approval":false},{"sender":"satorux@chromium.org","recipients":["nona@chromium.org","satorux@chromium.org","chromium-reviews@chromium.org","stevenjb+watch@chromium.org","oshima+watch@chromium.org"],"text":"https://codereview.chromium.org/12045007/diff/6001/chromeos/ime/ibus_daemon_controller.cc\nFile chromeos/ime/ibus_daemon_controller.cc (right):\n\nhttps://codereview.chromium.org/12045007/diff/6001/chromeos/ime/ibus_daemon_controller.cc#newcode7\nchromeos/ime/ibus_daemon_controller.cc:7: #include <gio/gio.h>  // GAsyncResult and related types.\nwhoa. This is very uncool!\n\nHow hard would it be to add the necessary feature to 'base' so you don't need to use this? \n\nAlternatively, you could add the necessary feature in this file for now, and move it to 'base' later.\n\nEither way, please avoid using gio.","disapproval":false,"date":"2013-01-22 17:24:06.740130","approval":false},{"sender":"satorux@chromium.org","recipients":["nona@chromium.org","satorux@chromium.org","chromium-reviews@chromium.org","stevenjb+watch@chromium.org","oshima+watch@chromium.org"],"text":"ping","disapproval":false,"date":"2013-01-29 05:16:51.654550","approval":false},{"sender":"nona@chromium.org","recipients":["nona@chromium.org","satorux@chromium.org","chromium-reviews@chromium.org","stevenjb+watch@chromium.org","oshima+watch@chromium.org"],"text":"https://codereview.chromium.org/12045007/diff/6001/chromeos/ime/ibus_daemon_controller.cc\nFile chromeos/ime/ibus_daemon_controller.cc (right):\n\nhttps://codereview.chromium.org/12045007/diff/6001/chromeos/ime/ibus_daemon_controller.cc#newcode7\nchromeos/ime/ibus_daemon_controller.cc:7: #include <gio/gio.h>  // GAsyncResult and related types.\nSure, but please wait a while.\nI will ping you again after new implementation is ready.\n\nThank you.\nOn 2013/01/22 17:24:06, satorux1 wrote:\n> whoa. This is very uncool!\n> \n> How hard would it be to add the necessary feature to 'base' so you don't need to\n> use this? \n> \n> Alternatively, you could add the necessary feature in this file for now, and\n> move it to 'base' later.\n> \n> Either way, please avoid using gio.","disapproval":false,"date":"2013-01-29 06:53:35.165080","approval":false},{"sender":"nona@chromium.org","recipients":["nona@chromium.org","satorux@chromium.org","chromium-reviews@chromium.org","stevenjb+watch@chromium.org","oshima+watch@chromium.org"],"text":"Sorry for late response, but I uploaded latest patch.\nCould you take a look?\n\nThank you.\nSeigo","disapproval":false,"date":"2013-02-27 09:24:12.025450","approval":false},{"sender":"satorux@chromium.org","recipients":["nona@chromium.org","satorux@chromium.org","chromium-reviews@chromium.org","stevenjb+watch@chromium.org","oshima+watch@chromium.org"],"text":"https://codereview.chromium.org/12045007/diff/19001/chromeos/ime/ibus_daemon_controller.cc\nFile chromeos/ime/ibus_daemon_controller.cc (right):\n\nhttps://codereview.chromium.org/12045007/diff/19001/chromeos/ime/ibus_daemon_controller.cc#newcode112\nchromeos/ime/ibus_daemon_controller.cc:112: NOTREACHED() << \"Currently we can't support dynamical shutdown.\"\n\"Termination of ibus-daemon is not supported\"\n\nhttps://codereview.chromium.org/12045007/diff/19001/chromeos/ime/ibus_daemon_controller.cc#newcode177\nchromeos/ime/ibus_daemon_controller.cc:177: base::SplitString(command_line, ' ', &argv);\nThis is a bit worrisome. I think LaunchProcess() should take std::vector<std::string> instead of std::string\n\nhttps://codereview.chromium.org/12045007/diff/19001/chromeos/ime/ibus_daemon_controller.cc#newcode272\nchromeos/ime/ibus_daemon_controller.cc:272: base::WeakPtrFactory<IBusDaemonControllerImpl> weak_ptr_factory_;\nPlace this member at the end.\n\nhttps://codereview.chromium.org/12045007/diff/19001/chromeos/ime/ibus_daemon_controller.cc#newcode309\nchromeos/ime/ibus_daemon_controller.cc:309: CHECK(g_ibus_daemon_controller == NULL)\nDCHECK\n\nhttps://codereview.chromium.org/12045007/diff/19001/chromeos/ime/ibus_daemon_controller.cc#newcode323\nchromeos/ime/ibus_daemon_controller.cc:323: CHECK(controller_);\nditto","disapproval":false,"date":"2013-03-01 05:35:27.966390","approval":false},{"sender":"nona@chromium.org","recipients":["nona@chromium.org","satorux@chromium.org","chromium-reviews@chromium.org","stevenjb+watch@chromium.org","oshima+watch@chromium.org"],"text":"https://codereview.chromium.org/12045007/diff/19001/chromeos/ime/ibus_daemon_controller.cc\nFile chromeos/ime/ibus_daemon_controller.cc (right):\n\nhttps://codereview.chromium.org/12045007/diff/19001/chromeos/ime/ibus_daemon_controller.cc#newcode112\nchromeos/ime/ibus_daemon_controller.cc:112: NOTREACHED() << \"Currently we can't support dynamical shutdown.\"\nOn 2013/03/01 05:35:28, satorux1 wrote:\n> \"Termination of ibus-daemon is not supported\"\n\nDone.\n\nhttps://codereview.chromium.org/12045007/diff/19001/chromeos/ime/ibus_daemon_controller.cc#newcode177\nchromeos/ime/ibus_daemon_controller.cc:177: base::SplitString(command_line, ' ', &argv);\nUnfortunately it accepts string16 only in Windows.\n\nOn 2013/03/01 05:35:28, satorux1 wrote:\n> This is a bit worrisome. I think LaunchProcess() should take\n> std::vector<std::string> instead of std::string\n\nhttps://codereview.chromium.org/12045007/diff/19001/chromeos/ime/ibus_daemon_controller.cc#newcode272\nchromeos/ime/ibus_daemon_controller.cc:272: base::WeakPtrFactory<IBusDaemonControllerImpl> weak_ptr_factory_;\nOn 2013/03/01 05:35:28, satorux1 wrote:\n> Place this member at the end.\n\nDone.\n\nhttps://codereview.chromium.org/12045007/diff/19001/chromeos/ime/ibus_daemon_controller.cc#newcode309\nchromeos/ime/ibus_daemon_controller.cc:309: CHECK(g_ibus_daemon_controller == NULL)\nOn 2013/03/01 05:35:28, satorux1 wrote:\n> DCHECK\n\nDone.\n\nhttps://codereview.chromium.org/12045007/diff/19001/chromeos/ime/ibus_daemon_controller.cc#newcode323\nchromeos/ime/ibus_daemon_controller.cc:323: CHECK(controller_);\nOn 2013/03/01 05:35:28, satorux1 wrote:\n> ditto\n\nDone.","disapproval":false,"date":"2013-03-01 07:19:16.585170","approval":false},{"sender":"satorux@chromium.org","recipients":["nona@chromium.org","satorux@chromium.org","chromium-reviews@chromium.org","stevenjb+watch@chromium.org","oshima+watch@chromium.org"],"text":"https://codereview.chromium.org/12045007/diff/19001/chromeos/ime/ibus_daemon_controller.cc\nFile chromeos/ime/ibus_daemon_controller.cc (right):\n\nhttps://codereview.chromium.org/12045007/diff/19001/chromeos/ime/ibus_daemon_controller.cc#newcode177\nchromeos/ime/ibus_daemon_controller.cc:177: base::SplitString(command_line, ' ', &argv);\nOn 2013/03/01 07:19:16, Seigo Nonaka wrote:\n> Unfortunately it accepts string16 only in Windows.\n> \n> On 2013/03/01 05:35:28, satorux1 wrote:\n> > This is a bit worrisome. I think LaunchProcess() should take\n> > std::vector<std::string> instead of std::string\n> \n\nI think you misunderstood my comment. Splitting command line by white space is a bad idea. This function should take a vector of strings instead.\n\nBesides, this function seems to be only used from LaunchIBusDaemon(). I'd suggest to remove this function and use base::LaunchProcess() from LaunchIBusDaemon()","disapproval":false,"date":"2013-03-01 08:29:50.979510","approval":false},{"sender":"nona@chromium.org","recipients":["nona@chromium.org","satorux@chromium.org","chromium-reviews@chromium.org","stevenjb+watch@chromium.org","oshima+watch@chromium.org"],"text":"https://codereview.chromium.org/12045007/diff/19001/chromeos/ime/ibus_daemon_controller.cc\nFile chromeos/ime/ibus_daemon_controller.cc (right):\n\nhttps://codereview.chromium.org/12045007/diff/19001/chromeos/ime/ibus_daemon_controller.cc#newcode177\nchromeos/ime/ibus_daemon_controller.cc:177: base::SplitString(command_line, ' ', &argv);\nAh, sorry for my misunderstanding.\nI updated to use LaunchProcess directly.\n\nThank you.\n\nOn 2013/03/01 08:29:51, satorux1 wrote:\n> On 2013/03/01 07:19:16, Seigo Nonaka wrote:\n> > Unfortunately it accepts string16 only in Windows.\n> > \n> > On 2013/03/01 05:35:28, satorux1 wrote:\n> > > This is a bit worrisome. I think LaunchProcess() should take\n> > > std::vector<std::string> instead of std::string\n> > \n> \n> I think you misunderstood my comment. Splitting command line by white space is a\n> bad idea. This function should take a vector of strings instead.\n> \n> Besides, this function seems to be only used from LaunchIBusDaemon(). I'd\n> suggest to remove this function and use base::LaunchProcess() from\n> LaunchIBusDaemon()","disapproval":false,"date":"2013-03-01 09:22:28.430770","approval":false},{"sender":"satorux@chromium.org","recipients":["nona@chromium.org","satorux@chromium.org","chromium-reviews@chromium.org","stevenjb+watch@chromium.org","oshima+watch@chromium.org"],"text":"LGTM with a nit\n\nhttps://codereview.chromium.org/12045007/diff/31001/chromeos/ime/ibus_daemon_controller.cc\nFile chromeos/ime/ibus_daemon_controller.cc (right):\n\nhttps://codereview.chromium.org/12045007/diff/31001/chromeos/ime/ibus_daemon_controller.cc#newcode171\nchromeos/ime/ibus_daemon_controller.cc:171: DVLOG(1) << \"Could not launch: \"\nThis should probably be LOG(WARNING) ?","disapproval":false,"date":"2013-03-01 10:04:31.260740","approval":true},{"sender":"nona@chromium.org","recipients":["nona@chromium.org","satorux@chromium.org","chromium-reviews@chromium.org","stevenjb+watch@chromium.org","oshima+watch@chromium.org"],"text":"https://chromiumcodereview.appspot.com/12045007/diff/31001/chromeos/ime/ibus_daemon_controller.cc\nFile chromeos/ime/ibus_daemon_controller.cc (right):\n\nhttps://chromiumcodereview.appspot.com/12045007/diff/31001/chromeos/ime/ibus_daemon_controller.cc#newcode171\nchromeos/ime/ibus_daemon_controller.cc:171: DVLOG(1) << \"Could not launch: \"\nOn 2013/03/01 10:04:31, satorux1 wrote:\n> This should probably be LOG(WARNING) ?\n\nDone.","disapproval":false,"date":"2013-03-01 10:29:16.111480","approval":false},{"sender":"commit-bot@chromium.org","recipients":["nona@chromium.org","satorux@chromium.org","chromium-reviews@chromium.org","stevenjb+watch@chromium.org","oshima+watch@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/nona@chromium.org/12045007/22002","disapproval":false,"date":"2013-03-01 15:45:08.794830","approval":false},{"sender":"commit-bot@chromium.org","recipients":["nona@chromium.org","satorux@chromium.org","chromium-reviews@chromium.org","stevenjb+watch@chromium.org","oshima+watch@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/nona@chromium.org/12045007/22002","disapproval":false,"date":"2013-03-02 05:04:39.420560","approval":false},{"sender":"commit-bot@chromium.org","recipients":["nona@chromium.org","satorux@chromium.org","chromium-reviews@chromium.org","stevenjb+watch@chromium.org","oshima+watch@chromium.org"],"text":"Change committed as 185689","disapproval":false,"date":"2013-03-02 05:58:40.834390","approval":false}],"owner_email":"nona@chromium.org","private":false,"base_url":"svn://svn.chromium.org/chrome/trunk/src","owner":"Seigo Nonaka","subject":"Implement IBusDaemonController.","created":"2013-01-21 13:53:43.143530","patchsets":[3,6001,16001,19001,24001,31001,22002],"modified":"2013-03-02 05:58:41.009660","closed":true,"commit":false,"issue":12045007}
{"description":"Implement Ctrl+ESC to disconnect (Linux).\n\nBUG=\nTEST=\n\nCommitted: http://src.chromium.org/viewvc/chrome?view=rev&revision=93260","cc":["chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","hclam+watch@chromium.org","simonmorris+watch@chromium.org","wez+watch@chromium.org","dmaclach+watch@chromium.org","garykac+watch@chromium.org","lambroslambrou+watch@chromium.org","ajwong+watch@chromium.org","sergeyu+watch@chromium.org"],"reviewers":["lambroslambrou@chromium.org","sergeyu@chromium.org"],"messages":[{"sender":"jamiewalch@chromium.org","recipients":["jamiewalch@chromium.org","lambroslambrou@chromium.org","chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","hclam+watch@chromium.org","simonmorris+watch@chromium.org","wez+watch@chromium.org","dmaclach+watch@chromium.org","garykac+watch@chromium.org","lambroslambrou+watch@chromium.org","ajwong+watch@chromium.org","sergeyu+watch@chromium.org"],"text":"","disapproval":false,"date":"2011-07-20 01:20:55.221226","approval":false},{"sender":"lambroslambrou@chromium.org","recipients":["jamiewalch@chromium.org","lambroslambrou@chromium.org","chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","hclam+watch@chromium.org","simonmorris+watch@chromium.org","wez+watch@chromium.org","dmaclach+watch@chromium.org","garykac+watch@chromium.org","lambroslambrou+watch@chromium.org","ajwong+watch@chromium.org","sergeyu+watch@chromium.org"],"text":"LGTM with nits.\n\nhttp://codereview.chromium.org/7453015/diff/1/remoting/host/disconnect_window.cc\nFile remoting/host/disconnect_window.cc (right):\n\nhttp://codereview.chromium.org/7453015/diff/1/remoting/host/disconnect_window.cc#newcode11\nremoting/host/disconnect_window.cc:11: const char DisconnectWindow::kDisconnectButton[] = \"Disconnect (Ctrl+ESC)\";\nnit: Ctrl+Esc or CTRL+ESC ?\n\nhttp://codereview.chromium.org/7453015/diff/1/remoting/host/local_input_monitor_thread_linux.cc\nFile remoting/host/local_input_monitor_thread_linux.cc (right):\n\nhttp://codereview.chromium.org/7453015/diff/1/remoting/host/local_input_monitor_thread_linux.cc#newcode5\nremoting/host/local_input_monitor_thread_linux.cc:5: #include \"remoting/host/chromoting_host.h\"\nnit: This project header should come after the library headers.\n\nhttp://codereview.chromium.org/7453015/diff/1/remoting/host/local_input_monitor_thread_linux.cc#newcode120\nremoting/host/local_input_monitor_thread_linux.cc:120: sizeof(scoper.range)/sizeof(*scoper.range));\nnit: Use arraysize() or ARRAYSIZE_UNSAFE() from <base/basictypes.h>\n\nhttp://codereview.chromium.org/7453015/diff/1/remoting/host/local_input_monitor_thread_linux.cc#newcode160\nremoting/host/local_input_monitor_thread_linux.cc:160: int key_sym = XKeycodeToKeysym(display_, key_code, 0);\nnit: s/int/KeySym ?\n\nhttp://codereview.chromium.org/7453015/diff/1/remoting/host/local_input_monitor_thread_linux.h\nFile remoting/host/local_input_monitor_thread_linux.h (right):\n\nhttp://codereview.chromium.org/7453015/diff/1/remoting/host/local_input_monitor_thread_linux.h#newcode11\nremoting/host/local_input_monitor_thread_linux.h:11: #include <X11/Xlib.h>\nnit: Move this library header before our project's headers?\n\nhttp://codereview.chromium.org/7453015/diff/1/remoting/host/local_input_monitor_thread_linux.h#newcode26\nremoting/host/local_input_monitor_thread_linux.h:26: void LocalKeyPressed(int key_code, bool down);\nnit: s/int/KeyCode (and in .cc file) ?","disapproval":false,"date":"2011-07-20 02:40:26.860492","approval":true},{"sender":"jamiewalch@chromium.org","recipients":["jamiewalch@chromium.org","lambroslambrou@chromium.org","chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","hclam+watch@chromium.org","simonmorris+watch@chromium.org","wez+watch@chromium.org","dmaclach+watch@chromium.org","garykac+watch@chromium.org","lambroslambrou+watch@chromium.org","ajwong+watch@chromium.org","sergeyu+watch@chromium.org"],"text":"http://codereview.chromium.org/7453015/diff/1/remoting/host/disconnect_window.cc\nFile remoting/host/disconnect_window.cc (right):\n\nhttp://codereview.chromium.org/7453015/diff/1/remoting/host/disconnect_window.cc#newcode11\nremoting/host/disconnect_window.cc:11: const char DisconnectWindow::kDisconnectButton[] = \"Disconnect (Ctrl+ESC)\";\nOn 2011/07/20 02:40:27, Lambros wrote:\n> nit: Ctrl+Esc or CTRL+ESC ?\n\nKen specifically capitalised ESC, but having run it by him, he's changed it (and made it Shift+Esc to avoid conflicts on Windows).\n\nhttp://codereview.chromium.org/7453015/diff/1/remoting/host/local_input_monitor_thread_linux.cc\nFile remoting/host/local_input_monitor_thread_linux.cc (right):\n\nhttp://codereview.chromium.org/7453015/diff/1/remoting/host/local_input_monitor_thread_linux.cc#newcode5\nremoting/host/local_input_monitor_thread_linux.cc:5: #include \"remoting/host/chromoting_host.h\"\nOn 2011/07/20 02:40:27, Lambros wrote:\n> nit: This project header should come after the library headers.\n\nThat causes conflicts due to the inclusion of Xlib (for Display) in the header file.\n\nhttp://codereview.chromium.org/7453015/diff/1/remoting/host/local_input_monitor_thread_linux.cc#newcode120\nremoting/host/local_input_monitor_thread_linux.cc:120: sizeof(scoper.range)/sizeof(*scoper.range));\nOn 2011/07/20 02:40:27, Lambros wrote:\n> nit: Use arraysize() or ARRAYSIZE_UNSAFE() from <base/basictypes.h>\n\nDone.\n\nhttp://codereview.chromium.org/7453015/diff/1/remoting/host/local_input_monitor_thread_linux.cc#newcode160\nremoting/host/local_input_monitor_thread_linux.cc:160: int key_sym = XKeycodeToKeysym(display_, key_code, 0);\nOn 2011/07/20 02:40:27, Lambros wrote:\n> nit: s/int/KeySym ?\n\nDone.\n\nhttp://codereview.chromium.org/7453015/diff/1/remoting/host/local_input_monitor_thread_linux.h\nFile remoting/host/local_input_monitor_thread_linux.h (right):\n\nhttp://codereview.chromium.org/7453015/diff/1/remoting/host/local_input_monitor_thread_linux.h#newcode11\nremoting/host/local_input_monitor_thread_linux.h:11: #include <X11/Xlib.h>\nOn 2011/07/20 02:40:27, Lambros wrote:\n> nit: Move this library header before our project's headers?\n\nI know this is against the style guide, but Xlib defines a whole bunch of symbols that might conflict. I think at the moment there aren't any conflicts with these includes, but I didn't want to risk future breakages.\n\nhttp://codereview.chromium.org/7453015/diff/1/remoting/host/local_input_monitor_thread_linux.h#newcode26\nremoting/host/local_input_monitor_thread_linux.h:26: void LocalKeyPressed(int key_code, bool down);\nOn 2011/07/20 02:40:27, Lambros wrote:\n> nit: s/int/KeyCode (and in .cc file) ?\n\nDone.","disapproval":false,"date":"2011-07-20 17:44:53.977670","approval":false},{"sender":"lambroslambrou@chromium.org","recipients":["jamiewalch@chromium.org","lambroslambrou@chromium.org","chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","hclam+watch@chromium.org","simonmorris+watch@chromium.org","wez+watch@chromium.org","dmaclach+watch@chromium.org","garykac+watch@chromium.org","lambroslambrou+watch@chromium.org","ajwong+watch@chromium.org","sergeyu+watch@chromium.org"],"text":"http://codereview.chromium.org/7453015/diff/1/remoting/host/local_input_monitor_thread_linux.cc\nFile remoting/host/local_input_monitor_thread_linux.cc (right):\n\nhttp://codereview.chromium.org/7453015/diff/1/remoting/host/local_input_monitor_thread_linux.cc#newcode5\nremoting/host/local_input_monitor_thread_linux.cc:5: #include \"remoting/host/chromoting_host.h\"\nOn 2011/07/20 17:44:54, Jamie wrote:\n> On 2011/07/20 02:40:27, Lambros wrote:\n> > nit: This project header should come after the library headers.\n> \n> That causes conflicts due to the inclusion of Xlib (for Display) in the header\n> file.\nIn that case, please could you add a comment before it, and a blank line after it?  It would be good if the comment could explain the source of the conflict, and add a TODO to fix this.\nIf we're having to re-order our project headers to work around Xlib issues, then we've already exposed too much of Xlib in our headers.  I can maybe look into this if I find time.\n\nhttp://codereview.chromium.org/7453015/diff/1/remoting/host/local_input_monitor_thread_linux.h\nFile remoting/host/local_input_monitor_thread_linux.h (right):\n\nhttp://codereview.chromium.org/7453015/diff/1/remoting/host/local_input_monitor_thread_linux.h#newcode11\nremoting/host/local_input_monitor_thread_linux.h:11: #include <X11/Xlib.h>\nOn 2011/07/20 17:44:54, Jamie wrote:\n> On 2011/07/20 02:40:27, Lambros wrote:\n> > nit: Move this library header before our project's headers?\n> \n> I know this is against the style guide, but Xlib defines a whole bunch of\n> symbols that might conflict. I think at the moment there aren't any conflicts\n> with these includes, but I didn't want to risk future breakages.\nI'm not convinced this is a good enough reason to deviate from the style.  You're taking a bet that future conflicts are less likely with one ordering than with another ordering, and it's not clear to me why that's true.\n\nI'd prefer to stick with the style, but if you want to keep it this way, please add a comment explaining why.\n\nhttp://codereview.chromium.org/7453015/diff/8001/remoting/host/local_input_monitor_thread_linux.cc\nFile remoting/host/local_input_monitor_thread_linux.cc (right):\n\nhttp://codereview.chromium.org/7453015/diff/8001/remoting/host/local_input_monitor_thread_linux.cc#newcode16\nremoting/host/local_input_monitor_thread_linux.cc:16: #include \"base/basictypes.h\"\nSorry to be such a pain with these #include orderings! :)","disapproval":false,"date":"2011-07-20 18:43:47.770268","approval":false},{"sender":"sergeyu@chromium.org","recipients":["jamiewalch@chromium.org","lambroslambrou@chromium.org","sergeyu@chromium.org","chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","hclam+watch@chromium.org","simonmorris+watch@chromium.org","wez+watch@chromium.org","dmaclach+watch@chromium.org","garykac+watch@chromium.org","lambroslambrou+watch@chromium.org","ajwong+watch@chromium.org","sergeyu+watch@chromium.org"],"text":"Traditionally on Mac Command (Pretzel) key is used in shortcuts instead of Ctrl, so maybe we should use Command-Esc on Mac instead of Ctrl-Esc?","disapproval":false,"date":"2011-07-20 19:18:35.912358","approval":false},{"sender":"sergeyu@chromium.org","recipients":["jamiewalch@chromium.org","lambroslambrou@chromium.org","sergeyu@chromium.org","chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","hclam+watch@chromium.org","simonmorris+watch@chromium.org","wez+watch@chromium.org","dmaclach+watch@chromium.org","garykac+watch@chromium.org","lambroslambrou+watch@chromium.org","ajwong+watch@chromium.org","sergeyu+watch@chromium.org"],"text":"On 2011/07/20 19:18:35, sergeyu wrote:\n> Traditionally on Mac Command (Pretzel) key is used in shortcuts instead of Ctrl,\n> so maybe we should use Command-Esc on Mac instead of Ctrl-Esc?\n\nOh, never mind, I've just noticed your CL is linux only.","disapproval":false,"date":"2011-07-20 19:19:42.230717","approval":false},{"sender":"jamiewalch@chromium.org","recipients":["jamiewalch@chromium.org","lambroslambrou@chromium.org","sergeyu@chromium.org","chromium-reviews@chromium.org","jamiewalch+watch@chromium.org","hclam+watch@chromium.org","simonmorris+watch@chromium.org","wez+watch@chromium.org","dmaclach+watch@chromium.org","garykac+watch@chromium.org","lambroslambrou+watch@chromium.org","ajwong+watch@chromium.org","sergeyu+watch@chromium.org"],"text":"http://codereview.chromium.org/7453015/diff/1/remoting/host/local_input_monitor_thread_linux.cc\nFile remoting/host/local_input_monitor_thread_linux.cc (right):\n\nhttp://codereview.chromium.org/7453015/diff/1/remoting/host/local_input_monitor_thread_linux.cc#newcode5\nremoting/host/local_input_monitor_thread_linux.cc:5: #include \"remoting/host/chromoting_host.h\"\nOn 2011/07/20 18:43:47, Lambros wrote:\n> On 2011/07/20 17:44:54, Jamie wrote:\n> > On 2011/07/20 02:40:27, Lambros wrote:\n> > > nit: This project header should come after the library headers.\n> > \n> > That causes conflicts due to the inclusion of Xlib (for Display) in the header\n> > file.\n> In that case, please could you add a comment before it, and a blank line after\n> it?  It would be good if the comment could explain the source of the conflict,\n> and add a TODO to fix this.\n> If we're having to re-order our project headers to work around Xlib issues, then\n> we've already exposed too much of Xlib in our headers.  I can maybe look into\n> this if I find time.\n\nI'ved moved the offending X11 headers to the bottom of the include order and the header for this class no longer depends on Xlib.h.\n\nhttp://codereview.chromium.org/7453015/diff/1/remoting/host/local_input_monitor_thread_linux.h\nFile remoting/host/local_input_monitor_thread_linux.h (right):\n\nhttp://codereview.chromium.org/7453015/diff/1/remoting/host/local_input_monitor_thread_linux.h#newcode11\nremoting/host/local_input_monitor_thread_linux.h:11: #include <X11/Xlib.h>\nOn 2011/07/20 18:43:47, Lambros wrote:\n> On 2011/07/20 17:44:54, Jamie wrote:\n> > On 2011/07/20 02:40:27, Lambros wrote:\n> > > nit: Move this library header before our project's headers?\n> > \n> > I know this is against the style guide, but Xlib defines a whole bunch of\n> > symbols that might conflict. I think at the moment there aren't any conflicts\n> > with these includes, but I didn't want to risk future breakages.\n> I'm not convinced this is a good enough reason to deviate from the style. \n> You're taking a bet that future conflicts are less likely with one ordering than\n> with another ordering, and it's not clear to me why that's true.\n> \n> I'd prefer to stick with the style, but if you want to keep it this way, please\n> add a comment explaining why.\n\nI now pre-declare Display to around this, although note that it necessitated using int instead of KeyCode below.","disapproval":false,"date":"2011-07-20 20:31:37.073906","approval":false}],"owner_email":"jamiewalch@chromium.org","private":false,"base_url":"svn://svn.chromium.org/chrome/trunk/src","owner":"Jamie","subject":"Implement Ctrl+ESC to disconnect (Linux).","created":"2011-07-20 01:18:53.518909","patchsets":[1,6001,8001,7004],"modified":"2011-07-20 22:00:33.002827","closed":true,"commit":false,"issue":7453015}
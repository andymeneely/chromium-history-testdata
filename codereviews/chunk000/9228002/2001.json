{"files":{"chrome/renderer/resources/extensions/file_browser_private.js":{"status":"D","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":0,"num_removed":23,"messages":[],"id":25,"is_binary":false},"chrome/renderer/extensions/extension_dispatcher.cc":{"status":"M","num_chunks":2,"no_base_file":false,"property_changes":"","num_added":0,"num_removed":2,"messages":[],"id":32,"is_binary":false},"chrome/renderer/extensions/extension_custom_bindings.h":{"status":"A","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":32,"num_removed":0,"messages":[],"id":31,"is_binary":false},"chrome/renderer/extensions/custom_bindings_util.cc":{"status":"M","num_chunks":2,"no_base_file":false,"property_changes":"","num_added":16,"num_removed":1,"messages":[],"id":29,"is_binary":false},"chrome/renderer/extensions/file_browser_private_bindings.cc":{"status":"D","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":0,"num_removed":66,"messages":[],"id":23,"is_binary":false},"chrome/chrome_renderer.gypi":{"status":"M","num_chunks":4,"no_base_file":false,"property_changes":"","num_added":15,"num_removed":3,"messages":[],"id":26,"is_binary":false},"chrome/renderer/resources/extensions/file_browser_handler_custom_bindings.js":{"status":"A","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":27,"num_removed":0,"messages":[],"id":43,"is_binary":false},"chrome/renderer/extensions/file_browser_handler_custom_bindings.cc":{"status":"A +","num_chunks":3,"no_base_file":false,"property_changes":"","num_added":15,"num_removed":15,"messages":[],"id":33,"is_binary":false},"chrome/renderer/renderer_resources.grd":{"status":"M","num_chunks":2,"no_base_file":false,"property_changes":"","num_added":5,"num_removed":1,"messages":[],"id":40,"is_binary":false},"chrome/renderer/extensions/page_capture_custom_bindings.h":{"status":"A","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":27,"num_removed":0,"messages":[],"id":38,"is_binary":false},"chrome/renderer/extensions/chrome_private_custom_bindings.h":{"status":"A","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":33,"num_removed":0,"messages":[],"id":28,"is_binary":false},"chrome/renderer/resources/extensions/page_capture_custom_bindings.js":{"status":"A","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":34,"num_removed":0,"messages":[],"id":45,"is_binary":false},"chrome/renderer/extensions/file_browser_private_custom_bindings.h":{"status":"A","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":29,"num_removed":0,"messages":[],"id":36,"is_binary":false},"chrome/renderer/extensions/file_browser_handler_custom_bindings.h":{"status":"A","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":29,"num_removed":0,"messages":[],"id":34,"is_binary":false},"chrome/renderer/extensions/chrome_private_custom_bindings.cc":{"status":"A","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":109,"num_removed":0,"messages":[],"id":27,"is_binary":false},"chrome/renderer/resources/extensions/file_browser_private_custom_bindings.js":{"status":"A","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":30,"num_removed":0,"messages":[],"id":44,"is_binary":false},"chrome/renderer/resources/extensions/chrome_private_custom_bindings.js":{"status":"A","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":21,"num_removed":0,"messages":[],"id":41,"is_binary":false},"chrome/renderer/extensions/page_capture_custom_bindings.cc":{"status":"A","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":62,"num_removed":0,"messages":[],"id":37,"is_binary":false},"chrome/renderer/extensions/extension_custom_bindings.cc":{"status":"A","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":182,"num_removed":0,"messages":[],"id":30,"is_binary":false},"chrome/renderer/resources/extensions/schema_generated_bindings.js":{"status":"M","num_chunks":3,"no_base_file":false,"property_changes":"","num_added":0,"num_removed":66,"messages":[{"author":"Aaron Boodman","author_email":"aa@chromium.org","text":"It seems that the interaction between this code and custom bindings could be simplified if this class was only a set of hooks. Like:\n\nfunction FunctionHooks() {\n  this._functions = {};\n}\n\nFunctionHooks.prototype.setHook = function(fullyQualifiedFunctionName, hookName, hook) {\n  if (!this._functions[fullyQualifiedFunctionName])\n    this._functions[fullyQualifiedFunctionName] = {};\n\n  this._functions[fullyQualifiedFunctionName][hookName] = hook;\n}\n\nFunctionHooks.prototype.getHook = function(fqfn, hookName, args) {\n  return this._functions[fqfn] && this._functions[fqfn][hookName];\n}\n\nGetChromeHidden().functionHooks = new FunctionHooks();\n\n// In generated bindings\nvar hook = GetChromeHidden().functionHooks.getHook(functionName, 'customCallback');\nif (hook)\n  hook.apply(null, ...);\n\n\n// In foo_custom_bindings.js\nGetChromeHidden().functionHooks.setHook('foo.doMonkey', 'customCallback', function(a, b, c) {\n  ...\n});\n\nWDYT?","draft":false,"lineno":251,"date":"2012-01-16 09:12:44.504894","left":false},{"author":"Aaron Boodman","author_email":"aa@chromium.org","text":"What about something like chromeHidden.onBindingsGenerated?","draft":false,"lineno":306,"date":"2012-01-16 09:12:44.505203","left":false},{"author":"Aaron Boodman","author_email":"aa@chromium.org","text":"It's always been weird the way we pass extra parameters to the custom handlers through |this| here. Is it possible to make this just a normal function that gets things like functionDef and apiDef from its closure?\n\nI think this might mean that some extra things might need to get passed explicitly through the hook functions, but I think that would be much more clear.","draft":false,"lineno":554,"date":"2012-01-16 09:12:44.505488","left":false},{"author":"kalman","author_email":"kalman@chromium.org","text":"On 2012/01/16 09:12:44, Aaron Boodman wrote:\n> It seems that the interaction between this code and custom bindings could be\n> simplified if this class was only a set of hooks. Like:\n> \n> function FunctionHooks() {\n>   this._functions = {};\n> }\n> \n> FunctionHooks.prototype.setHook = function(fullyQualifiedFunctionName, hookName,\n> hook) {\n>   if (!this._functions[fullyQualifiedFunctionName])\n>     this._functions[fullyQualifiedFunctionName] = {};\n> \n>   this._functions[fullyQualifiedFunctionName][hookName] = hook;\n> }\n> \n> FunctionHooks.prototype.getHook = function(fqfn, hookName, args) {\n>   return this._functions[fqfn] && this._functions[fqfn][hookName];\n> }\n> \n> GetChromeHidden().functionHooks = new FunctionHooks();\n> \n> // In generated bindings\n> var hook = GetChromeHidden().functionHooks.getHook(functionName,\n> 'customCallback');\n> if (hook)\n>   hook.apply(null, ...);\n> \n> \n> // In foo_custom_bindings.js\n> GetChromeHidden().functionHooks.setHook('foo.doMonkey', 'customCallback',\n> function(a, b, c) {\n>   ...\n> });\n> \n> WDYT?\n\nYeah I'd planned on doing this, but doing it this way was easier at the time.  I agree it would be simpler, should do in a follow-up.","draft":false,"lineno":251,"date":"2012-01-16 14:20:36.120888","left":false},{"author":"kalman","author_email":"kalman@chromium.org","text":"On 2012/01/16 09:12:44, Aaron Boodman wrote:\n> What about something like chromeHidden.onBindingsGenerated?\n\nThe reason I used the name \"register...\" rather than an event is because you need to access the platform an API runs on (found this out the debugging way).  The way I did this was passing in the API name when you register, which looks up the API schema and compares the \"platform\" property to the current platform and all that.\n\nSo an event-like name looked slightly out of place, since it implies something like\n\nchromeHidden.onBindingsGenerated = new chrome.Event()\n\nwhich wouldn't work I think, since listeners can't give any context using addListener().\n\nI agree that hook isn't a particularly descriptive name though, definitely could be more useful.","draft":false,"lineno":306,"date":"2012-01-16 14:20:36.121176","left":false},{"author":"kalman","author_email":"kalman@chromium.org","text":"On 2012/01/16 09:12:44, Aaron Boodman wrote:\n> It's always been weird the way we pass extra parameters to the custom handlers\n> through |this| here. Is it possible to make this just a normal function that\n> gets things like functionDef and apiDef from its closure?\n> \n> I think this might mean that some extra things might need to get passed\n> explicitly through the hook functions, but I think that would be much more\n> clear.\n\nYeah, all this code is a bit haphazard. Fix up in a follow-up though..?","draft":false,"lineno":554,"date":"2012-01-16 14:20:36.121429","left":false}],"id":46,"is_binary":false},"chrome/renderer/extensions/file_browser_private_bindings.h":{"status":"D","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":0,"num_removed":23,"messages":[],"id":24,"is_binary":false},"chrome/renderer/extensions/file_browser_private_custom_bindings.cc":{"status":"A","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":52,"num_removed":0,"messages":[],"id":35,"is_binary":false},"chrome/renderer/extensions/schema_generated_bindings.cc":{"status":"M","num_chunks":7,"no_base_file":false,"property_changes":"","num_added":0,"num_removed":253,"messages":[],"id":39,"is_binary":false},"chrome/renderer/resources/extensions/extension_custom_bindings.js":{"status":"A","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":45,"num_removed":0,"messages":[],"id":42,"is_binary":false}},"owner_email":"kalman@chromium.org","owner":"kalman","message":".","try_job_results":[{"parent_name":null,"tests":[],"slave":"vm25-m4","url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=win&number=8486","timestamp":"2012-01-16 08:41:20.903375","builder":"win","clobber":null,"project":"Chromium Try Server","reason":"","result":"2","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIwCxIFSXNzdWUY4p2zBAwLEghQYXRjaFNldBjRDwwLEgxUcnlKb2JSZXN1bHQY8i4M","requester":null,"buildnumber":"8486","revision":"117825"},{"parent_name":null,"tests":[],"slave":"mini12-m4","url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=mac&number=7876","timestamp":"2012-01-16 08:28:50.468020","builder":"mac","clobber":null,"project":"Chromium Try Server","reason":"","result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIwCxIFSXNzdWUY4p2zBAwLEghQYXRjaFNldBjRDwwLEgxUcnlKb2JSZXN1bHQYoR8M","requester":null,"buildnumber":"7876","revision":"117815"},{"parent_name":null,"tests":[],"slave":"vm152-m4","url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=linux_chromeos&number=3828","timestamp":"2012-01-16 07:11:06.337937","builder":"linux_chromeos","clobber":null,"project":"Chromium Try Server","reason":"","result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIwCxIFSXNzdWUY4p2zBAwLEghQYXRjaFNldBjRDwwLEgxUcnlKb2JSZXN1bHQY8S4M","requester":null,"buildnumber":"3828","revision":"117815"},{"parent_name":null,"tests":[],"slave":"vm163-m4","url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=linux&number=8036","timestamp":"2012-01-16 07:04:56.004489","builder":"linux","clobber":null,"project":"Chromium Try Server","reason":"","result":"0","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIwCxIFSXNzdWUY4p2zBAwLEghQYXRjaFNldBjRDwwLEgxUcnlKb2JSZXN1bHQYuRcM","requester":null,"buildnumber":"8036","revision":"117815"},{"parent_name":null,"tests":[],"slave":"vm31-m4","url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=win&number=8485","timestamp":"2012-01-16 05:54:29.118692","builder":"win","clobber":null,"project":"Chromium Try Server","reason":"","result":"2","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIwCxIFSXNzdWUY4p2zBAwLEghQYXRjaFNldBjRDwwLEgxUcnlKb2JSZXN1bHQY2TYM","requester":null,"buildnumber":"8485","revision":"117815"},{"parent_name":null,"tests":[],"slave":"vm13-m4","url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=win&number=8484","timestamp":"2012-01-16 05:48:12.998835","builder":"win","clobber":null,"project":"Chromium Try Server","reason":"","result":"2","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIwCxIFSXNzdWUY4p2zBAwLEghQYXRjaFNldBjRDwwLEgxUcnlKb2JSZXN1bHQYiScM","requester":null,"buildnumber":"8484","revision":"117815"},{"parent_name":null,"tests":[],"slave":"vm67-m4","url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=linux_chromeos&number=3826","timestamp":"2012-01-16 05:41:15.741352","builder":"linux_chromeos","clobber":null,"project":"Chromium Try Server","reason":"","result":"2","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIwCxIFSXNzdWUY4p2zBAwLEghQYXRjaFNldBjRDwwLEgxUcnlKb2JSZXN1bHQY_gcM","requester":null,"buildnumber":"3826","revision":"117815"}],"created":"2012-01-16 04:51:10.260227","url":null,"num_comments":6,"modified":"2012-01-16 14:20:36.499999","patchset":2001,"issue":9228002}
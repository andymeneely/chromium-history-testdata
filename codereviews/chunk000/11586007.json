{"description":"* Update local instant to match online instant:\r\n  - Suggestion box/suggestion styling\r\n  - Arrowing through suggestions should loop\r\n* Fix bug where clicking a suggestion causes new native suggestions to load, instead of navigating.\r\n* Some JS cleanup.\r\n\r\n\r\n\r\nBUG=165794\n\nCommitted: https://src.chromium.org/viewvc/chrome?view=rev&revision=173594","cc":["chromium-reviews@chromium.org","arv@chromium.org","melevin@chromium.org","dhollowa@chromium.org","samarth@chromium.org","sreeram@chromium.org","gideonwald@chromium.org","dominich@chromium.org","shishir@chromium.org"],"reviewers":["estade@chromium.org","dcblack@chromium.org"],"messages":[{"sender":"jeremycho@chromium.org","recipients":["jeremycho@chromium.org","estade@chromium.org","dcblack@chromium.org","chromium-reviews@chromium.org","arv@chromium.org"],"text":"This is ready for review.  Thanks.","disapproval":false,"date":"2012-12-16 22:13:26.184770","approval":false},{"sender":"jeremycho@chromium.org","recipients":["jeremycho@chromium.org","estade@chromium.org","dcblack@chromium.org","chromium-reviews@chromium.org","arv@chromium.org","melevin@chromium.org","dhollowa@chromium.org","samarth@chromium.org","sreeram@chromium.org","gideonwald@chromium.org","dominich@chromium.org","shishir@chromium.org"],"text":"","disapproval":false,"date":"2012-12-16 22:16:05.245150","approval":false},{"sender":"estade@chromium.org","recipients":["jeremycho@chromium.org","estade@chromium.org","dcblack@chromium.org","chromium-reviews@chromium.org","arv@chromium.org","melevin@chromium.org","dhollowa@chromium.org","samarth@chromium.org","sreeram@chromium.org","gideonwald@chromium.org","dominich@chromium.org","shishir@chromium.org"],"text":"https://codereview.chromium.org/11586007/diff/1/chrome/browser/resources/local_omnibox_popup/local_omnibox_popup.css\nFile chrome/browser/resources/local_omnibox_popup/local_omnibox_popup.css (right):\n\nhttps://codereview.chromium.org/11586007/diff/1/chrome/browser/resources/local_omnibox_popup/local_omnibox_popup.css#newcode6\nchrome/browser/resources/local_omnibox_popup/local_omnibox_popup.css:6: background-color: #FFF;\ns/#FFF/white\n\nhttps://codereview.chromium.org/11586007/diff/1/chrome/browser/resources/local_omnibox_popup/local_omnibox_popup.html\nFile chrome/browser/resources/local_omnibox_popup/local_omnibox_popup.html (right):\n\nhttps://codereview.chromium.org/11586007/diff/1/chrome/browser/resources/local_omnibox_popup/local_omnibox_popup.html#newcode14\nchrome/browser/resources/local_omnibox_popup/local_omnibox_popup.html:14: <div id=\"suggestionsBoxContainer\"></div>\nIDs are supposed to-go-like-this\n\nhttp://dev.chromium.org/developers/web-development-style-guide\n\nhttps://codereview.chromium.org/11586007/diff/1/chrome/browser/resources/local_omnibox_popup/local_omnibox_popup.js\nFile chrome/browser/resources/local_omnibox_popup/local_omnibox_popup.js (right):\n\nhttps://codereview.chromium.org/11586007/diff/1/chrome/browser/resources/local_omnibox_popup/local_omnibox_popup.js#newcode180\nchrome/browser/resources/local_omnibox_popup/local_omnibox_popup.js:180: '.suggestion {' +\nthis should only have 4 spaces of indent\n\nhttps://codereview.chromium.org/11586007/diff/1/chrome/browser/resources/local_omnibox_popup/local_omnibox_popup.js#newcode210\nchrome/browser/resources/local_omnibox_popup/local_omnibox_popup.js:210: --selectedIndex < -1 ? numSuggestions - 1 : selectedIndex);\nuse modulus division and do it in selectSuggestionAtIndex","disapproval":false,"date":"2012-12-17 20:04:45.279560","approval":false},{"sender":"jeremycho@chromium.org","recipients":["jeremycho@chromium.org","estade@chromium.org","dcblack@chromium.org","chromium-reviews@chromium.org","arv@chromium.org","melevin@chromium.org","dhollowa@chromium.org","samarth@chromium.org","sreeram@chromium.org","gideonwald@chromium.org","dominich@chromium.org","shishir@chromium.org"],"text":"https://codereview.chromium.org/11586007/diff/1/chrome/browser/resources/local_omnibox_popup/local_omnibox_popup.css\nFile chrome/browser/resources/local_omnibox_popup/local_omnibox_popup.css (right):\n\nhttps://codereview.chromium.org/11586007/diff/1/chrome/browser/resources/local_omnibox_popup/local_omnibox_popup.css#newcode6\nchrome/browser/resources/local_omnibox_popup/local_omnibox_popup.css:6: background-color: #FFF;\nOn 2012/12/17 20:04:45, Evan Stade wrote:\n> s/#FFF/white\n\nDone.\n\nhttps://codereview.chromium.org/11586007/diff/1/chrome/browser/resources/local_omnibox_popup/local_omnibox_popup.html\nFile chrome/browser/resources/local_omnibox_popup/local_omnibox_popup.html (right):\n\nhttps://codereview.chromium.org/11586007/diff/1/chrome/browser/resources/local_omnibox_popup/local_omnibox_popup.html#newcode14\nchrome/browser/resources/local_omnibox_popup/local_omnibox_popup.html:14: <div id=\"suggestionsBoxContainer\"></div>\nOn 2012/12/17 20:04:45, Evan Stade wrote:\n> IDs are supposed to-go-like-this\n> \n> http://dev.chromium.org/developers/web-development-style-guide\n\nDone.\n\nhttps://codereview.chromium.org/11586007/diff/1/chrome/browser/resources/local_omnibox_popup/local_omnibox_popup.js\nFile chrome/browser/resources/local_omnibox_popup/local_omnibox_popup.js (right):\n\nhttps://codereview.chromium.org/11586007/diff/1/chrome/browser/resources/local_omnibox_popup/local_omnibox_popup.js#newcode180\nchrome/browser/resources/local_omnibox_popup/local_omnibox_popup.js:180: '.suggestion {' +\nOn 2012/12/17 20:04:45, Evan Stade wrote:\n> this should only have 4 spaces of indent\n\nDone.\n\nhttps://codereview.chromium.org/11586007/diff/1/chrome/browser/resources/local_omnibox_popup/local_omnibox_popup.js#newcode210\nchrome/browser/resources/local_omnibox_popup/local_omnibox_popup.js:210: --selectedIndex < -1 ? numSuggestions - 1 : selectedIndex);\nOn 2012/12/17 20:04:45, Evan Stade wrote:\n> use modulus division and do it in selectSuggestionAtIndex\n\nAFICAT, modulus division doesn't make this cleaner since it only handles looping in one direction:\nselectedIndex = (selectedIndex + 1) % numSuggestions - 1;\nif (selectedIndex < -1)\n  selectedIndex = numSuggestions - 1.\n\nAlso, I personally prefer having the precondition of selectSuggestionAtIndex be that the index is properly set.","disapproval":false,"date":"2012-12-17 21:01:28.232600","approval":false},{"sender":"estade@chromium.org","recipients":["jeremycho@chromium.org","estade@chromium.org","dcblack@chromium.org","chromium-reviews@chromium.org","arv@chromium.org","melevin@chromium.org","dhollowa@chromium.org","samarth@chromium.org","sreeram@chromium.org","gideonwald@chromium.org","dominich@chromium.org","shishir@chromium.org"],"text":"https://codereview.chromium.org/11586007/diff/1/chrome/browser/resources/local_omnibox_popup/local_omnibox_popup.js\nFile chrome/browser/resources/local_omnibox_popup/local_omnibox_popup.js (right):\n\nhttps://codereview.chromium.org/11586007/diff/1/chrome/browser/resources/local_omnibox_popup/local_omnibox_popup.js#newcode210\nchrome/browser/resources/local_omnibox_popup/local_omnibox_popup.js:210: --selectedIndex < -1 ? numSuggestions - 1 : selectedIndex);\nOn 2012/12/17 21:01:28, jeremycho wrote:\n> On 2012/12/17 20:04:45, Evan Stade wrote:\n> > use modulus division and do it in selectSuggestionAtIndex\n> \n> AFICAT, modulus division doesn't make this cleaner since it only handles looping\n> in one direction:\n> selectedIndex = (selectedIndex + 1) % numSuggestions - 1;\n> if (selectedIndex < -1)\n>   selectedIndex = numSuggestions - 1.\n\nFor the increment case,\n\n  (selectedIndex + 1) % numSuggestions - 1;\n\nis sufficient.\n\nFor decrement,\n\n  (numSuggestions + selectedIndex - 1) % numSuggestions - 1;\n\n> \n> Also, I personally prefer having the precondition of selectSuggestionAtIndex be\n> that the index is properly set.\n\nthat's fine, except then you have to check for over/under flow every time you use the function, which apparently is something that's hard to remember to do. Even if you do remember, you have to write code for it every time instead of just once.","disapproval":false,"date":"2012-12-17 21:09:06.299610","approval":false},{"sender":"jeremycho@chromium.org","recipients":["jeremycho@chromium.org","estade@chromium.org","dcblack@chromium.org","chromium-reviews@chromium.org","arv@chromium.org","melevin@chromium.org","dhollowa@chromium.org","samarth@chromium.org","sreeram@chromium.org","gideonwald@chromium.org","dominich@chromium.org","shishir@chromium.org"],"text":"https://codereview.chromium.org/11586007/diff/1/chrome/browser/resources/local_omnibox_popup/local_omnibox_popup.js\nFile chrome/browser/resources/local_omnibox_popup/local_omnibox_popup.js (right):\n\nhttps://codereview.chromium.org/11586007/diff/1/chrome/browser/resources/local_omnibox_popup/local_omnibox_popup.js#newcode210\nchrome/browser/resources/local_omnibox_popup/local_omnibox_popup.js:210: --selectedIndex < -1 ? numSuggestions - 1 : selectedIndex);\nActually, neither of those will work.  E.g. for increment, when selectedIndex = 3, numSuggestions = 4, you get -1 instead of 3.\n\nMoved this to updateSelectedSuggestion with the current looping logic - it might still be possible to do with modulo division, but I think it's clearer what's happening this way.\n\nOn 2012/12/17 21:09:06, Evan Stade wrote:\n> On 2012/12/17 21:01:28, jeremycho wrote:\n> > On 2012/12/17 20:04:45, Evan Stade wrote:\n> > > use modulus division and do it in selectSuggestionAtIndex\n> > \n> > AFICAT, modulus division doesn't make this cleaner since it only handles\n> looping\n> > in one direction:\n> > selectedIndex = (selectedIndex + 1) % numSuggestions - 1;\n> > if (selectedIndex < -1)\n> >   selectedIndex = numSuggestions - 1.\n> \n> For the increment case,\n> \n>   (selectedIndex + 1) % numSuggestions - 1;\n> \n> is sufficient.\n> \n> For decrement,\n> \n>   (numSuggestions + selectedIndex - 1) % numSuggestions - 1;\n> \n> > \n> > Also, I personally prefer having the precondition of selectSuggestionAtIndex\n> be\n> > that the index is properly set.\n> \n> that's fine, except then you have to check for over/under flow every time you\n> use the function, which apparently is something that's hard to remember to do.\n> Even if you do remember, you have to write code for it every time instead of\n> just once.","disapproval":false,"date":"2012-12-17 22:37:44.003310","approval":false},{"sender":"estade@chromium.org","recipients":["jeremycho@chromium.org","estade@chromium.org","dcblack@chromium.org","chromium-reviews@chromium.org","arv@chromium.org","melevin@chromium.org","dhollowa@chromium.org","samarth@chromium.org","sreeram@chromium.org","gideonwald@chromium.org","dominich@chromium.org","shishir@chromium.org"],"text":"ah, I was confused because I didn't realize you wanted to include -1 as a possible index. I guess you have this documented, but it's still counter-intuitive to me.\n\nLGTM","disapproval":false,"date":"2012-12-17 23:42:24.267890","approval":true},{"sender":"jeremycho@chromium.org","recipients":["jeremycho@chromium.org","estade@chromium.org","dcblack@chromium.org","chromium-reviews@chromium.org","arv@chromium.org","melevin@chromium.org","dhollowa@chromium.org","samarth@chromium.org","sreeram@chromium.org","gideonwald@chromium.org","dominich@chromium.org","shishir@chromium.org"],"text":"Thanks for the review.  Received go-ahead from dcblack to submit.","disapproval":false,"date":"2012-12-17 23:55:33.748810","approval":false},{"sender":"commit-bot@chromium.org","recipients":["jeremycho@chromium.org","estade@chromium.org","dcblack@chromium.org","chromium-reviews@chromium.org","arv@chromium.org","melevin@chromium.org","dhollowa@chromium.org","samarth@chromium.org","sreeram@chromium.org","gideonwald@chromium.org","dominich@chromium.org","shishir@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/jeremycho@chromium.org/11586007/16001","disapproval":false,"date":"2012-12-18 00:05:41.748890","approval":false},{"sender":"commit-bot@chromium.org","recipients":["jeremycho@chromium.org","estade@chromium.org","dcblack@chromium.org","chromium-reviews@chromium.org","arv@chromium.org","melevin@chromium.org","dhollowa@chromium.org","samarth@chromium.org","sreeram@chromium.org","gideonwald@chromium.org","dominich@chromium.org","shishir@chromium.org"],"text":"Presubmit check for 11586007-16001 failed and returned exit status 1.\n\n\nRunning presubmit commit checks ...\n\n** Presubmit Messages **\nWas the CSS checker useful? Send feedback or hate mail to dbeam@chromium.org.\n\n** Presubmit Warnings **\nchrome/browser/resources/local_omnibox_popup/local_omnibox_popup.css:\n- Classes use .dash-form.\n    .chrome_url {\n    .chrome_title {\n\nPresubmit checks took 1.3s to calculate.\n\nWas the presubmit check useful? Please send feedback & hate mail to maruel@chromium.org!","disapproval":false,"date":"2012-12-18 00:05:45.064190","approval":false},{"sender":"commit-bot@chromium.org","recipients":["jeremycho@chromium.org","estade@chromium.org","dcblack@chromium.org","chromium-reviews@chromium.org","arv@chromium.org","melevin@chromium.org","dhollowa@chromium.org","samarth@chromium.org","sreeram@chromium.org","gideonwald@chromium.org","dominich@chromium.org","shishir@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/jeremycho@chromium.org/11586007/10002","disapproval":false,"date":"2012-12-18 00:23:34.348170","approval":false},{"sender":"commit-bot@chromium.org","recipients":["jeremycho@chromium.org","estade@chromium.org","dcblack@chromium.org","chromium-reviews@chromium.org","arv@chromium.org","melevin@chromium.org","dhollowa@chromium.org","samarth@chromium.org","sreeram@chromium.org","gideonwald@chromium.org","dominich@chromium.org","shishir@chromium.org"],"text":"Presubmit check for 11586007-10002 failed and returned exit status 1.\n\n\nRunning presubmit commit checks ...\n\n** Presubmit Messages **\nWas the CSS checker useful? Send feedback or hate mail to dbeam@chromium.org.\n\n** Presubmit Warnings **\nchrome/browser/resources/local_omnibox_popup/local_omnibox_popup.css:\n- Classes use .dash-form.\n    .chrome_url {\n    .chrome_title {\n\nPresubmit checks took 1.5s to calculate.","disapproval":false,"date":"2012-12-18 00:23:38.530040","approval":false}],"owner_email":"jeremycho@chromium.org","private":false,"base_url":"https://git.chromium.org/chromium/src.git@master","owner":"jeremycho","subject":"Update local instant to match online instant.","created":"2012-12-16 21:59:59.574600","patchsets":[1,8001,6002,16001,10002],"modified":"2012-12-18 00:30:34.017520","closed":true,"commit":false,"issue":11586007}
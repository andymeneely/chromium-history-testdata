{"description":"Split recursive Copy/Move into async tasks and support cross operation (in local case)\r\n\r\nAlso get cross-filesystem operation working\r\n(as far as both belong to LocalFileSystemOperation).\r\n\r\n(I'll make related clean-ups in follow-up patches later)\r\n\r\nSimilarly to dividing Remove change this basically makes\r\nend-to-end recursive copy/move operation SLOW, while\r\nconcurrent tasks won't be blocked for a long time.\r\n\r\nWith config: 200 files, 120 dirs, 4-level tree, total 100MB\r\n\r\n* Copy:\r\nBefore this change: Ave:164.01 msec, Stddev:  3.534 msec \r\nAfter this change:  Ave:228.34 msec, Stddev: 36.014 msec\r\n\r\n* Move (copy+remove after this change):\r\nBefore this change: Ave: 87.76 msec, Stddev: 4.631 msec\r\nAfter this change:  Ave:392.12 msec, Stddev:35.340 msec\r\n\r\nPatch from: https://codereview.chromium.org/12018017/\r\nTry results: https://codereview.chromium.org/12051010/\r\n\r\nBUG=110121,146215\r\nTEST=content_browsertests:FileSystemLayoutTest.{OpCopy,OpMove,CrossFilesystemOp}\n\nCommitted: https://src.chromium.org/viewvc/chrome?view=rev&revision=179128","cc":["chromium-reviews@chromium.org","tzik+watch@chromium.org","kinuko+watch@chromium.org","darin-cc@chromium.org","thestig@chromium.org","vandebo@chromium.org","ericu@chromium.org"],"reviewers":["tzik@chromium.org"],"messages":[{"sender":"kinuko@chromium.org","recipients":["kinuko@chromium.org","tzik@chromium.org","chromium-reviews@chromium.org","tzik+watch@chromium.org","kinuko+watch@chromium.org","darin-cc@chromium.org","thestig@chromium.org","vandebo@chromium.org","ericu@chromium.org"],"text":"I'll add more tests (in separate patches) but bots look happy (https://codereview.chromium.org/12051010/) and it works fine in my local manual test.\n\nCan you take a look? Thanks!","disapproval":false,"date":"2013-01-23 06:24:01.102460","approval":false},{"sender":"tzik@chromium.org","recipients":["kinuko@chromium.org","tzik@chromium.org","chromium-reviews@chromium.org","tzik+watch@chromium.org","kinuko+watch@chromium.org","darin-cc@chromium.org","thestig@chromium.org","vandebo@chromium.org","ericu@chromium.org"],"text":"lgtm\n\nhttps://codereview.chromium.org/12036022/diff/4016/webkit/fileapi/cross_operation_delegate.cc\nFile webkit/fileapi/cross_operation_delegate.cc (right):\n\nhttps://codereview.chromium.org/12036022/diff/4016/webkit/fileapi/cross_operation_delegate.cc#newcode128\nwebkit/fileapi/cross_operation_delegate.cc:128: }\nFor same_file_system && operation_type == MOVE case, we might perform the operation efficiently without recursive operation.\nCould you leave TODO comment to optimize the case?","disapproval":false,"date":"2013-01-24 05:19:24.871010","approval":true},{"sender":"kinuko@chromium.org","recipients":["kinuko@chromium.org","tzik@chromium.org","chromium-reviews@chromium.org","tzik+watch@chromium.org","kinuko+watch@chromium.org","darin-cc@chromium.org","thestig@chromium.org","vandebo@chromium.org","ericu@chromium.org"],"text":"Addressed comments and merged memory leak fix.\n\nhttps://codereview.chromium.org/12036022/diff/4016/webkit/fileapi/cross_operation_delegate.cc\nFile webkit/fileapi/cross_operation_delegate.cc (right):\n\nhttps://codereview.chromium.org/12036022/diff/4016/webkit/fileapi/cross_operation_delegate.cc#newcode128\nwebkit/fileapi/cross_operation_delegate.cc:128: }\nOn 2013/01/24 05:19:24, tzik wrote:\n> For same_file_system && operation_type == MOVE case, we might perform the\n> operation efficiently without recursive operation.\n> Could you leave TODO comment to optimize the case?\n\nDone.","disapproval":false,"date":"2013-01-25 04:31:43.118950","approval":false},{"sender":"tzik@chromium.org","recipients":["kinuko@chromium.org","tzik@chromium.org","chromium-reviews@chromium.org","tzik+watch@chromium.org","kinuko+watch@chromium.org","darin-cc@chromium.org","thestig@chromium.org","vandebo@chromium.org","ericu@chromium.org"],"text":"lgtm","disapproval":false,"date":"2013-01-28 02:21:53.981770","approval":true}],"owner_email":"kinuko@chromium.org","private":false,"base_url":"svn://svn.chromium.org/chrome/trunk/src","owner":"kinuko","subject":"Split recursive Copy/Move into async tasks and support cross operation (in local case)","created":"2013-01-22 09:36:46.745470","patchsets":[1014,3001,4016,14001,23001],"modified":"2013-01-28 10:44:49.500580","closed":true,"commit":false,"issue":12036022}
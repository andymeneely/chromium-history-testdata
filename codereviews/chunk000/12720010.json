{"description":"Clean up control of perf governor\n\nThe perf governor was previously controlled by the PerfTestSetup class,\nwhich set the perf governor to 'performance' mode in Startup() and\nreset it to its original value on TearDown(). This had a number of\nproblems:\n- We ended up with TearDown() being used in place of SetUp() when\nstarting tests where we didn't want performance mode. This looks\nstrange.\n- There was no explicit way of setting the device's default\nperformance mode. We would call TearDown() and hope for the best. This\nwould not work if the device was already in performance mode at the\nstart of the test. We think this is sometimes happening on the\nperformance bots.\n- SetUp() also cleared the caches, which should have no direct\nconnection with setting the performance mode.\n\nThis patch creates two new classes, PerfControl and CacheControl, to\nmanage the perf governor and cache. These replace PerfTestSetup.\n\nPerfTestSetup has not yet been deleted to avoid the need for simultaneous\ncommits on the upstream and downstream repositories.\n\n\nCommitted: https://src.chromium.org/viewvc/chrome?view=rev&revision=189097","cc":["chromium-reviews@chromium.org","chrome-speed-team+watch@google.com","bulach+watch@chromium.org","yfriedman+watch@chromium.org","klundberg+watch@chromium.org","telemetry+watch@chromium.org","ilevy+watch@chromium.org","frankf+watch@chromium.org"],"reviewers":["bulach@chromium.org"],"messages":[{"sender":"bulach@chromium.org","recipients":["aberent@chromium.org","bulach@chromium.org","chromium-reviews@chromium.org","chrome-speed-team+watch@google.com","bulach+watch@chromium.org","yfriedman+watch@chromium.org","klundberg+watch@chromium.org","telemetry+watch@chromium.org","ilevy+watch@chromium.org","frankf+watch@chromium.org"],"text":"lgtm, thanks! just some nits below:\n\nhttps://codereview.chromium.org/12720010/diff/1/build/android/pylib/perf_tests_helper.py\nFile build/android/pylib/perf_tests_helper.py (right):\n\nhttps://codereview.chromium.org/12720010/diff/1/build/android/pylib/perf_tests_helper.py#newcode141\nbuild/android/pylib/perf_tests_helper.py:141: \nnit: remove extra \\n\n\nhttps://codereview.chromium.org/12720010/diff/1/build/android/pylib/perf_tests_helper.py#newcode172\nbuild/android/pylib/perf_tests_helper.py:172: }.get(product_model, 'ondemand')\nmaybe interactive as default?\n\nhttps://codereview.chromium.org/12720010/diff/1/build/android/pylib/perf_tests_helper.py#newcode188\nbuild/android/pylib/perf_tests_helper.py:188: Will be removed once all tests have been moved to the new classes\nTODO(aberent): remove once all tests have been moved to the new classes.","disapproval":false,"date":"2013-03-19 17:28:46.089500","approval":true},{"sender":"aberent@chromium.org","recipients":["aberent@chromium.org","bulach@chromium.org","chromium-reviews@chromium.org","chrome-speed-team+watch@google.com","bulach+watch@chromium.org","yfriedman+watch@chromium.org","klundberg+watch@chromium.org","telemetry+watch@chromium.org","ilevy+watch@chromium.org","frankf+watch@chromium.org"],"text":"Updated patch to follow shortly.\n\nhttps://codereview.chromium.org/12720010/diff/1/build/android/pylib/perf_tests_helper.py\nFile build/android/pylib/perf_tests_helper.py (right):\n\nhttps://codereview.chromium.org/12720010/diff/1/build/android/pylib/perf_tests_helper.py#newcode141\nbuild/android/pylib/perf_tests_helper.py:141: \nOn 2013/03/19 17:28:46, bulach wrote:\n> nit: remove extra \\n\n\nDone.\n\nhttps://codereview.chromium.org/12720010/diff/1/build/android/pylib/perf_tests_helper.py#newcode172\nbuild/android/pylib/perf_tests_helper.py:172: }.get(product_model, 'ondemand')\nOn 2013/03/19 17:28:46, bulach wrote:\n> maybe interactive as default?\n\nMy understanding is that ondemand exists on everything, but interactive may only exist on newer Android builds, hence the choice of ondemand as the default.\n\nhttps://codereview.chromium.org/12720010/diff/1/build/android/pylib/perf_tests_helper.py#newcode188\nbuild/android/pylib/perf_tests_helper.py:188: Will be removed once all tests have been moved to the new classes\nOn 2013/03/19 17:28:46, bulach wrote:\n> TODO(aberent): remove once all tests have been moved to the new classes.\n\nDone.","disapproval":false,"date":"2013-03-19 17:35:46.632860","approval":false},{"sender":"commit-bot@chromium.org","recipients":["aberent@chromium.org","bulach@chromium.org","chromium-reviews@chromium.org","chrome-speed-team+watch@google.com","bulach+watch@chromium.org","yfriedman+watch@chromium.org","klundberg+watch@chromium.org","telemetry+watch@chromium.org","ilevy+watch@chromium.org","frankf+watch@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/aberent@chromium.org/12720010/5","disapproval":false,"date":"2013-03-19 17:57:06.755840","approval":false},{"sender":"commit-bot@chromium.org","recipients":["aberent@chromium.org","bulach@chromium.org","chromium-reviews@chromium.org","chrome-speed-team+watch@google.com","bulach+watch@chromium.org","yfriedman+watch@chromium.org","klundberg+watch@chromium.org","telemetry+watch@chromium.org","ilevy+watch@chromium.org","frankf+watch@chromium.org"],"text":"Change committed as 189097","disapproval":false,"date":"2013-03-19 20:56:29.403720","approval":false}],"owner_email":"aberent@chromium.org","private":false,"base_url":"https://chromium.googlesource.com/chromium/src.git@master","owner":"aberent","subject":"Clean up control of perf governor","created":"2013-03-19 17:10:04.602550","patchsets":[1,5],"modified":"2013-03-19 20:56:29.611320","closed":true,"commit":false,"issue":12720010}
{"description":"Web Intent Picker UI (implemented as a constrained dialog, linux only)\n\nBUG=none\nTEST=none\n\n\nCommitted: http://src.chromium.org/viewvc/chrome?view=rev&revision=97990","cc":["chromium-reviews@chromium.org","joi+watch-content@chromium.org","avi@chromium.org","phajdan.jr@chromium.org","jam@chromium.org","brettw-cc@chromium.org"],"reviewers":["jhawkins@chromium.org","sky@chromium.org","estade@chromium.org","pinkerton@chromium.org","commit-bot@chromium.org","thakis@chromium.org"],"messages":[{"sender":"binji@chromium.org","recipients":["binji@chromium.org","jhawkins@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","avi@chromium.org","phajdan.jr@chromium.org","jam@chromium.org","brettw-cc@chromium.org"],"text":"","disapproval":false,"date":"2011-08-16 20:10:38.970112","approval":false},{"sender":"jhawkins@chromium.org","recipients":["binji@chromium.org","jhawkins@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","avi@chromium.org","phajdan.jr@chromium.org","jam@chromium.org","brettw-cc@chromium.org"],"text":"http://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.cc\nFile chrome/browser/ui/gtk/web_intent_picker_gtk.cc (right):\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode67\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:67: DCHECK(button_hbox_);\nRemove this DCHECK. In general, DCHECK at most once on internal member vars (at time of creation).\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode70\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:70: ResourceBundle& rb = ResourceBundle::GetSharedInstance();\nYou could pull these two lines out of the loop, but why are we setting the default favicon at first?  Won't this be janky if the user sees default favicon, then the actual favicon once the service sends the icons?\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode92\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:92: GdkPixbuf* icon_pixbuf = gfx::GdkPixbufFromSkBitmap(&icon);\nSave indentation and return early on the negation of the logic statement.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode129\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:129: if (delegate_)\nUnder what circumstances is |delegate_| allowed to be NULL?\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode143\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:143: WebIntentPickerGtk::~WebIntentPickerGtk() {\nOrder of methods in the implementation file needs to match the order in the header.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode144\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:144: root_.Destroy();\nafaik, you don't need to call Destroy on an OwnedWidgetGtk in the destructor (it happens at scope).\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.h\nFile chrome/browser/ui/gtk/web_intent_picker_gtk.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode14\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:14: #include \"base/string16.h\"\nUnused?\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode16\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:16: #include \"chrome/browser/ui/gtk/gtk_util.h\"\nui/base/gtk/gtk_signal.h\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode29\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:29: WebIntentPickerGtk(TabContents* tab_contents, Delegate* delegate);\nWhich |Delegate| is this?\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode32\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:32: // WebIntentPicker methods\n// WebIntentPicker implementation.\n\nHere and elsewhere.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode35\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:35: virtual void Show() OVERRIDE;\n#include \"base/compiler_specific.h\"\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode44\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:44: // callback when a service button is \"clicked\".\nRemove the quotes, here and below.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode49\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:49: TabContents* tab_contents_;\nDocument this var.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode51\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:51: // The WebIntentPicker::Delegate to notify.\n...notify of what?\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode66\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:66: DISALLOW_COPY_AND_ASSIGN(WebIntentPickerGtk);\n#include \"base/basictypes.h\"\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/tab_contents/tab_contents_wrapper.h\nFile chrome/browser/ui/tab_contents/tab_contents_wrapper.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/tab_contents/tab_contents_wrapper.h#newcode57\nchrome/browser/ui/tab_contents/tab_contents_wrapper.h:57: class WebIntentController;\nThis name is ambiguous. Is it the Picker controller?\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_constrained_dialog_factory.cc\nFile chrome/browser/ui/web_intent_constrained_dialog_factory.cc (right):\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_constrained_dialog_factory.cc#newcode22\nchrome/browser/ui/web_intent_constrained_dialog_factory.cc:22: // only allow one picker per factory.\ns/only/Only/\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_constrained_dialog_factory.h\nFile chrome/browser/ui/web_intent_constrained_dialog_factory.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_constrained_dialog_factory.h#newcode29\nchrome/browser/ui/web_intent_constrained_dialog_factory.h:29: void CloseDialog();\nDocument the method.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_constrained_dialog_factory.h#newcode31\nchrome/browser/ui/web_intent_constrained_dialog_factory.h:31: WebIntentPicker* picker_;\nDocument the var. Document ownership.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_controller.cc\nFile chrome/browser/ui/web_intent_controller.cc (right):\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_controller.cc#newcode24\nchrome/browser/ui/web_intent_controller.cc:24: // Get the favicon service for the profile in |tab_contents|.\ns/Get/Gets/\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_controller.h\nFile chrome/browser/ui/web_intent_controller.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_controller.h#newcode37\nchrome/browser/ui/web_intent_controller.h:37: // Show the web intent picker, given the intent |action| and mime-type |type|.\ns/Show/Shows/\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_controller.h#newcode57\nchrome/browser/ui/web_intent_controller.h:57: void OnWebIntentDataAvailable(const std::vector<WebIntentData>& intent_data);\nDocument these methods.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_controller.h#newcode63\nchrome/browser/ui/web_intent_controller.h:63: TabContents* tab_contents_;\nDocument all of these vars, including ownership.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_controller.h#newcode78\nchrome/browser/ui/web_intent_controller.h:78: class WebIntentController::PickerFactory {\nMove this class outside of the WebIntentController scope, into a new header file (iwyu).\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_picker.h\nFile chrome/browser/ui/web_intent_picker.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_picker.h#newcode10\nchrome/browser/ui/web_intent_picker.h:10: #include \"content/browser/tab_contents/constrained_window.h\"\nunused?\n\nhttp://codereview.chromium.org/7648061/diff/1/content/renderer/render_view.cc\nFile content/renderer/render_view.cc (right):\n\nhttp://codereview.chromium.org/7648061/diff/1/content/renderer/render_view.cc#newcode4452\ncontent/renderer/render_view.cc:4452: void RenderView::startActivity(const WebKit::WebString& action,\nIs this going to conflict with Greg's CL to add this?","disapproval":false,"date":"2011-08-16 20:35:51.599828","approval":false},{"sender":"binji@chromium.org","recipients":["binji@chromium.org","jhawkins@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","avi@chromium.org","phajdan.jr@chromium.org","jam@chromium.org","brettw-cc@chromium.org"],"text":"http://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.cc\nFile chrome/browser/ui/gtk/web_intent_picker_gtk.cc (right):\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode67\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:67: DCHECK(button_hbox_);\nOn 2011/08/16 20:35:51, James Hawkins wrote:\n> Remove this DCHECK. In general, DCHECK at most once on internal member vars (at\n> time of creation).\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode70\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:70: ResourceBundle& rb = ResourceBundle::GetSharedInstance();\nOn 2011/08/16 20:35:51, James Hawkins wrote:\n> You could pull these two lines out of the loop, but why are we setting the\n> default favicon at first?  Won't this be janky if the user sees default favicon,\n> then the actual favicon once the service sends the icons?\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode92\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:92: GdkPixbuf* icon_pixbuf = gfx::GdkPixbufFromSkBitmap(&icon);\nOn 2011/08/16 20:35:51, James Hawkins wrote:\n> Save indentation and return early on the negation of the logic statement.\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode129\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:129: if (delegate_)\nOn 2011/08/16 20:35:51, James Hawkins wrote:\n> Under what circumstances is |delegate_| allowed to be NULL?\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode143\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:143: WebIntentPickerGtk::~WebIntentPickerGtk() {\nOn 2011/08/16 20:35:51, James Hawkins wrote:\n> Order of methods in the implementation file needs to match the order in the\n> header.\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode144\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:144: root_.Destroy();\nOn 2011/08/16 20:35:51, James Hawkins wrote:\n> afaik, you don't need to call Destroy on an OwnedWidgetGtk in the destructor (it\n> happens at scope).\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.h\nFile chrome/browser/ui/gtk/web_intent_picker_gtk.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode14\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:14: #include \"base/string16.h\"\nOn 2011/08/16 20:35:51, James Hawkins wrote:\n> Unused?\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode16\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:16: #include \"chrome/browser/ui/gtk/gtk_util.h\"\nOn 2011/08/16 20:35:51, James Hawkins wrote:\n> ui/base/gtk/gtk_signal.h\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode29\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:29: WebIntentPickerGtk(TabContents* tab_contents, Delegate* delegate);\nOn 2011/08/16 20:35:51, James Hawkins wrote:\n> Which |Delegate| is this?\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode32\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:32: // WebIntentPicker methods\nOn 2011/08/16 20:35:51, James Hawkins wrote:\n> // WebIntentPicker implementation.\n> \n> Here and elsewhere.\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode35\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:35: virtual void Show() OVERRIDE;\nOn 2011/08/16 20:35:51, James Hawkins wrote:\n> #include \"base/compiler_specific.h\"\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode44\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:44: // callback when a service button is \"clicked\".\nOn 2011/08/16 20:35:51, James Hawkins wrote:\n> Remove the quotes, here and below.\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode49\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:49: TabContents* tab_contents_;\nOn 2011/08/16 20:35:51, James Hawkins wrote:\n> Document this var.\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode51\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:51: // The WebIntentPicker::Delegate to notify.\nOn 2011/08/16 20:35:51, James Hawkins wrote:\n> ...notify of what?\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode66\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:66: DISALLOW_COPY_AND_ASSIGN(WebIntentPickerGtk);\nOn 2011/08/16 20:35:51, James Hawkins wrote:\n> #include \"base/basictypes.h\"\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/tab_contents/tab_contents_wrapper.h\nFile chrome/browser/ui/tab_contents/tab_contents_wrapper.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/tab_contents/tab_contents_wrapper.h#newcode57\nchrome/browser/ui/tab_contents/tab_contents_wrapper.h:57: class WebIntentController;\nOn 2011/08/16 20:35:51, James Hawkins wrote:\n> This name is ambiguous. Is it the Picker controller?\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_constrained_dialog_factory.cc\nFile chrome/browser/ui/web_intent_constrained_dialog_factory.cc (right):\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_constrained_dialog_factory.cc#newcode22\nchrome/browser/ui/web_intent_constrained_dialog_factory.cc:22: // only allow one picker per factory.\nOn 2011/08/16 20:35:51, James Hawkins wrote:\n> s/only/Only/\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_constrained_dialog_factory.h\nFile chrome/browser/ui/web_intent_constrained_dialog_factory.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_constrained_dialog_factory.h#newcode29\nchrome/browser/ui/web_intent_constrained_dialog_factory.h:29: void CloseDialog();\nOn 2011/08/16 20:35:51, James Hawkins wrote:\n> Document the method.\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_constrained_dialog_factory.h#newcode31\nchrome/browser/ui/web_intent_constrained_dialog_factory.h:31: WebIntentPicker* picker_;\nOn 2011/08/16 20:35:51, James Hawkins wrote:\n> Document the var. Document ownership.\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_controller.cc\nFile chrome/browser/ui/web_intent_controller.cc (right):\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_controller.cc#newcode24\nchrome/browser/ui/web_intent_controller.cc:24: // Get the favicon service for the profile in |tab_contents|.\nOn 2011/08/16 20:35:51, James Hawkins wrote:\n> s/Get/Gets/\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_controller.h\nFile chrome/browser/ui/web_intent_controller.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_controller.h#newcode37\nchrome/browser/ui/web_intent_controller.h:37: // Show the web intent picker, given the intent |action| and mime-type |type|.\nOn 2011/08/16 20:35:51, James Hawkins wrote:\n> s/Show/Shows/\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_controller.h#newcode57\nchrome/browser/ui/web_intent_controller.h:57: void OnWebIntentDataAvailable(const std::vector<WebIntentData>& intent_data);\nOn 2011/08/16 20:35:51, James Hawkins wrote:\n> Document these methods.\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_controller.h#newcode63\nchrome/browser/ui/web_intent_controller.h:63: TabContents* tab_contents_;\nOn 2011/08/16 20:35:51, James Hawkins wrote:\n> Document all of these vars, including ownership.\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_controller.h#newcode78\nchrome/browser/ui/web_intent_controller.h:78: class WebIntentController::PickerFactory {\nOn 2011/08/16 20:35:51, James Hawkins wrote:\n> Move this class outside of the WebIntentController scope, into a new header file\n> (iwyu).\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_picker.h\nFile chrome/browser/ui/web_intent_picker.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/1/chrome/browser/ui/web_intent_picker.h#newcode10\nchrome/browser/ui/web_intent_picker.h:10: #include \"content/browser/tab_contents/constrained_window.h\"\nOn 2011/08/16 20:35:51, James Hawkins wrote:\n> unused?\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/1/content/renderer/render_view.cc\nFile content/renderer/render_view.cc (right):\n\nhttp://codereview.chromium.org/7648061/diff/1/content/renderer/render_view.cc#newcode4452\ncontent/renderer/render_view.cc:4452: void RenderView::startActivity(const WebKit::WebString& action,\nOn 2011/08/16 20:35:51, James Hawkins wrote:\n> Is this going to conflict with Greg's CL to add this?\n\nDone.","disapproval":false,"date":"2011-08-17 00:31:09.352787","approval":false},{"sender":"jhawkins@chromium.org","recipients":["binji@chromium.org","jhawkins@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","avi@chromium.org","phajdan.jr@chromium.org","jam@chromium.org","brettw-cc@chromium.org"],"text":"http://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/gtk/web_intent_picker_gtk.cc\nFile chrome/browser/ui/gtk/web_intent_picker_gtk.cc (right):\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode71\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:71: for (size_t i = 0, end = urls.size(); i < end; ++i) {\nWhy did you pull end out into a separate var? Just use `i < urls.size()`\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode84\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:84: void WebIntentPickerGtk::SetServiceIcon(size_t index, const SkBitmap& icon) {\nYou didn't really answer the previous question about jank when showing the service icons. How is this going to work out?\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode91\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:91: if (!button)\nWhen would this happen?\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode114\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:114: DCHECK(!window_);\nDon't DCHECK private member vars.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode119\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:119: if (window_) {\nHow can |window_| be NULL here?\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode144\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:144: if (index == -1)\nHow will this case happen?\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/gtk/web_intent_picker_gtk.h\nFile chrome/browser/ui/gtk/web_intent_picker_gtk.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode46\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:46: // callback when a service button is clicked.\nCapitalize sentences, here and elsewhere.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode51\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:51: // The tab contents on which to display the picker UI.\nWeak pointer?\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode56\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:56: Delegate* delegate_;\nOwnership?\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode62\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:62: GtkWidget* button_hbox_;\nOwnership?\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode68\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:68: ConstrainedWindow* window_;\nOwnership?\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_constrained_dialog_factory.cc\nFile chrome/browser/ui/web_intent_constrained_dialog_factory.cc (right):\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_constrained_dialog_factory.cc#newcode23\nchrome/browser/ui/web_intent_constrained_dialog_factory.cc:23: DCHECK(!picker_);\nDCHECK_NE(static_cast<PickerClass*>(NULL), picker_);\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_constrained_dialog_factory.cc#newcode37\nchrome/browser/ui/web_intent_constrained_dialog_factory.cc:37: if (picker_) {\nHow can |picker_| be NULL here?\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker.h\nFile chrome/browser/ui/web_intent_picker.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker.h#newcode18\nchrome/browser/ui/web_intent_picker.h:18: class Delegate;\nPull the Delegate out of the class into its own header.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker.h#newcode23\nchrome/browser/ui/web_intent_picker.h:23: // Initalize this picker with the |urls|.\nInitializes\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_controller.cc\nFile chrome/browser/ui/web_intent_picker_controller.cc (right):\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_controller.cc#newcode39\nchrome/browser/ui/web_intent_picker_controller.cc:39: class WebIntentPickerController::WebIntentDataFetcher\nDocument this class.  Does it need to live on WebIntentPickerController?\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_controller.cc#newcode58\nchrome/browser/ui/web_intent_picker_controller.cc:58: WebIntentPickerController* controller_;\nDocument these vars.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_controller.cc#newcode84\nchrome/browser/ui/web_intent_picker_controller.cc:84: WebIntentPickerController* controller_;\nDocument vars.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_controller.cc#newcode93\nchrome/browser/ui/web_intent_picker_controller.cc:93: WebIntentPickerController::WebIntentPickerController(TabContents* tab_contents,\nAlign params on one column, here and elsewhere.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_controller.cc#newcode145\nchrome/browser/ui/web_intent_picker_controller.cc:145: for (size_t i = 0, end = intent_data.size(); i < end; ++i) {\nSame as the other file: don't pre-optimize at the cost of readability.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_controller.cc#newcode149\nchrome/browser/ui/web_intent_picker_controller.cc:149: // tell the picker to initialize N urls to the default favicon\nCapitalize sentences.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_controller.cc#newcode157\nchrome/browser/ui/web_intent_picker_controller.cc:157: DCHECK(picker_);\nDon't DCHECK internal vars, here and elsewhere.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_controller.cc#newcode178\nchrome/browser/ui/web_intent_picker_controller.cc:178: : controller_(controller),\nThis line should be indented 4 lines from the previous.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_controller.h\nFile chrome/browser/ui/web_intent_picker_controller.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_controller.h#newcode63\nchrome/browser/ui/web_intent_picker_controller.h:63: // Calle from the FaviconDataFetcher when a favicon is not available.\nCalled\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_controller.h#newcode72\nchrome/browser/ui/web_intent_picker_controller.h:72: // A notification registrar.\n:-) \"Used to register notifications to listen for...\"\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_controller.h#newcode84\nchrome/browser/ui/web_intent_picker_controller.h:84: // A pointer to the picker this controller controls.\nWeak?\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_factory.h\nFile chrome/browser/ui/web_intent_picker_factory.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_factory.h#newcode16\nchrome/browser/ui/web_intent_picker_factory.h:16: virtual ~WebIntentPickerFactory() {}\nMove this to protected?\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_factory.h#newcode18\nchrome/browser/ui/web_intent_picker_factory.h:18: virtual WebIntentPicker* Create(TabContents* tab_contents,\nDocument the methods.","disapproval":false,"date":"2011-08-17 01:54:04.408783","approval":false},{"sender":"binji@chromium.org","recipients":["binji@chromium.org","jhawkins@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","avi@chromium.org","phajdan.jr@chromium.org","jam@chromium.org","brettw-cc@chromium.org"],"text":"http://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/gtk/web_intent_picker_gtk.cc\nFile chrome/browser/ui/gtk/web_intent_picker_gtk.cc (right):\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode71\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:71: for (size_t i = 0, end = urls.size(); i < end; ++i) {\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> Why did you pull end out into a separate var? Just use `i < urls.size()`\n\nJust habit, mostly.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode84\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:84: void WebIntentPickerGtk::SetServiceIcon(size_t index, const SkBitmap& icon) {\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> You didn't really answer the previous question about jank when showing the\n> service icons. How is this going to work out?\n\nI don't see any jank. But as an alternative, I could wait until all the icons are set before displaying the dialog.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode91\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:91: if (!button)\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> When would this happen?\n\nIt shouldn't. I'll change it to a DCHECK.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode114\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:114: DCHECK(!window_);\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> Don't DCHECK private member vars.\n\nThis is to check that the caller is only calling Show once.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode119\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:119: if (window_) {\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> How can |window_| be NULL here?\n\nIt shouldn't. I can change it to a DCHECK for the same reason as above.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode144\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:144: if (index == -1)\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> How will this case happen?\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/gtk/web_intent_picker_gtk.h\nFile chrome/browser/ui/gtk/web_intent_picker_gtk.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode46\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:46: // callback when a service button is clicked.\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> Capitalize sentences, here and elsewhere.\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode51\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:51: // The tab contents on which to display the picker UI.\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> Weak pointer?\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode56\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:56: Delegate* delegate_;\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> Ownership?\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode62\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:62: GtkWidget* button_hbox_;\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> Ownership?\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode68\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:68: ConstrainedWindow* window_;\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> Ownership?\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_constrained_dialog_factory.cc\nFile chrome/browser/ui/web_intent_constrained_dialog_factory.cc (right):\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_constrained_dialog_factory.cc#newcode23\nchrome/browser/ui/web_intent_constrained_dialog_factory.cc:23: DCHECK(!picker_);\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> DCHECK_NE(static_cast<PickerClass*>(NULL), picker_);\n\nSeems like DCHECK(picker_ != NULL) is more common:\nhttp://www.google.com/codesearch#search/&type=cs&q=DCHECK.*NULL&exact_package=chromium&p=7&sq=\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_constrained_dialog_factory.cc#newcode37\nchrome/browser/ui/web_intent_constrained_dialog_factory.cc:37: if (picker_) {\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> How can |picker_| be NULL here?\n\nIf this object is destroyed before Create is called.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker.h\nFile chrome/browser/ui/web_intent_picker.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker.h#newcode18\nchrome/browser/ui/web_intent_picker.h:18: class Delegate;\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> Pull the Delegate out of the class into its own header.\n\nIs this necessary? It seems as though that would make it harder to understand the role of the WebIntentPicker -- having the delegate in class lets you quickly see that the picker takes input via SetService* and sends output via OnServiceChosen/OnCancelled.\n\nAlso, see plenty of examples of this:\nhttp://www.google.com/codesearch#search/&type=cs&q=%5C:%5C:Delegate%20file:%5C.h&exact_package=chromium\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker.h#newcode23\nchrome/browser/ui/web_intent_picker.h:23: // Initalize this picker with the |urls|.\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> Initializes\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_controller.cc\nFile chrome/browser/ui/web_intent_picker_controller.cc (right):\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_controller.cc#newcode39\nchrome/browser/ui/web_intent_picker_controller.cc:39: class WebIntentPickerController::WebIntentDataFetcher\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> Document this class.  Does it need to live on WebIntentPickerController?\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_controller.cc#newcode58\nchrome/browser/ui/web_intent_picker_controller.cc:58: WebIntentPickerController* controller_;\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> Document these vars.\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_controller.cc#newcode84\nchrome/browser/ui/web_intent_picker_controller.cc:84: WebIntentPickerController* controller_;\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> Document vars.\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_controller.cc#newcode93\nchrome/browser/ui/web_intent_picker_controller.cc:93: WebIntentPickerController::WebIntentPickerController(TabContents* tab_contents,\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> Align params on one column, here and elsewhere.\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_controller.cc#newcode145\nchrome/browser/ui/web_intent_picker_controller.cc:145: for (size_t i = 0, end = intent_data.size(); i < end; ++i) {\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> Same as the other file: don't pre-optimize at the cost of readability.\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_controller.cc#newcode149\nchrome/browser/ui/web_intent_picker_controller.cc:149: // tell the picker to initialize N urls to the default favicon\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> Capitalize sentences.\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_controller.cc#newcode157\nchrome/browser/ui/web_intent_picker_controller.cc:157: DCHECK(picker_);\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> Don't DCHECK internal vars, here and elsewhere.\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_controller.cc#newcode178\nchrome/browser/ui/web_intent_picker_controller.cc:178: : controller_(controller),\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> This line should be indented 4 lines from the previous.\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_controller.h\nFile chrome/browser/ui/web_intent_picker_controller.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_controller.h#newcode63\nchrome/browser/ui/web_intent_picker_controller.h:63: // Calle from the FaviconDataFetcher when a favicon is not available.\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> Called\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_controller.h#newcode72\nchrome/browser/ui/web_intent_picker_controller.h:72: // A notification registrar.\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> :-) \"Used to register notifications to listen for...\"\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_controller.h#newcode84\nchrome/browser/ui/web_intent_picker_controller.h:84: // A pointer to the picker this controller controls.\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> Weak?\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_factory.h\nFile chrome/browser/ui/web_intent_picker_factory.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_factory.h#newcode16\nchrome/browser/ui/web_intent_picker_factory.h:16: virtual ~WebIntentPickerFactory() {}\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> Move this to protected?\n\nNo, WebIntentPickerController has a scoped_ptr<WebIntentPickerFactory>, so it needs to be accessible.\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker_factory.h#newcode18\nchrome/browser/ui/web_intent_picker_factory.h:18: virtual WebIntentPicker* Create(TabContents* tab_contents,\nOn 2011/08/17 01:54:05, James Hawkins wrote:\n> Document the methods.\n\nDone.","disapproval":false,"date":"2011-08-17 19:07:36.020962","approval":false},{"sender":"jhawkins@chromium.org","recipients":["binji@chromium.org","jhawkins@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","avi@chromium.org","phajdan.jr@chromium.org","jam@chromium.org","brettw-cc@chromium.org"],"text":"http://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker.h\nFile chrome/browser/ui/web_intent_picker.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/6003/chrome/browser/ui/web_intent_picker.h#newcode18\nchrome/browser/ui/web_intent_picker.h:18: class Delegate;\nOn 2011/08/17 19:07:36, binji wrote:\n> On 2011/08/17 01:54:05, James Hawkins wrote:\n> > Pull the Delegate out of the class into its own header.\n> \n> Is this necessary? It seems as though that would make it harder to understand\n> the role of the WebIntentPicker -- having the delegate in class lets you quickly\n> see that the picker takes input via SetService* and sends output via\n> OnServiceChosen/OnCancelled.\n> \n> Also, see plenty of examples of this:\n> http://www.google.com/codesearch#search/&type=cs&q=%255C:%255C:Delegate%2520file:%255C.h&exact_package=chromium\n\nHow does the delegate add documentation for WebIntentPicker?  It was decided on-list about a couple months ago that delegates and the like should be moved out of class scope for a few reasons, namely iwyu. Naming the class WebIntentPickerDelegate is enough of a semantic relationship to keep it from being confusing.  Yes, there are still examples in the code base that do this that haven't been fixed yet.\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/gtk/web_intent_picker_gtk.cc\nFile chrome/browser/ui/gtk/web_intent_picker_gtk.cc (right):\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode68\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:68: DCHECK(window_ == NULL) << \"Should have closed window before destroying.\";\nIn general I'm opposed to logging messages on DCHECKs, since the DCHECK should be self-documenting, but I'm not going to  ask you to take it out.\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/gtk/web_intent_picker_gtk.h\nFile chrome/browser/ui/gtk/web_intent_picker_gtk.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode16\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:16: #include \"chrome/browser/ui/gtk/constrained_window_gtk.h\"\nUse a forward declaration and remove the include.\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode69\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:69: // page, but we tell it when to destroy.\nDon't use 'we' in comments; it's ambiguous.\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/tab_contents/tab_contents_wrapper.h\nFile chrome/browser/ui/tab_contents/tab_contents_wrapper.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/tab_contents/tab_contents_wrapper.h#newcode329\nchrome/browser/ui/tab_contents/tab_contents_wrapper.h:329: // Handles displaying a web intents dialog to the user.\ns/dialog/picker/\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/web_intent_constrained_dialog_factory.h\nFile chrome/browser/ui/web_intent_constrained_dialog_factory.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/web_intent_constrained_dialog_factory.h#newcode16\nchrome/browser/ui/web_intent_constrained_dialog_factory.h:16: // A factory for creating a constrained dialog as the picker UI for a given\ns/picker/intent picker/\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/web_intent_constrained_dialog_factory.h#newcode21\nchrome/browser/ui/web_intent_constrained_dialog_factory.h:21: ~WebIntentConstrainedDialogFactory();\nvirtual\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/web_intent_constrained_dialog_factory.h#newcode33\nchrome/browser/ui/web_intent_constrained_dialog_factory.h:33: // A weak pointer to the currently active picker, or NULL.\nMight make for better docs to elucide: \"or NULL if there is no active picker.\"\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/web_intent_picker.h\nFile chrome/browser/ui/web_intent_picker.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/web_intent_picker.h#newcode15\nchrome/browser/ui/web_intent_picker.h:15: // Base class for the web intent dialog.\ns/dialog/picker/\n\nor 'picker dialog' would be fine.\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/web_intent_picker_controller.cc\nFile chrome/browser/ui/web_intent_picker_controller.cc (right):\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/web_intent_picker_controller.cc#newcode37\nchrome/browser/ui/web_intent_picker_controller.cc:37: } // namespace\nTwo spaces after last char and start of comment.\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/web_intent_picker_controller.cc#newcode42\nchrome/browser/ui/web_intent_picker_controller.cc:42: : public WebIntentsRegistry::Consumer {\n4 spaces? It's hard to tell.\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/web_intent_picker_controller.cc#newcode104\nchrome/browser/ui/web_intent_picker_controller.cc:104: : tab_contents_(tab_contents),\n4 space indentation from start of previous line.\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/web_intent_picker_controller.h\nFile chrome/browser/ui/web_intent_picker_controller.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/web_intent_picker_controller.h#newcode11\nchrome/browser/ui/web_intent_picker_controller.h:11: #include \"base/gtest_prod_util.h\"\nWhere is this include used?\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/chrome_browser.gypi\nFile chrome/chrome_browser.gypi (right):\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/chrome_browser.gypi#newcode3454\nchrome/chrome_browser.gypi:3454: 'browser/ui/web_intent_constrained_dialog_factory.cc',\nThese should be in a new subdir, intents.","disapproval":false,"date":"2011-08-17 21:23:33.350465","approval":false},{"sender":"binji@chromium.org","recipients":["binji@chromium.org","jhawkins@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","avi@chromium.org","phajdan.jr@chromium.org","jam@chromium.org","brettw-cc@chromium.org"],"text":"Sorry, this will be hard to diff. I moved the files from chrome/browser/ui -> chrome/browser/ui/intents, and also did a rebase.\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/gtk/web_intent_picker_gtk.cc\nFile chrome/browser/ui/gtk/web_intent_picker_gtk.cc (right):\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode68\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:68: DCHECK(window_ == NULL) << \"Should have closed window before destroying.\";\nOn 2011/08/17 21:23:33, James Hawkins wrote:\n> In general I'm opposed to logging messages on DCHECKs, since the DCHECK should\n> be self-documenting, but I'm not going to  ask you to take it out.\n\nOK.\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/gtk/web_intent_picker_gtk.h\nFile chrome/browser/ui/gtk/web_intent_picker_gtk.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode16\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:16: #include \"chrome/browser/ui/gtk/constrained_window_gtk.h\"\nOn 2011/08/17 21:23:33, James Hawkins wrote:\n> Use a forward declaration and remove the include.\n\nCan't forward declare because it is a base class. ConstrainedDialogDelegate is a typedef to ConstrainedWindowGtkDelegate.\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode69\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:69: // page, but we tell it when to destroy.\nOn 2011/08/17 21:23:33, James Hawkins wrote:\n> Don't use 'we' in comments; it's ambiguous.\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/tab_contents/tab_contents_wrapper.h\nFile chrome/browser/ui/tab_contents/tab_contents_wrapper.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/tab_contents/tab_contents_wrapper.h#newcode329\nchrome/browser/ui/tab_contents/tab_contents_wrapper.h:329: // Handles displaying a web intents dialog to the user.\nOn 2011/08/17 21:23:33, James Hawkins wrote:\n> s/dialog/picker/\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/web_intent_constrained_dialog_factory.h\nFile chrome/browser/ui/web_intent_constrained_dialog_factory.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/web_intent_constrained_dialog_factory.h#newcode16\nchrome/browser/ui/web_intent_constrained_dialog_factory.h:16: // A factory for creating a constrained dialog as the picker UI for a given\nOn 2011/08/17 21:23:33, James Hawkins wrote:\n> s/picker/intent picker/\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/web_intent_constrained_dialog_factory.h#newcode21\nchrome/browser/ui/web_intent_constrained_dialog_factory.h:21: ~WebIntentConstrainedDialogFactory();\nOn 2011/08/17 21:23:33, James Hawkins wrote:\n> virtual\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/web_intent_constrained_dialog_factory.h#newcode33\nchrome/browser/ui/web_intent_constrained_dialog_factory.h:33: // A weak pointer to the currently active picker, or NULL.\nOn 2011/08/17 21:23:33, James Hawkins wrote:\n> Might make for better docs to elucide: \"or NULL if there is no active picker.\"\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/web_intent_picker.h\nFile chrome/browser/ui/web_intent_picker.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/web_intent_picker.h#newcode15\nchrome/browser/ui/web_intent_picker.h:15: // Base class for the web intent dialog.\nOn 2011/08/17 21:23:33, James Hawkins wrote:\n> s/dialog/picker/\n> \n> or 'picker dialog' would be fine.\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/web_intent_picker_controller.cc\nFile chrome/browser/ui/web_intent_picker_controller.cc (right):\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/web_intent_picker_controller.cc#newcode37\nchrome/browser/ui/web_intent_picker_controller.cc:37: } // namespace\nOn 2011/08/17 21:23:33, James Hawkins wrote:\n> Two spaces after last char and start of comment.\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/web_intent_picker_controller.cc#newcode42\nchrome/browser/ui/web_intent_picker_controller.cc:42: : public WebIntentsRegistry::Consumer {\nOn 2011/08/17 21:23:33, James Hawkins wrote:\n> 4 spaces? It's hard to tell.\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/web_intent_picker_controller.cc#newcode104\nchrome/browser/ui/web_intent_picker_controller.cc:104: : tab_contents_(tab_contents),\nOn 2011/08/17 21:23:33, James Hawkins wrote:\n> 4 space indentation from start of previous line.\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/web_intent_picker_controller.h\nFile chrome/browser/ui/web_intent_picker_controller.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/browser/ui/web_intent_picker_controller.h#newcode11\nchrome/browser/ui/web_intent_picker_controller.h:11: #include \"base/gtest_prod_util.h\"\nOn 2011/08/17 21:23:33, James Hawkins wrote:\n> Where is this include used?\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/chrome_browser.gypi\nFile chrome/chrome_browser.gypi (right):\n\nhttp://codereview.chromium.org/7648061/diff/10001/chrome/chrome_browser.gypi#newcode3454\nchrome/chrome_browser.gypi:3454: 'browser/ui/web_intent_constrained_dialog_factory.cc',\nOn 2011/08/17 21:23:33, James Hawkins wrote:\n> These should be in a new subdir, intents.\n\nDone.","disapproval":false,"date":"2011-08-17 23:04:37.516305","approval":false},{"sender":"jhawkins@chromium.org","recipients":["binji@chromium.org","jhawkins@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","avi@chromium.org","phajdan.jr@chromium.org","jam@chromium.org","brettw-cc@chromium.org"],"text":"LGTM","disapproval":false,"date":"2011-08-17 23:11:52.755976","approval":true},{"sender":"binji@chromium.org","recipients":["binji@chromium.org","jhawkins@chromium.org","sky@chromium.org","estade@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","avi@chromium.org","phajdan.jr@chromium.org","jam@chromium.org","brettw-cc@chromium.org"],"text":"+sky chrome/browser/ui OWNER review\n+estade chrome/browser/ui/gtk OWNER review","disapproval":false,"date":"2011-08-17 23:23:49.150165","approval":false},{"sender":"sky@chromium.org","recipients":["binji@chromium.org","jhawkins@chromium.org","sky@chromium.org","estade@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","avi@chromium.org","phajdan.jr@chromium.org","jam@chromium.org","brettw-cc@chromium.org"],"text":"http://codereview.chromium.org/7648061/diff/11001/chrome/browser/ui/tab_contents/tab_contents_wrapper.cc\nFile chrome/browser/ui/tab_contents/tab_contents_wrapper.cc (right):\n\nhttp://codereview.chromium.org/7648061/diff/11001/chrome/browser/ui/tab_contents/tab_contents_wrapper.cc#newcode70\nchrome/browser/ui/tab_contents/tab_contents_wrapper.cc:70: #include \"content/browser/tab_contents/tab_contents_delegate.h\"\nDo you really need this include?","disapproval":false,"date":"2011-08-18 00:15:32.423775","approval":false},{"sender":"estade@chromium.org","recipients":["binji@chromium.org","jhawkins@chromium.org","sky@chromium.org","estade@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","avi@chromium.org","phajdan.jr@chromium.org","jam@chromium.org","brettw-cc@chromium.org"],"text":"http://codereview.chromium.org/7648061/diff/11001/chrome/browser/ui/gtk/web_intent_picker_gtk.cc\nFile chrome/browser/ui/gtk/web_intent_picker_gtk.cc (right):\n\nhttp://codereview.chromium.org/7648061/diff/11001/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode113\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:113: window_ = tab_contents_->CreateConstrainedDialog(this);\nthe delegate should not own the dialog. I'd prefer the pattern in ConstrainedHtmlDelegateGtk\n\nhttp://codereview.chromium.org/7648061/diff/11001/chrome/browser/ui/gtk/web_intent_picker_gtk.h\nFile chrome/browser/ui/gtk/web_intent_picker_gtk.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/11001/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode55\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:55: // A weak pointer to the  WebIntentPickerDelegate to notify when user\ns/the  /the /\n\nhttp://codereview.chromium.org/7648061/diff/11001/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode56\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:56: // chooses service or cancels.\nchooses a service","disapproval":false,"date":"2011-08-18 00:36:45.613857","approval":false},{"sender":"estade@chromium.org","recipients":["binji@chromium.org","jhawkins@chromium.org","sky@chromium.org","estade@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","avi@chromium.org","phajdan.jr@chromium.org","jam@chromium.org","brettw-cc@chromium.org"],"text":"gtk lgtm\n\nhttp://codereview.chromium.org/7648061/diff/11001/chrome/browser/ui/gtk/web_intent_picker_gtk.cc\nFile chrome/browser/ui/gtk/web_intent_picker_gtk.cc (right):\n\nhttp://codereview.chromium.org/7648061/diff/11001/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode96\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:96: gtk_image_new_from_pixbuf(icon_pixbuf));\nfits on one line\n\nhttp://codereview.chromium.org/7648061/diff/11001/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode107\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:107: gtk_button_set_image(GTK_BUTTON(button),\ndon't need GTK_BUTTON here; fits on one line","disapproval":false,"date":"2011-08-19 00:06:15.487487","approval":true},{"sender":"binji@chromium.org","recipients":["binji@chromium.org","jhawkins@chromium.org","sky@chromium.org","estade@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","avi@chromium.org","phajdan.jr@chromium.org","jam@chromium.org","brettw-cc@chromium.org"],"text":"http://codereview.chromium.org/7648061/diff/11001/chrome/browser/ui/gtk/web_intent_picker_gtk.cc\nFile chrome/browser/ui/gtk/web_intent_picker_gtk.cc (right):\n\nhttp://codereview.chromium.org/7648061/diff/11001/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode96\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:96: gtk_image_new_from_pixbuf(icon_pixbuf));\nOn 2011/08/19 00:06:15, Evan Stade wrote:\n> fits on one line\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/11001/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode107\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:107: gtk_button_set_image(GTK_BUTTON(button),\nOn 2011/08/19 00:06:15, Evan Stade wrote:\n> don't need GTK_BUTTON here; fits on one line\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/11001/chrome/browser/ui/gtk/web_intent_picker_gtk.cc#newcode113\nchrome/browser/ui/gtk/web_intent_picker_gtk.cc:113: window_ = tab_contents_->CreateConstrainedDialog(this);\nOn 2011/08/18 00:36:45, Evan Stade wrote:\n> the delegate should not own the dialog. I'd prefer the pattern in\n> ConstrainedHtmlDelegateGtk\n\nEvan and I talked about this; it's simpler to leave as is.\n\nhttp://codereview.chromium.org/7648061/diff/11001/chrome/browser/ui/gtk/web_intent_picker_gtk.h\nFile chrome/browser/ui/gtk/web_intent_picker_gtk.h (right):\n\nhttp://codereview.chromium.org/7648061/diff/11001/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode55\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:55: // A weak pointer to the  WebIntentPickerDelegate to notify when user\nOn 2011/08/18 00:36:45, Evan Stade wrote:\n> s/the  /the /\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/11001/chrome/browser/ui/gtk/web_intent_picker_gtk.h#newcode56\nchrome/browser/ui/gtk/web_intent_picker_gtk.h:56: // chooses service or cancels.\nOn 2011/08/18 00:36:45, Evan Stade wrote:\n> chooses a service\n\nDone.\n\nhttp://codereview.chromium.org/7648061/diff/11001/chrome/browser/ui/tab_contents/tab_contents_wrapper.cc\nFile chrome/browser/ui/tab_contents/tab_contents_wrapper.cc (right):\n\nhttp://codereview.chromium.org/7648061/diff/11001/chrome/browser/ui/tab_contents/tab_contents_wrapper.cc#newcode70\nchrome/browser/ui/tab_contents/tab_contents_wrapper.cc:70: #include \"content/browser/tab_contents/tab_contents_delegate.h\"\nOn 2011/08/18 00:15:32, sky wrote:\n> Do you really need this include?\n\nDone.","disapproval":false,"date":"2011-08-19 17:55:03.626471","approval":false},{"sender":"sky@chromium.org","recipients":["binji@chromium.org","jhawkins@chromium.org","sky@chromium.org","estade@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","avi@chromium.org","phajdan.jr@chromium.org","jam@chromium.org","brettw-cc@chromium.org"],"text":"LGTM","disapproval":false,"date":"2011-08-19 19:20:23.416776","approval":true},{"sender":"binji@chromium.org","recipients":["binji@chromium.org","jhawkins@chromium.org","sky@chromium.org","estade@chromium.org","pinkerton@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","avi@chromium.org","phajdan.jr@chromium.org","jam@chromium.org","brettw-cc@chromium.org"],"text":"+pinkerton OWNERS review for chrome/browser/ui/cocoa.\n\nIt's just a stub for now.","disapproval":false,"date":"2011-08-23 01:32:53.435936","approval":false},{"sender":"pinkerton@chromium.org","recipients":["binji@chromium.org","jhawkins@chromium.org","sky@chromium.org","estade@chromium.org","pinkerton@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","avi@chromium.org","phajdan.jr@chromium.org","jam@chromium.org","brettw-cc@chromium.org"],"text":"LGTM\n\nIs there a bug # you can put on the Mac/Win stubs in the TODO? That will allow anyone who finds the stub to check the progress.","disapproval":false,"date":"2011-08-23 16:23:24.452379","approval":true},{"sender":"commit-bot@chromium.org","recipients":["binji@chromium.org","jhawkins@chromium.org","sky@chromium.org","estade@chromium.org","pinkerton@chromium.org","commit-bot@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","avi@chromium.org","phajdan.jr@chromium.org","jam@chromium.org","brettw-cc@chromium.org"],"text":"Change committed as 97990","disapproval":false,"date":"2011-08-24 04:59:00.738339","approval":false},{"sender":"thakis@chromium.org","recipients":["binji@chromium.org","jhawkins@chromium.org","sky@chromium.org","estade@chromium.org","pinkerton@chromium.org","commit-bot@chromium.org","thakis@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","avi@chromium.org","phajdan.jr@chromium.org","jam@chromium.org","brettw-cc@chromium.org"],"text":"Can you file a feature tracking bug for web intents and use that for future web intent CLs please?","disapproval":false,"date":"2011-09-07 04:41:46.980265","approval":false},{"sender":"jhawkins@chromium.org","recipients":["binji@chromium.org","jhawkins@chromium.org","sky@chromium.org","estade@chromium.org","pinkerton@chromium.org","commit-bot@chromium.org","thakis@chromium.org","chromium-reviews@chromium.org","joi+watch-content@chromium.org","avi@chromium.org","phajdan.jr@chromium.org","jam@chromium.org","brettw-cc@chromium.org"],"text":"On 2011/09/07 04:41:46, Nico wrote:\n> Can you file a feature tracking bug for web intents and use that for future web\n> intent CLs please?\n\ncrbug.com/90458","disapproval":false,"date":"2011-09-07 17:15:17.161755","approval":false}],"owner_email":"binji@chromium.org","private":false,"base_url":"http://git.chromium.org/git/chromium.git@trunk","owner":"binji","subject":"Web Intent Picker UI (implemented as a constrained dialog, linux only)","created":"2011-08-16 20:09:24.448386","patchsets":[1,7002,6003,5022,10001,11001,8013,14001,19001,20018],"modified":"2011-09-07 17:15:17.481634","closed":true,"commit":false,"issue":7648061}
{"description":"Convert chromeos::CryptohomeClient::TpmCanAttemptOwnership to asynchronous\n\nBUG=126674\nTEST=git try -b linux_chromeos\n\n\nCommitted: http://src.chromium.org/viewvc/chrome?view=rev&revision=149136","cc":["chromium-reviews@chromium.org","oshima+watch@chromium.org","stevenjb+watch@chromium.org","nkostylev+watch@chromium.org","davemoore+watch@chromium.org"],"reviewers":["stevenjb@chromium.org"],"messages":[{"sender":"hashimoto@chromium.org","recipients":["hashimoto@chromium.org","stevenjb@chromium.org","chromium-reviews@chromium.org","oshima+watch@chromium.org","stevenjb+watch@chromium.org","nkostylev+watch@chromium.org","davemoore+watch@chromium.org"],"text":"","disapproval":false,"date":"2012-07-26 07:57:16.747000","approval":false},{"sender":"stevenjb@chromium.org","recipients":["hashimoto@chromium.org","stevenjb@chromium.org","chromium-reviews@chromium.org","oshima+watch@chromium.org","stevenjb+watch@chromium.org","nkostylev+watch@chromium.org","davemoore+watch@chromium.org"],"text":"http://codereview.chromium.org/10830033/diff/1/chrome/browser/chromeos/cros/cryptohome_library.cc\nFile chrome/browser/chromeos/cros/cryptohome_library.cc (right):\n\nhttp://codereview.chromium.org/10830033/diff/1/chrome/browser/chromeos/cros/cryptohome_library.cc#newcode23\nchrome/browser/chromeos/cros/cryptohome_library.cc:23: void DoNothing(DBusMethodCallStatus call_status) {}\nShould we consider adding this where DBusMethodCallStatus is defined? Haven't we defined this same function elsewhere?\n\nhttp://codereview.chromium.org/10830033/diff/1/chromeos/dbus/cryptohome_client.h\nFile chromeos/dbus/cryptohome_client.h (right):\n\nhttp://codereview.chromium.org/10830033/diff/1/chromeos/dbus/cryptohome_client.h#newcode35\nchromeos/dbus/cryptohome_client.h:35: DBusMethodCallStatus call_status)> VoidMethodCallback;\nThis and the two callbacks below seem generic enough to be defined with DBusMethodCallStatus?\n\nhttp://codereview.chromium.org/10830033/diff/1/chromeos/dbus/cryptohome_client.h#newcode129\nchromeos/dbus/cryptohome_client.h:129: virtual void TpmCanAttemptOwnership(const VoidMethodCallback& callback) = 0;\nI'm confused about what this method does. It looks like it should return whether or not we can attempt ownership, but in that case shouldn't the callback pass a bool? Or does it tell cryptohome that it is OK to attempt ownership, in which case we should rename this to something like SetTpmCanAttemptOwnership.","disapproval":false,"date":"2012-07-26 17:19:52.183860","approval":false},{"sender":"hashimoto@chromium.org","recipients":["hashimoto@chromium.org","stevenjb@chromium.org","chromium-reviews@chromium.org","oshima+watch@chromium.org","stevenjb+watch@chromium.org","nkostylev+watch@chromium.org","davemoore+watch@chromium.org"],"text":"http://codereview.chromium.org/10830033/diff/1/chrome/browser/chromeos/cros/cryptohome_library.cc\nFile chrome/browser/chromeos/cros/cryptohome_library.cc (right):\n\nhttp://codereview.chromium.org/10830033/diff/1/chrome/browser/chromeos/cros/cryptohome_library.cc#newcode23\nchrome/browser/chromeos/cros/cryptohome_library.cc:23: void DoNothing(DBusMethodCallStatus call_status) {}\nOn 2012/07/26 17:19:52, stevenjb (chromium) wrote:\n> Should we consider adding this where DBusMethodCallStatus is defined? Haven't we\n> defined this same function elsewhere?\nWe're having the exactly same function in cros_network_functions.cc.\nWill do in a separate patch.\n\nhttp://codereview.chromium.org/10830033/diff/1/chromeos/dbus/cryptohome_client.h\nFile chromeos/dbus/cryptohome_client.h (right):\n\nhttp://codereview.chromium.org/10830033/diff/1/chromeos/dbus/cryptohome_client.h#newcode35\nchromeos/dbus/cryptohome_client.h:35: DBusMethodCallStatus call_status)> VoidMethodCallback;\nOn 2012/07/26 17:19:52, stevenjb (chromium) wrote:\n> This and the two callbacks below seem generic enough to be defined with\n> DBusMethodCallStatus?\n\nSounds good, will do in a separate patch.\n\nhttp://codereview.chromium.org/10830033/diff/1/chromeos/dbus/cryptohome_client.h#newcode129\nchromeos/dbus/cryptohome_client.h:129: virtual void TpmCanAttemptOwnership(const VoidMethodCallback& callback) = 0;\nOn 2012/07/26 17:19:52, stevenjb (chromium) wrote:\n> I'm confused about what this method does. It looks like it should return whether\n> or not we can attempt ownership, but in that case shouldn't the callback pass a\n> bool? Or does it tell cryptohome that it is OK to attempt ownership, in which\n> case we should rename this to something like SetTpmCanAttemptOwnership.\nLooks like your latter guess is correct. (http://git.chromium.org/gitweb/?p=chromiumos/platform/cryptohome.git;a=blob;f=service.cc;h=e27e2f087da4e96c315a49b052dea1f0d2e146a6;hb=refs/heads/master#l954)\nThis method is named badly from the beginning, I think it should be renamed to something like MyabeStartInitializeTpm().\nAnyway, I'm using the name \"TpmCanAttemptOwnership\" because the Cryptohome service is providing the method with this name.\nIf we are going to rename this method, we should also rename Cryptohome service's method name too.","disapproval":false,"date":"2012-07-27 04:37:18.726020","approval":false},{"sender":"stevenjb@chromium.org","recipients":["hashimoto@chromium.org","stevenjb@chromium.org","chromium-reviews@chromium.org","oshima+watch@chromium.org","stevenjb+watch@chromium.org","nkostylev+watch@chromium.org","davemoore+watch@chromium.org"],"text":"LGTM\n\nhttp://codereview.chromium.org/10830033/diff/1/chrome/browser/chromeos/cros/cryptohome_library.cc\nFile chrome/browser/chromeos/cros/cryptohome_library.cc (right):\n\nhttp://codereview.chromium.org/10830033/diff/1/chrome/browser/chromeos/cros/cryptohome_library.cc#newcode23\nchrome/browser/chromeos/cros/cryptohome_library.cc:23: void DoNothing(DBusMethodCallStatus call_status) {}\nSounds good.\n\nhttp://codereview.chromium.org/10830033/diff/1/chromeos/dbus/cryptohome_client.h\nFile chromeos/dbus/cryptohome_client.h (right):\n\nhttp://codereview.chromium.org/10830033/diff/1/chromeos/dbus/cryptohome_client.h#newcode129\nchromeos/dbus/cryptohome_client.h:129: virtual void TpmCanAttemptOwnership(const VoidMethodCallback& callback) = 0;\nOK, I see. That is definitely badly named. Can you at least comment what it does and/or include the link?","disapproval":false,"date":"2012-07-30 22:24:38.434400","approval":true},{"sender":"hashimoto@chromium.org","recipients":["hashimoto@chromium.org","stevenjb@chromium.org","chromium-reviews@chromium.org","oshima+watch@chromium.org","stevenjb+watch@chromium.org","nkostylev+watch@chromium.org","davemoore+watch@chromium.org"],"text":"http://codereview.chromium.org/10830033/diff/1/chromeos/dbus/cryptohome_client.h\nFile chromeos/dbus/cryptohome_client.h (right):\n\nhttp://codereview.chromium.org/10830033/diff/1/chromeos/dbus/cryptohome_client.h#newcode129\nchromeos/dbus/cryptohome_client.h:129: virtual void TpmCanAttemptOwnership(const VoidMethodCallback& callback) = 0;\nOn 2012/07/30 22:24:38, stevenjb (chromium) wrote:\n> OK, I see. That is definitely badly named. Can you at least comment what it does\n> and/or include the link?\n\nAdded a comment.","disapproval":false,"date":"2012-07-31 02:27:34.078820","approval":false},{"sender":"commit-bot@chromium.org","recipients":["hashimoto@chromium.org","stevenjb@chromium.org","chromium-reviews@chromium.org","oshima+watch@chromium.org","stevenjb+watch@chromium.org","nkostylev+watch@chromium.org","davemoore+watch@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/hashimoto@chromium.org/10830033/9001","disapproval":false,"date":"2012-07-31 02:29:01.726430","approval":false},{"sender":"commit-bot@chromium.org","recipients":["hashimoto@chromium.org","stevenjb@chromium.org","chromium-reviews@chromium.org","oshima+watch@chromium.org","stevenjb+watch@chromium.org","nkostylev+watch@chromium.org","davemoore+watch@chromium.org"],"text":"Change committed as 149136","disapproval":false,"date":"2012-07-31 04:13:39.467850","approval":false}],"owner_email":"hashimoto@chromium.org","private":false,"base_url":"svn://svn.chromium.org/chrome/trunk/src","owner":"hashimoto","subject":"Convert chromeos::CryptohomeClient::TpmCanAttemptOwnership to asynchronous","created":"2012-07-26 07:23:57.187760","patchsets":[1,8001,9001],"modified":"2012-07-31 04:13:39.622610","closed":true,"commit":false,"issue":10830033}
{"description":"cc: Chromify TextureLayer and test\n\nR=danakj@chromium.org\nBUG=none\n\n\nCommitted: https://src.chromium.org/viewvc/chrome?view=rev&revision=188018","cc":["chromium-reviews@chromium.org","backer@chromium.org","vollick@chromium.org","jam@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","piman+watch@chromium.org","cc-bugs@chromium.org","timvolodine@chromium.org","clholgat@chromium.org"],"reviewers":["danakj@chromium.org","piman@chromium.org","aelias@chromium.org","jamesr@google.com"],"messages":[{"sender":"enne@chromium.org","recipients":["enne@chromium.org","danakj@chromium.org","chromium-reviews@chromium.org","backer@chromium.org","vollick@chromium.org","jam@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","piman+watch@chromium.org","cc-bugs@chromium.org"],"text":"","disapproval":false,"date":"2013-03-13 01:07:37.736040","approval":false},{"sender":"danakj@chromium.org","recipients":["enne@chromium.org","danakj@chromium.org","chromium-reviews@chromium.org","backer@chromium.org","vollick@chromium.org","jam@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","piman+watch@chromium.org","cc-bugs@chromium.org"],"text":"LGTM\n\nhttps://codereview.chromium.org/12777004/diff/1/cc/texture_layer.cc\nFile cc/texture_layer.cc (right):\n\nhttps://codereview.chromium.org/12777004/diff/1/cc/texture_layer.cc#newcode34\ncc/texture_layer.cc:34: return scoped_refptr<TextureLayer>(new TextureLayer(0, true));\nNULL\n\nhttps://codereview.chromium.org/12777004/diff/1/cc/texture_layer.cc#newcode158\ncc/texture_layer.cc:158: const OcclusionTracker*,\nocclusion\n\nhttps://codereview.chromium.org/12777004/diff/1/cc/texture_layer.cc#newcode159\ncc/texture_layer.cc:159: RenderingStats*) {\nstats\n\nhttps://codereview.chromium.org/12777004/diff/1/cc/texture_layer.h\nFile cc/texture_layer.h (right):\n\nhttps://codereview.chromium.org/12777004/diff/1/cc/texture_layer.h#newcode32\ncc/texture_layer.h:32: void ClearClient() { client_ = 0; }\nNULL\n\nhttps://codereview.chromium.org/12777004/diff/1/cc/texture_layer.h#newcode73\ncc/texture_layer.h:73: const OcclusionTracker* tracker,\nthis is |occlusion| in most classes\n\nhttps://codereview.chromium.org/12777004/diff/1/cc/texture_layer.h#newcode101\ncc/texture_layer.h:101: };\nDISALLOW_C_A_A?\n\nhttps://codereview.chromium.org/12777004/diff/1/cc/texture_layer_unittest.cc\nFile cc/texture_layer_unittest.cc (right):\n\nhttps://codereview.chromium.org/12777004/diff/1/cc/texture_layer_unittest.cc#newcode93\ncc/texture_layer_unittest.cc:93: gfx::RectF dirty_rect(0, 0, 1, 1);\nfloats\n\nhttps://codereview.chromium.org/12777004/diff/1/cc/texture_layer_unittest.cc#newcode222\ncc/texture_layer_unittest.cc:222: Release(test_data_.mailbox_name1_, test_data_.sync_point1_))\ncan you break at the , and put the .Times() on the same line for all of these?\n\nhttps://codereview.chromium.org/12777004/diff/1/webkit/compositor_bindings/web_external_texture_layer_impl.cc\nFile webkit/compositor_bindings/web_external_texture_layer_impl.cc (right):\n\nhttps://codereview.chromium.org/12777004/diff/1/webkit/compositor_bindings/web_external_texture_layer_impl.cc#newcode45\nwebkit/compositor_bindings/web_external_texture_layer_impl.cc:45: static_cast<TextureLayer*>(layer_->layer())->\nplease wrap this better while you're here\n\nhttps://codereview.chromium.org/12777004/diff/1/webkit/compositor_bindings/web_external_texture_layer_impl.cc#newcode56\nwebkit/compositor_bindings/web_external_texture_layer_impl.cc:56: static_cast<TextureLayer*>(layer_->layer())->\nand here","disapproval":false,"date":"2013-03-13 02:11:12.699850","approval":true},{"sender":"enne@chromium.org","recipients":["enne@chromium.org","danakj@chromium.org","chromium-reviews@chromium.org","backer@chromium.org","vollick@chromium.org","jam@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","piman+watch@chromium.org","cc-bugs@chromium.org"],"text":"Thanks.  I rebased this on top of your LTH patch so it wouldn't conflict.\n\nhttps://codereview.chromium.org/12777004/diff/1/cc/texture_layer.cc\nFile cc/texture_layer.cc (right):\n\nhttps://codereview.chromium.org/12777004/diff/1/cc/texture_layer.cc#newcode34\ncc/texture_layer.cc:34: return scoped_refptr<TextureLayer>(new TextureLayer(0, true));\nOn 2013/03/13 02:11:12, danakj wrote:\n> NULL\n\nDone.\n\nhttps://codereview.chromium.org/12777004/diff/1/cc/texture_layer.cc#newcode158\ncc/texture_layer.cc:158: const OcclusionTracker*,\nOn 2013/03/13 02:11:12, danakj wrote:\n> occlusion\n\nDone.\n\nhttps://codereview.chromium.org/12777004/diff/1/cc/texture_layer.cc#newcode159\ncc/texture_layer.cc:159: RenderingStats*) {\nOn 2013/03/13 02:11:12, danakj wrote:\n> stats\n\nDone.\n\nhttps://codereview.chromium.org/12777004/diff/1/cc/texture_layer.h\nFile cc/texture_layer.h (right):\n\nhttps://codereview.chromium.org/12777004/diff/1/cc/texture_layer.h#newcode32\ncc/texture_layer.h:32: void ClearClient() { client_ = 0; }\nOn 2013/03/13 02:11:12, danakj wrote:\n> NULL\n\nDone.\n\nhttps://codereview.chromium.org/12777004/diff/1/cc/texture_layer.h#newcode73\ncc/texture_layer.h:73: const OcclusionTracker* tracker,\nOn 2013/03/13 02:11:12, danakj wrote:\n> this is |occlusion| in most classes\n\nDone.\n\nhttps://codereview.chromium.org/12777004/diff/1/cc/texture_layer.h#newcode101\ncc/texture_layer.h:101: };\nOn 2013/03/13 02:11:12, danakj wrote:\n> DISALLOW_C_A_A?\n\nDone.\n\nhttps://codereview.chromium.org/12777004/diff/1/cc/texture_layer_unittest.cc\nFile cc/texture_layer_unittest.cc (right):\n\nhttps://codereview.chromium.org/12777004/diff/1/cc/texture_layer_unittest.cc#newcode93\ncc/texture_layer_unittest.cc:93: gfx::RectF dirty_rect(0, 0, 1, 1);\nOn 2013/03/13 02:11:12, danakj wrote:\n> floats\n\nDone.\n\nhttps://codereview.chromium.org/12777004/diff/1/cc/texture_layer_unittest.cc#newcode222\ncc/texture_layer_unittest.cc:222: Release(test_data_.mailbox_name1_, test_data_.sync_point1_))\nOn 2013/03/13 02:11:12, danakj wrote:\n> can you break at the , and put the .Times() on the same line for all of these?\n\nDone.\n\nhttps://codereview.chromium.org/12777004/diff/1/webkit/compositor_bindings/web_external_texture_layer_impl.cc\nFile webkit/compositor_bindings/web_external_texture_layer_impl.cc (right):\n\nhttps://codereview.chromium.org/12777004/diff/1/webkit/compositor_bindings/web_external_texture_layer_impl.cc#newcode45\nwebkit/compositor_bindings/web_external_texture_layer_impl.cc:45: static_cast<TextureLayer*>(layer_->layer())->\nOn 2013/03/13 02:11:12, danakj wrote:\n> please wrap this better while you're here\n\nDone.\n\nhttps://codereview.chromium.org/12777004/diff/1/webkit/compositor_bindings/web_external_texture_layer_impl.cc#newcode56\nwebkit/compositor_bindings/web_external_texture_layer_impl.cc:56: static_cast<TextureLayer*>(layer_->layer())->\nOn 2013/03/13 02:11:12, danakj wrote:\n> and here\n\nDone.","disapproval":false,"date":"2013-03-13 04:14:11.069830","approval":false},{"sender":"commit-bot@chromium.org","recipients":["enne@chromium.org","danakj@chromium.org","chromium-reviews@chromium.org","backer@chromium.org","vollick@chromium.org","jam@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","piman+watch@chromium.org","cc-bugs@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/enne@chromium.org/12777004/10001","disapproval":false,"date":"2013-03-13 19:05:05.867500","approval":false},{"sender":"commit-bot@chromium.org","recipients":["enne@chromium.org","danakj@chromium.org","chromium-reviews@chromium.org","backer@chromium.org","vollick@chromium.org","jam@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","piman+watch@chromium.org","cc-bugs@chromium.org"],"text":"Failed to apply patch for webkit/plugins/ppapi/ppapi_plugin_instance.cc:\nWhile running patch -p1 --forward --force --no-backup-if-mismatch;\n  patching file webkit/plugins/ppapi/ppapi_plugin_instance.cc\n  Hunk #1 FAILED at 1708.\n  1 out of 1 hunk FAILED -- saving rejects to file webkit/plugins/ppapi/ppapi_plugin_instance.cc.rej\n\nPatch:       webkit/plugins/ppapi/ppapi_plugin_instance.cc\nIndex: webkit/plugins/ppapi/ppapi_plugin_instance.cc\ndiff --git a/webkit/plugins/ppapi/ppapi_plugin_instance.cc b/webkit/plugins/ppapi/ppapi_plugin_instance.cc\nindex c9da4627b1d6358fb3b176cef12594b36f2abff4..642e9239ea19e5cc244da95af76c710ecea45c4d 100644\n--- a/webkit/plugins/ppapi/ppapi_plugin_instance.cc\n+++ b/webkit/plugins/ppapi/ppapi_plugin_instance.cc\n@@ -1708,8 +1708,8 @@ void PluginInstance::UpdateLayer() {\n     return;\n \n   if (!want_layer) {\n-    texture_layer_->willModifyTexture();\n-    texture_layer_->clearClient();\n+    texture_layer_->WillModifyTexture();\n+    texture_layer_->ClearClient();\n     container_->setWebLayer(NULL);\n     web_layer_.reset();\n     texture_layer_ = NULL;","disapproval":false,"date":"2013-03-13 19:05:11.186500","approval":false},{"sender":"commit-bot@chromium.org","recipients":["enne@chromium.org","danakj@chromium.org","chromium-reviews@chromium.org","backer@chromium.org","vollick@chromium.org","jam@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","piman+watch@chromium.org","cc-bugs@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/enne@chromium.org/12777004/14001","disapproval":false,"date":"2013-03-13 20:33:06.395360","approval":false},{"sender":"commit-bot@chromium.org","recipients":["enne@chromium.org","danakj@chromium.org","chromium-reviews@chromium.org","backer@chromium.org","vollick@chromium.org","jam@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","piman+watch@chromium.org","cc-bugs@chromium.org"],"text":"Presubmit check for 12777004-14001 failed and returned exit status 1.\n\nINFO:root:Found 8 file(s).\n\nRunning presubmit commit checks ...\nRunning /b/commit-queue/workdir/chromium/PRESUBMIT.py\nRunning /b/commit-queue/workdir/chromium/cc/PRESUBMIT.py\nRunning /b/commit-queue/workdir/chromium/ui/compositor/PRESUBMIT.py\n\n** Presubmit ERRORS **\nMissing LGTM from an OWNER for these files:\n    webkit/plugins/ppapi/ppapi_plugin_instance.cc\n    content/renderer/browser_plugin/browser_plugin_compositing_helper.cc\n    ui/compositor/layer.cc\n\nPresubmit checks took 1.1s to calculate.\n\nWas the presubmit check useful? Please send feedback & hate mail to maruel@chromium.org!","disapproval":false,"date":"2013-03-13 20:33:13.128910","approval":false},{"sender":"enne@chromium.org","recipients":["enne@chromium.org","danakj@chromium.org","piman@chromium.org","chromium-reviews@chromium.org","backer@chromium.org","vollick@chromium.org","jam@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","piman+watch@chromium.org","cc-bugs@chromium.org"],"text":"+piman for OWNERS","disapproval":false,"date":"2013-03-13 20:36:38.953750","approval":false},{"sender":"piman@chromium.org","recipients":["enne@chromium.org","danakj@chromium.org","piman@chromium.org","chromium-reviews@chromium.org","backer@chromium.org","vollick@chromium.org","jam@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","piman+watch@chromium.org","cc-bugs@chromium.org"],"text":"lgtm","disapproval":false,"date":"2013-03-13 20:37:46.002350","approval":true},{"sender":"commit-bot@chromium.org","recipients":["enne@chromium.org","danakj@chromium.org","piman@chromium.org","chromium-reviews@chromium.org","backer@chromium.org","vollick@chromium.org","jam@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","piman+watch@chromium.org","cc-bugs@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/enne@chromium.org/12777004/14001","disapproval":false,"date":"2013-03-13 20:44:58.572460","approval":false},{"sender":"commit-bot@chromium.org","recipients":["enne@chromium.org","danakj@chromium.org","piman@chromium.org","chromium-reviews@chromium.org","backer@chromium.org","vollick@chromium.org","jam@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","piman+watch@chromium.org","cc-bugs@chromium.org"],"text":"Sorry for I got bad news for ya.\nCompile failed with a clobber build on android_dbg.\nhttp://build.chromium.org/p/tryserver.chromium/buildstatus?builder=android_dbg&number=44018\nYour code is likely broken or HEAD is junk. Please ensure your\ncode is not broken then alert the build sheriffs.\nLook at the try server FAQ for more details.","disapproval":false,"date":"2013-03-13 21:32:53.890400","approval":false},{"sender":"enne@chromium.org","recipients":["enne@chromium.org","danakj@chromium.org","piman@chromium.org","aelias@chromium.org","chromium-reviews@chromium.org","backer@chromium.org","vollick@chromium.org","jam@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","piman+watch@chromium.org","cc-bugs@chromium.org"],"text":"+aelias for content/browser/renderer_host/ OWNERS","disapproval":false,"date":"2013-03-13 21:39:01.237110","approval":false},{"sender":"aelias@chromium.org","recipients":["enne@chromium.org","danakj@chromium.org","piman@chromium.org","aelias@chromium.org","chromium-reviews@chromium.org","backer@chromium.org","vollick@chromium.org","jam@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","piman+watch@chromium.org","cc-bugs@chromium.org","timvolodine@chromium.org","clholgat@chromium.org","dtrainor@chromium.org"],"text":"lgtm\n\nFYI (not that we should block landing this on that), this will break the Android private repo again as there are uses of TextureLayer there (should be the last cleanup to significantly do so).  ccing timvolodine@ who is the current gardener, and clholgat@ and dtrainor@ who are familiar with the relevant code.","disapproval":false,"date":"2013-03-13 22:23:33.277850","approval":true},{"sender":"jamesr@google.com","recipients":["reply@chromiumcodereview-hr.appspotmail.com"],"text":"On Wed, Mar 13, 2013 at 3:23 PM, <aelias@chromium.org> wrote:\r\n\r\n> lgtm\r\n>\r\n> FYI (not that we should block landing this on that), this will break the\r\n> Android\r\n> private repo again as there are uses of TextureLayer there (should be the\r\n> last\r\n> cleanup to significantly do so).  ccing timvolodine@ who is the current\r\n> gardener, and clholgat@ and dtrainor@ who are familiar with the relevant\r\n> code.\r\n>\r\n\r\nSo will every patch to cc/ and base/ and media/ and pretty much everything\r\nelse.\r\n\r\n>\r\n> https://chromiumcodereview.**appspot.com/12777004/<https://chromiumcodereview.appspot.com/12777004/>\r\n>\r\n","disapproval":false,"date":"2013-03-13 22:24:43.716750","approval":false},{"sender":"commit-bot@chromium.org","recipients":["enne@chromium.org","danakj@chromium.org","piman@chromium.org","aelias@chromium.org","jamesr@google.com","chromium-reviews@chromium.org","backer@chromium.org","vollick@chromium.org","jam@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","piman+watch@chromium.org","cc-bugs@chromium.org","timvolodine@chromium.org","clholgat@chromium.org","dtrainor@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/enne@chromium.org/12777004/31001","disapproval":false,"date":"2013-03-13 22:27:47.541860","approval":false},{"sender":"dtrainor@chromium.org","recipients":["enne@chromium.org","danakj@chromium.org","piman@chromium.org","aelias@chromium.org","jamesr@google.com","chromium-reviews@chromium.org","backer@chromium.org","vollick@chromium.org","jam@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","piman+watch@chromium.org","cc-bugs@chromium.org","timvolodine@chromium.org","clholgat@chromium.org"],"text":"On 2013/03/13 22:24:43, jamesr1 wrote:\n> On Wed, Mar 13, 2013 at 3:23 PM, <mailto:aelias@chromium.org> wrote:\n> \n> > lgtm\n> >\n> > FYI (not that we should block landing this on that), this will break the\n> > Android\n> > private repo again as there are uses of TextureLayer there (should be the\n> > last\n> > cleanup to significantly do so).  ccing timvolodine@ who is the current\n> > gardener, and clholgat@ and dtrainor@ who are familiar with the relevant\n> > code.\n> >\n> \n> So will every patch to cc/ and base/ and media/ and pretty much everything\n> else.\n\nTouche...\n\n> \n> >\n> >\n> https://chromiumcodereview.**appspot.com/12777004/%3Chttps://chromiumcodereview.appspot.com/12777004/>\n> >","disapproval":false,"date":"2013-03-13 22:41:18.356100","approval":false},{"sender":"commit-bot@chromium.org","recipients":["enne@chromium.org","danakj@chromium.org","piman@chromium.org","aelias@chromium.org","jamesr@google.com","chromium-reviews@chromium.org","backer@chromium.org","vollick@chromium.org","jam@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","piman+watch@chromium.org","cc-bugs@chromium.org","timvolodine@chromium.org","clholgat@chromium.org"],"text":"Step \"update\" is always a major failure.\nLook at the try server FAQ for more details.\nhttp://build.chromium.org/p/tryserver.chromium/buildstatus?builder=linux_clang&number=90916","disapproval":false,"date":"2013-03-13 22:54:36.054950","approval":false},{"sender":"commit-bot@chromium.org","recipients":["enne@chromium.org","danakj@chromium.org","piman@chromium.org","aelias@chromium.org","jamesr@google.com","chromium-reviews@chromium.org","backer@chromium.org","vollick@chromium.org","jam@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","piman+watch@chromium.org","cc-bugs@chromium.org","timvolodine@chromium.org","clholgat@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/enne@chromium.org/12777004/31001","disapproval":false,"date":"2013-03-13 23:16:14.888640","approval":false},{"sender":"commit-bot@chromium.org","recipients":["enne@chromium.org","danakj@chromium.org","piman@chromium.org","aelias@chromium.org","jamesr@google.com","chromium-reviews@chromium.org","backer@chromium.org","vollick@chromium.org","jam@chromium.org","joi+watch-content@chromium.org","darin-cc@chromium.org","piman+watch@chromium.org","cc-bugs@chromium.org","timvolodine@chromium.org","clholgat@chromium.org"],"text":"Change committed as 188018","disapproval":false,"date":"2013-03-14 07:59:18.053240","approval":false}],"owner_email":"enne@chromium.org","private":false,"base_url":"svn://svn.chromium.org/chrome/trunk/src","owner":"enne","subject":"cc: Chromify TextureLayer and test","created":"2013-03-13 01:07:31.330140","patchsets":[1,7001,10001,14001,31001],"modified":"2013-03-14 07:59:18.293580","closed":true,"commit":false,"issue":12777004}
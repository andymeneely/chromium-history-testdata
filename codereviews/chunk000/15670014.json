{"description":"[rAC] Added handling for suggestions.\n\nrequestAutocomplete has sections for \"suggested\" data - i.e. results\nselected from Autocomplete.\n\nThis handles the display of and interaction with those sections.\n\nBUG=157274\nR=sail@chromium.org\n\nCommitted: https://src.chromium.org/viewvc/chrome?view=rev&revision=204584","cc":["chromium-reviews@chromium.org","ramankk@chromium.org","benquan@chromium.org","ahutter@chromium.org","dbeam+watch-autofill@chromium.org","sail+watch@chromium.org","dgwallinga@chromium.org","dyu@chromium.org","estade+watch@chromium.org","abodenha@chromium.org","isherman@chromium.org"],"reviewers":["sail@chromium.org"],"messages":[{"sender":"groby@chromium.org","recipients":["groby@chromium.org","sail@chromium.org","chromium-reviews@chromium.org","ramankk@chromium.org","benquan@chromium.org","ahutter@chromium.org","dbeam+watch-autofill@chromium.org","sail+watch@chromium.org","dgwallinga@chromium.org","dyu@chromium.org","estade+watch@chromium.org","abodenha@chromium.org","isherman@chromium.org"],"text":"More autofill code - please take a look.\n\nScreenshots: \nhttps://screenshot.googleplex.com/LQNk2bH7S\nhttps://screenshot.googleplex.com/rhQqtSXCy\nhttps://screenshot.googleplex.com/YoZ5SKDaa\n\n(The last one shows the highlight on hover, which is unfortunately subtle. Squint closely to see ;)","disapproval":false,"date":"2013-05-31 02:29:26.972330","approval":false},{"sender":"sail@chromium.org","recipients":["groby@chromium.org","sail@chromium.org","chromium-reviews@chromium.org","ramankk@chromium.org","benquan@chromium.org","ahutter@chromium.org","dbeam+watch-autofill@chromium.org","sail+watch@chromium.org","dgwallinga@chromium.org","dyu@chromium.org","estade+watch@chromium.org","abodenha@chromium.org","isherman@chromium.org"],"text":"Sorry didn't have time to do a full review today. Will try to get to it tomorrow.\n\nhttps://codereview.chromium.org/15670014/diff/1/chrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.mm\nFile chrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.mm (right):\n\nhttps://codereview.chromium.org/15670014/diff/1/chrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.mm#newcode165\nchrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.mm:165: flippedContentView_.reset([[FlippedView alloc] init]);\nuse designated initializer (initWithFrame:)?\n\nhttps://codereview.chromium.org/15670014/diff/1/chrome/browser/ui/cocoa/autofill/autofill_section_container.mm\nFile chrome/browser/ui/cocoa/autofill/autofill_section_container.mm (right):\n\nhttps://codereview.chromium.org/15670014/diff/1/chrome/browser/ui/cocoa/autofill/autofill_section_container.mm#newcode49\nchrome/browser/ui/cocoa/autofill/autofill_section_container.mm:49: // Break suggestion text into two lines. TODO(groby): Should be on controller.\nOuch, this really sucks. I don't think this code should be simply moved to the controller.\n\nInstead, AutofillDialogControllerImpl::SuggestionTextForSection() should be fixed to construct two separate lines.\n\nCould we fix that first before this change goes in?\n\nhttps://codereview.chromium.org/15670014/diff/1/chrome/browser/ui/cocoa/autofill/autofill_section_view.h\nFile chrome/browser/ui/cocoa/autofill/autofill_section_view.h (right):\n\nhttps://codereview.chromium.org/15670014/diff/1/chrome/browser/ui/cocoa/autofill/autofill_section_view.h#newcode17\nchrome/browser/ui/cocoa/autofill/autofill_section_view.h:17: BOOL highlightMode_;  // Indicates if view should highlight on hover\nhow about naming this shouldHighlightOnHover_?\n\nhttps://codereview.chromium.org/15670014/diff/1/chrome/browser/ui/cocoa/autofill/autofill_section_view.h#newcode24\nchrome/browser/ui/cocoa/autofill/autofill_section_view.h:24: - (void)setHighlightMode:(BOOL)highlightMode;\nuse @property to declare this?\n\nhttps://codereview.chromium.org/15670014/diff/1/chrome/browser/ui/cocoa/autofill/autofill_section_view.h#newcode30\nchrome/browser/ui/cocoa/autofill/autofill_section_view.h:30: - (BOOL)isHighlighted;\nuse @property to declare this?\n\nhttps://codereview.chromium.org/15670014/diff/1/chrome/browser/ui/cocoa/autofill/autofill_section_view.mm\nFile chrome/browser/ui/cocoa/autofill/autofill_section_view.mm (right):\n\nhttps://codereview.chromium.org/15670014/diff/1/chrome/browser/ui/cocoa/autofill/autofill_section_view.mm#newcode10\nchrome/browser/ui/cocoa/autofill/autofill_section_view.mm:10: @implementation AutofillSectionView\nshould move after namespace\n\nhttps://codereview.chromium.org/15670014/diff/1/chrome/browser/ui/cocoa/autofill/autofill_section_view.mm#newcode17\nchrome/browser/ui/cocoa/autofill/autofill_section_view.mm:17: }\n}  // namespace","disapproval":false,"date":"2013-05-31 19:39:24.268510","approval":false},{"sender":"groby@chromium.org","recipients":["groby@chromium.org","sail@chromium.org","chromium-reviews@chromium.org","ramankk@chromium.org","benquan@chromium.org","ahutter@chromium.org","dbeam+watch-autofill@chromium.org","sail+watch@chromium.org","dgwallinga@chromium.org","dyu@chromium.org","estade+watch@chromium.org","abodenha@chromium.org","isherman@chromium.org"],"text":"https://codereview.chromium.org/15670014/diff/1/chrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.mm\nFile chrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.mm (right):\n\nhttps://codereview.chromium.org/15670014/diff/1/chrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.mm#newcode165\nchrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.mm:165: flippedContentView_.reset([[FlippedView alloc] init]);\nOn 2013/05/31 19:39:24, sail wrote:\n> use designated initializer (initWithFrame:)?\n\nDone.\n\nhttps://codereview.chromium.org/15670014/diff/1/chrome/browser/ui/cocoa/autofill/autofill_section_container.mm\nFile chrome/browser/ui/cocoa/autofill/autofill_section_container.mm (right):\n\nhttps://codereview.chromium.org/15670014/diff/1/chrome/browser/ui/cocoa/autofill/autofill_section_container.mm#newcode49\nchrome/browser/ui/cocoa/autofill/autofill_section_container.mm:49: // Break suggestion text into two lines. TODO(groby): Should be on controller.\nYes, it does. And I meant breaking it up when I said \"move to controller\".\n\nUnfortunately, it's not a trivial change - we have two other implementations relying on this particular API, and it seems to be a consequence of a server-side API.\n\nI've pinged the guys who wrote the controller & wallet integration so I can find out _why_ things are the way they are.\n\nOn 2013/05/31 19:39:24, sail wrote:\n> Ouch, this really sucks. I don't think this code should be simply moved to the\n> controller.\n> \n> Instead, AutofillDialogControllerImpl::SuggestionTextForSection() should be\n> fixed to construct two separate lines.\n> \n> Could we fix that first before this change goes in?\n\nhttps://codereview.chromium.org/15670014/diff/1/chrome/browser/ui/cocoa/autofill/autofill_section_view.h\nFile chrome/browser/ui/cocoa/autofill/autofill_section_view.h (right):\n\nhttps://codereview.chromium.org/15670014/diff/1/chrome/browser/ui/cocoa/autofill/autofill_section_view.h#newcode17\nchrome/browser/ui/cocoa/autofill/autofill_section_view.h:17: BOOL highlightMode_;  // Indicates if view should highlight on hover\nOn 2013/05/31 19:39:24, sail wrote:\n> how about naming this shouldHighlightOnHover_?\n\nDone.\n\nhttps://codereview.chromium.org/15670014/diff/1/chrome/browser/ui/cocoa/autofill/autofill_section_view.h#newcode21\nchrome/browser/ui/cocoa/autofill/autofill_section_view.h:21: - (NSColor*)hoverColor;\nAlso propertized.\n\nhttps://codereview.chromium.org/15670014/diff/1/chrome/browser/ui/cocoa/autofill/autofill_section_view.h#newcode24\nchrome/browser/ui/cocoa/autofill/autofill_section_view.h:24: - (void)setHighlightMode:(BOOL)highlightMode;\nOn 2013/05/31 19:39:24, sail wrote:\n> use @property to declare this?\n\nDone.\n\nhttps://codereview.chromium.org/15670014/diff/1/chrome/browser/ui/cocoa/autofill/autofill_section_view.h#newcode30\nchrome/browser/ui/cocoa/autofill/autofill_section_view.h:30: - (BOOL)isHighlighted;\nOn 2013/05/31 19:39:24, sail wrote:\n> use @property to declare this?\n\nDone.\n\nhttps://codereview.chromium.org/15670014/diff/1/chrome/browser/ui/cocoa/autofill/autofill_section_view.mm\nFile chrome/browser/ui/cocoa/autofill/autofill_section_view.mm (right):\n\nhttps://codereview.chromium.org/15670014/diff/1/chrome/browser/ui/cocoa/autofill/autofill_section_view.mm#newcode10\nchrome/browser/ui/cocoa/autofill/autofill_section_view.mm:10: @implementation AutofillSectionView\nOn 2013/05/31 19:39:24, sail wrote:\n> should move after namespace\n\nDone.\n\nhttps://codereview.chromium.org/15670014/diff/1/chrome/browser/ui/cocoa/autofill/autofill_section_view.mm#newcode17\nchrome/browser/ui/cocoa/autofill/autofill_section_view.mm:17: }\nOn 2013/05/31 19:39:24, sail wrote:\n> }  // namespace\n\nDone.","disapproval":false,"date":"2013-05-31 23:04:38.186170","approval":false},{"sender":"groby@chromium.org","recipients":["groby@chromium.org","sail@chromium.org","chromium-reviews@chromium.org","ramankk@chromium.org","benquan@chromium.org","ahutter@chromium.org","dbeam+watch-autofill@chromium.org","sail+watch@chromium.org","dgwallinga@chromium.org","dyu@chromium.org","estade+watch@chromium.org","abodenha@chromium.org","isherman@chromium.org"],"text":"So I've gotten a bit more clarity on what's going on there. It seems all we're trying to do is have multi-line text with (possibly) a leading icon.\n\nSee http://jsfiddle.net/vWAaw/ for how that'd look in HTML.\n\nThe text breaking existed since Views can't do that. I _believe_ I can do this in cocoa with NSAttributedString/NSTextAttachement, but I'd prefer it if we could do that in a separate CL.","disapproval":false,"date":"2013-05-31 23:37:24.260580","approval":false},{"sender":"groby@chromium.org","recipients":["groby@chromium.org","sail@chromium.org","chromium-reviews@chromium.org","ramankk@chromium.org","benquan@chromium.org","ahutter@chromium.org","dbeam+watch-autofill@chromium.org","sail+watch@chromium.org","dgwallinga@chromium.org","dyu@chromium.org","estade+watch@chromium.org","abodenha@chromium.org","isherman@chromium.org"],"text":"On 2013/05/31 23:37:24, groby wrote:\n> So I've gotten a bit more clarity on what's going on there. \n\nAnd by \"there\" I mean regarding the text break. Sorry, forgot that you don't live in my brain :)","disapproval":false,"date":"2013-05-31 23:37:57.293690","approval":false},{"sender":"groby@chromium.org","recipients":["groby@chromium.org","sail@chromium.org","chromium-reviews@chromium.org","ramankk@chromium.org","benquan@chromium.org","ahutter@chromium.org","dbeam+watch-autofill@chromium.org","sail+watch@chromium.org","dgwallinga@chromium.org","dyu@chromium.org","estade+watch@chromium.org","abodenha@chromium.org","isherman@chromium.org"],"text":"Ping?","disapproval":false,"date":"2013-06-04 22:54:58.744280","approval":false},{"sender":"sail@chromium.org","recipients":["groby@chromium.org","sail@chromium.org","chromium-reviews@chromium.org","ramankk@chromium.org","benquan@chromium.org","ahutter@chromium.org","dbeam+watch-autofill@chromium.org","sail+watch@chromium.org","dgwallinga@chromium.org","dyu@chromium.org","estade+watch@chromium.org","abodenha@chromium.org","isherman@chromium.org"],"text":"just nits, LGTM\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.h\nFile chrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.h (right):\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.h#newcode81\nchrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.h:81: scoped_nsobject<NSView> flippedContentView_;\nYou don't need this since you don't reference it after adding it to the window.\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.mm\nFile chrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.mm (right):\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.mm#newcode170\nchrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.mm:170: [[[self window] contentView] setSubviews:@[flippedContentView_]];\njust addSubview:?\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.mm#newcode171\nchrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.mm:171: [[[self window] contentView] setAutoresizesSubviews:YES];\nI think this is already the default\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_section_container.mm\nFile chrome/browser/ui/cocoa/autofill/autofill_section_container.mm (right):\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_section_container.mm#newcode306\nchrome/browser/ui/cocoa/autofill/autofill_section_container.mm:306: const autofill::SuggestionState& suggestion_state =\ncame case, more below\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_section_container.mm#newcode320\nchrome/browser/ui/cocoa/autofill/autofill_section_container.mm:320: withFont:font.GetNativeFont()];\nneed to line up on :\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_section_view.h\nFile chrome/browser/ui/cocoa/autofill/autofill_section_view.h (right):\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_section_view.h#newcode26\nchrome/browser/ui/cocoa/autofill/autofill_section_view.h:26: setter=setShouldHighlightOnHover:) BOOL shouldHighlightOnHover;\ndon't need the getter/setter since those are the default values. Same above and below.\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_section_view.mm\nFile chrome/browser/ui/cocoa/autofill/autofill_section_view.mm (right):\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_section_view.mm#newcode13\nchrome/browser/ui/cocoa/autofill/autofill_section_view.mm:13: SkColor kShadingColor = SkColorSetARGB(7, 0, 0, 0);\nSkColorSetARGB uses a function in debug builds. This might add a static initializer. To work around this I'd just use an int directly. Something like 0xFF000000.\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_section_view.mm#newcode49\nchrome/browser/ui/cocoa/autofill/autofill_section_view.mm:49: - (BOOL)shouldHighlightOnHover {\nreplace with @synthesize shouldHighlightOnHover = shouldHighlightOnHover_ ?\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_section_view.mm#newcode59\nchrome/browser/ui/cocoa/autofill/autofill_section_view.mm:59: - (BOOL)isHighlighted {\nreplace with @synthesize isHighlighted = isHighlighted_ ?\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.h\nFile chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.h (right):\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.h#newcode40\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.h:40: scoped_nsobject<NSImageView> icon_;\niconImageView_ or imageView_?\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.h#newcode43\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.h:43: scoped_nsobject<AutofillTextField> textfield_;\ntextField_?\n\nalso, these names aren't very descriptive. It's not clear what the difference between label_ and textField_ is.\n\nMaybe use something like, label_ and inputField_ ?\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.h#newcode46\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.h:46: scoped_nsobject<NSButton> edit_link_;\ncame case\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm\nFile chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm (right):\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm#newcode26\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm:26: void CenterVertically(NSRect rect1, NSRect* rect2) {\ninstead of modifying the input parameter it would be better to just return the result\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm#newcode27\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm:27: DCHECK(NSHeight(*rect2) <= NSHeight(rect1));\nDCHECK_LT?\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm#newcode42\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm:42: [label sizeToFit];\ndon't need?\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm#newcode50\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm:50: if (self = [super init])\nfor some reason we always use braces around these\nalso need double brackets\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm#newcode56\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm:56: scoped_nsobject<NSView>view([[NSView alloc] initWithFrame:NSZeroRect]);\nspace after >\nalso, move to first use?\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm#newcode65\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm:65: textfield_.reset([[AutofillTextField alloc] init]);\ninitWithFrame\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm#newcode71\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm:71: [[edit_link_ cell] setUnderlineOnHover:NO];\ndon't need since this is default\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm#newcode129\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm:129: NSSize size = [[label_ cell] cellSize];\nQuick question, why cellSize instead of [label_ bounds].size? Specially since you already did [label_ sizeToFit] above?\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm#newcode134\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm:134: // Correct sizing/spacing for textfield_ is pending TODO(estade).\ncomment is hard to understand\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm#newcode148\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm:148: std::ceil(size.height) + 8.0 + std::ceil(size2.height));\nmove the 8.0 to a constant?\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm#newcode161\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm:161: NSSize size = [self preferredSize];\nsize -> preferredContainerSize?\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm#newcode166\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm:166: lineFrame = NSOffsetRect(lineFrame, 0, -NSHeight(lineFrame));\nthis would be clearer as:\n  NSRect lineFrame;\n  lineFrame.size = [self preferredSizeForFirstLine];\n  lineFrame.origin.x = NSMinX(bounds);\n  lineFrame.origin.y = preferredContainerSize.height - NSHeight(lineFrame);\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container_unittest.mm\nFile chrome/browser/ui/cocoa/autofill/autofill_suggestion_container_unittest.mm (right):\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container_unittest.mm#newcode47\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container_unittest.mm:47: int numTextfields = 0;\nnum_text_fields (more below)","disapproval":false,"date":"2013-06-05 20:00:53.082920","approval":true},{"sender":"sail@chromium.org","recipients":["groby@chromium.org","sail@chromium.org","chromium-reviews@chromium.org","ramankk@chromium.org","benquan@chromium.org","ahutter@chromium.org","dbeam+watch-autofill@chromium.org","sail+watch@chromium.org","dgwallinga@chromium.org","dyu@chromium.org","estade+watch@chromium.org","abodenha@chromium.org","isherman@chromium.org"],"text":"https://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_section_container.mm\nFile chrome/browser/ui/cocoa/autofill/autofill_section_container.mm (right):\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_section_container.mm#newcode306\nchrome/browser/ui/cocoa/autofill/autofill_section_container.mm:306: const autofill::SuggestionState& suggestion_state =\nOn 2013/06/05 20:00:53, sail wrote:\n> came case, more below\n\ngah, camel case","disapproval":false,"date":"2013-06-05 20:01:20.830030","approval":false},{"sender":"groby@chromium.org","recipients":["groby@chromium.org","sail@chromium.org","chromium-reviews@chromium.org","ramankk@chromium.org","benquan@chromium.org","ahutter@chromium.org","dbeam+watch-autofill@chromium.org","sail+watch@chromium.org","dgwallinga@chromium.org","dyu@chromium.org","estade+watch@chromium.org","abodenha@chromium.org","isherman@chromium.org"],"text":"https://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.h\nFile chrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.h (right):\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.h#newcode81\nchrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.h:81: scoped_nsobject<NSView> flippedContentView_;\nOn 2013/06/05 20:00:53, sail wrote:\n> You don't need this since you don't reference it after adding it to the window.\n\nDone.\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.mm\nFile chrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.mm (right):\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.mm#newcode170\nchrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.mm:170: [[[self window] contentView] setSubviews:@[flippedContentView_]];\nOn 2013/06/05 20:00:53, sail wrote:\n> just addSubview:?\n\nDone.\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.mm#newcode171\nchrome/browser/ui/cocoa/autofill/autofill_dialog_cocoa.mm:171: [[[self window] contentView] setAutoresizesSubviews:YES];\nOn 2013/06/05 20:00:53, sail wrote:\n> I think this is already the default\n\nDone.\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_section_container.mm\nFile chrome/browser/ui/cocoa/autofill/autofill_section_container.mm (right):\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_section_container.mm#newcode306\nchrome/browser/ui/cocoa/autofill/autofill_section_container.mm:306: const autofill::SuggestionState& suggestion_state =\nOn 2013/06/05 20:00:53, sail wrote:\n> came case, more below\n\nDone.\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_section_container.mm#newcode320\nchrome/browser/ui/cocoa/autofill/autofill_section_container.mm:320: withFont:font.GetNativeFont()];\nOn 2013/06/05 20:00:53, sail wrote:\n> need to line up on :\n\nDone.\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_section_view.h\nFile chrome/browser/ui/cocoa/autofill/autofill_section_view.h (right):\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_section_view.h#newcode26\nchrome/browser/ui/cocoa/autofill/autofill_section_view.h:26: setter=setShouldHighlightOnHover:) BOOL shouldHighlightOnHover;\nOn 2013/06/05 20:00:53, sail wrote:\n> don't need the getter/setter since those are the default values. Same above and\n> below.\n\nDone.\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_section_view.mm\nFile chrome/browser/ui/cocoa/autofill/autofill_section_view.mm (right):\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_section_view.mm#newcode13\nchrome/browser/ui/cocoa/autofill/autofill_section_view.mm:13: SkColor kShadingColor = SkColorSetARGB(7, 0, 0, 0);\nI thought static initializers in debug builds are OK? \n\nChanged, but not sure I like it :)\n\nOn 2013/06/05 20:00:53, sail wrote:\n> SkColorSetARGB uses a function in debug builds. This might add a static\n> initializer. To work around this I'd just use an int directly. Something like\n> 0xFF000000.\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_section_view.mm#newcode49\nchrome/browser/ui/cocoa/autofill/autofill_section_view.mm:49: - (BOOL)shouldHighlightOnHover {\nI didn't know synthesize worked when the setter needs to be code.\n\nDone.\n\nOn 2013/06/05 20:00:53, sail wrote:\n> replace with @synthesize shouldHighlightOnHover = shouldHighlightOnHover_ ?\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_section_view.mm#newcode59\nchrome/browser/ui/cocoa/autofill/autofill_section_view.mm:59: - (BOOL)isHighlighted {\nOn 2013/06/05 20:00:53, sail wrote:\n> replace with @synthesize isHighlighted = isHighlighted_ ?\n\nDone.\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.h\nFile chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.h (right):\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.h#newcode40\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.h:40: scoped_nsobject<NSImageView> icon_;\nOn 2013/06/05 20:00:53, sail wrote:\n> iconImageView_ or imageView_?\n\nDone.\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.h#newcode43\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.h:43: scoped_nsobject<AutofillTextField> textfield_;\nHm. I've kept it textfield_, since it's controlled by ShowTextfield on the controller...\n\nOh well, I like inputField better. Done.\n\nOn 2013/06/05 20:00:53, sail wrote:\n> textField_?\n> \n> also, these names aren't very descriptive. It's not clear what the difference\n> between label_ and textField_ is.\n> \n> Maybe use something like, label_ and inputField_ ?\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.h#newcode46\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.h:46: scoped_nsobject<NSButton> edit_link_;\nOn 2013/06/05 20:00:53, sail wrote:\n> came case\n\nDone.\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm\nFile chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm (right):\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm#newcode26\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm:26: void CenterVertically(NSRect rect1, NSRect* rect2) {\nOn 2013/06/05 20:00:53, sail wrote:\n> instead of modifying the input parameter it would be better to just return the\n> result\n\nDone.\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm#newcode27\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm:27: DCHECK(NSHeight(*rect2) <= NSHeight(rect1));\nOn 2013/06/05 20:00:53, sail wrote:\n> DCHECK_LT?\n\nDone.\n(Even though I hate DCHECK_OP. It's got its parameters the wrong way round)\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm#newcode42\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm:42: [label sizeToFit];\nOn 2013/06/05 20:00:53, sail wrote:\n> don't need?\n\nDone.\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm#newcode50\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm:50: if (self = [super init])\nOn 2013/06/05 20:00:53, sail wrote:\n> for some reason we always use braces around these\n> also need double brackets\n\nDone.\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm#newcode56\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm:56: scoped_nsobject<NSView>view([[NSView alloc] initWithFrame:NSZeroRect]);\nOn 2013/06/05 20:00:53, sail wrote:\n> space after >\n> also, move to first use?\n\nDone.\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm#newcode65\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm:65: textfield_.reset([[AutofillTextField alloc] init]);\nOn 2013/06/05 20:00:53, sail wrote:\n> initWithFrame\n\nDone.\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm#newcode71\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm:71: [[edit_link_ cell] setUnderlineOnHover:NO];\nOn 2013/06/05 20:00:53, sail wrote:\n> don't need since this is default\n\nDone.\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm#newcode129\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm:129: NSSize size = [[label_ cell] cellSize];\nMerely force of habit - I assume by default textFields are not presized. Thanks for catching!\n\nDone.\nOn 2013/06/05 20:00:53, sail wrote:\n> Quick question, why cellSize instead of [label_ bounds].size? Specially since\n> you already did [label_ sizeToFit] above?\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm#newcode134\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm:134: // Correct sizing/spacing for textfield_ is pending TODO(estade).\nOn 2013/06/05 20:00:53, sail wrote:\n> comment is hard to understand\n\nLet's hope this version is better.\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm#newcode148\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm:148: std::ceil(size.height) + 8.0 + std::ceil(size2.height));\nOn 2013/06/05 20:00:53, sail wrote:\n> move the 8.0 to a constant? \n\nDone.\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm#newcode161\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm:161: NSSize size = [self preferredSize];\nOn 2013/06/05 20:00:53, sail wrote:\n> size -> preferredContainerSize?\n\nDone.\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm#newcode166\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container.mm:166: lineFrame = NSOffsetRect(lineFrame, 0, -NSHeight(lineFrame));\nOn 2013/06/05 20:00:53, sail wrote:\n> this would be clearer as:\n>   NSRect lineFrame;\n>   lineFrame.size = [self preferredSizeForFirstLine];\n>   lineFrame.origin.x = NSMinX(bounds);\n>   lineFrame.origin.y = preferredContainerSize.height - NSHeight(lineFrame);\n\nDone.\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container_unittest.mm\nFile chrome/browser/ui/cocoa/autofill/autofill_suggestion_container_unittest.mm (right):\n\nhttps://codereview.chromium.org/15670014/diff/6001/chrome/browser/ui/cocoa/autofill/autofill_suggestion_container_unittest.mm#newcode47\nchrome/browser/ui/cocoa/autofill/autofill_suggestion_container_unittest.mm:47: int numTextfields = 0;\nSigh. C++ naming in .mm files gets me every single time. Done.\n\nOn 2013/06/05 20:00:53, sail wrote:\n> num_text_fields (more below)","disapproval":false,"date":"2013-06-06 04:22:27.419550","approval":false},{"sender":"sail@chromium.org","recipients":["groby@chromium.org","sail@chromium.org","chromium-reviews@chromium.org","ramankk@chromium.org","benquan@chromium.org","ahutter@chromium.org","dbeam+watch-autofill@chromium.org","sail+watch@chromium.org","dgwallinga@chromium.org","dyu@chromium.org","estade+watch@chromium.org","abodenha@chromium.org","isherman@chromium.org"],"text":"second LGTM","disapproval":false,"date":"2013-06-06 16:55:44.475910","approval":true},{"sender":"commit-bot@chromium.org","recipients":["groby@chromium.org","sail@chromium.org","chromium-reviews@chromium.org","ramankk@chromium.org","benquan@chromium.org","ahutter@chromium.org","dbeam+watch-autofill@chromium.org","sail+watch@chromium.org","dgwallinga@chromium.org","dyu@chromium.org","estade+watch@chromium.org","abodenha@chromium.org","isherman@chromium.org"],"text":"CQ is trying da patch. Follow status at\nhttps://chromium-status.appspot.com/cq/groby@chromium.org/15670014/19001","disapproval":false,"date":"2013-06-06 17:56:22.077940","approval":false},{"sender":"commit-bot@chromium.org","recipients":["groby@chromium.org","sail@chromium.org","chromium-reviews@chromium.org","ramankk@chromium.org","benquan@chromium.org","ahutter@chromium.org","dbeam+watch-autofill@chromium.org","sail+watch@chromium.org","dgwallinga@chromium.org","dyu@chromium.org","estade+watch@chromium.org","abodenha@chromium.org","isherman@chromium.org"],"text":"Change committed as 204584","disapproval":false,"date":"2013-06-06 20:45:15.341870","approval":false}],"owner_email":"groby@chromium.org","private":false,"base_url":"svn://svn.chromium.org/chrome/trunk/src","owner":"groby","subject":"[rAC] Added handling for suggestions.","created":"2013-05-31 02:19:00.977570","patchsets":[1,6001,19001],"modified":"2013-06-06 20:45:15.932850","closed":true,"commit":false,"issue":15670014}
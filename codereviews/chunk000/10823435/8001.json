{"files":{"build/android/gdb_apk":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":1,"num_removed":1,"messages":[],"id":5009,"is_binary":false},"content/content_shell.gypi":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":1,"num_removed":0,"messages":[{"author":"Yaron","author_email":"yfriedman@chromium.org","text":"It looks like the ANDROID_TOOLCHAIN is only ever used to get the right gdbserver. You could consolidate this variable with the existing one instead of adding an extra.","draft":false,"lineno":667,"date":"2012-08-22 22:51:35.187710","left":false},{"author":"michaelbai","author_email":"michaelbai@chromium.org","text":"On 2012/08/22 22:51:35, Yaron wrote:\n> It looks like the ANDROID_TOOLCHAIN is only ever used to get the right\n> gdbserver. You could consolidate this variable with the existing one instead of\n> adding an extra.\n\nDone.","draft":false,"lineno":667,"date":"2012-08-23 22:53:00.144530","left":false}],"id":5012,"is_binary":false},"testing/android/native_test.gyp":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":1,"num_removed":0,"messages":[],"id":5016,"is_binary":false},"build/android/ant/common.xml":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":1,"num_removed":0,"messages":[],"id":5007,"is_binary":false},"build/android/envsetup_functions.sh":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":4,"num_removed":4,"messages":[{"author":"Yaron","author_email":"yfriedman@chromium.org","text":"I don't think you need this new variable at all. Look at build/common.gypi. It looks like the variable is already being re-written from ia32 to x86 and you can just use target_arch.\n\nIt would be good to just simplify that if it's indeed true.l","draft":false,"lineno":110,"date":"2012-08-22 22:51:35.187160","left":false},{"author":"Peter Beverloo","author_email":"peter@chromium.org","text":"On 2012/08/22 22:51:35, Yaron wrote:\n> I don't think you need this new variable at all. Look at build/common.gypi. It\n> looks like the variable is already being re-written from ia32 to x86 and you can\n> just use target_arch.\n> \n> It would be good to just simplify that if it's indeed true.l\n\nAgreed. If it turns out you do, please name it \"android_ndk_target_arch\", as \"ndk\" can be ambiguous.","draft":false,"lineno":110,"date":"2012-08-23 10:45:48.157500","left":false},{"author":"michaelbai","author_email":"michaelbai@chromium.org","text":"On 2012/08/23 10:45:48, Peter Beverloo wrote:\n> On 2012/08/22 22:51:35, Yaron wrote:\n> > I don't think you need this new variable at all. Look at build/common.gypi. It\n> > looks like the variable is already being re-written from ia32 to x86 and you\n> can\n> > just use target_arch.\n> > \n> > It would be good to just simplify that if it's indeed true.l\n> \n> Agreed. If it turns out you do, please name it \"android_ndk_target_arch\", as\n> \"ndk\" can be ambiguous.\n\nDone.","draft":false,"lineno":110,"date":"2012-08-23 22:53:00.143060","left":false}],"id":5008,"is_binary":false},"content/content_tests.gypi":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":1,"num_removed":0,"messages":[],"id":5013,"is_binary":false},"content/shell/android/java/content_shell_apk.xml":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":1,"num_removed":1,"messages":[{"author":"Yaron","author_email":"yfriedman@chromium.org","text":"Actually I don't think you can do this in one change because the variable won't be defined for the webkit apk targets. (e.g. third_party/WebKit/Tools/DumpRenderTree/DumpRenderTree.gyp/DumpRenderTree.gyp and there are two others).\n\nI think you need to define the gyp variable in envsetup and in chromium gyp. A separate change in webkit gyp and then add this target once those are both landed.","draft":false,"lineno":20,"date":"2012-08-22 22:51:35.188200","left":false},{"author":"Peter Beverloo","author_email":"peter@chromium.org","text":"On 2012/08/22 22:51:35, Yaron wrote:\n> Actually I don't think you can do this in one change because the variable won't\n> be defined for the webkit apk targets. (e.g.\n> third_party/WebKit/Tools/DumpRenderTree/DumpRenderTree.gyp/DumpRenderTree.gyp\n> and there are two others).\n> \n> I think you need to define the gyp variable in envsetup and in chromium gyp. A\n> separate change in webkit gyp and then add this target once those are both\n> landed.\n\nWe can pass defines/properties to ant without things breaking if they aren't being used yet, so in this case a WebKit change can land first, after which (when WebKit rolls into Chromium) this should be fine to land.\n\nI'm a bit concerned about the number of level-ups (\"../\") this line relies on. For clarity, also exporting ANDROID_NDK_ROOT may be better, but that would indeed increase the number of defines even more. The repetition of invocating and passing all the arguments is too common now, can we consolidate this even more to a single gypi?","draft":false,"lineno":20,"date":"2012-08-23 10:45:48.192380","left":false},{"author":"michaelbai","author_email":"michaelbai@chromium.org","text":"I agreed and will file a bug for refactoring this part.\n\nOn 2012/08/23 10:45:48, Peter Beverloo wrote:\n> On 2012/08/22 22:51:35, Yaron wrote:\n> > Actually I don't think you can do this in one change because the variable\n> won't\n> > be defined for the webkit apk targets. (e.g.\n> > third_party/WebKit/Tools/DumpRenderTree/DumpRenderTree.gyp/DumpRenderTree.gyp\n> > and there are two others).\n> > \n> > I think you need to define the gyp variable in envsetup and in chromium gyp. A\n> > separate change in webkit gyp and then add this target once those are both\n> > landed.\n> \n> We can pass defines/properties to ant without things breaking if they aren't\n> being used yet, so in this case a WebKit change can land first, after which\n> (when WebKit rolls into Chromium) this should be fine to land.\n> \n> I'm a bit concerned about the number of level-ups (\"../\") this line relies on.\n> For clarity, also exporting ANDROID_NDK_ROOT may be better, but that would\n> indeed increase the number of defines even more. The repetition of invocating\n> and passing all the arguments is too common now, can we consolidate this even\n> more to a single gypi?\n\n","draft":false,"lineno":20,"date":"2012-08-23 22:53:00.145160","left":false}],"id":5014,"is_binary":false},"content/shell/content_shell_ant_helper.sh":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":3,"num_removed":2,"messages":[{"author":"Peter Beverloo","author_email":"peter@chromium.org","text":"fifth -> last?","draft":false,"lineno":9,"date":"2012-08-23 10:45:48.193470","left":false},{"author":"Peter Beverloo","author_email":"peter@chromium.org","text":"buildtype=\"$(echo \"${@: -1}\" | tr '[A-Z]' '[a-z]')\"\n\nwould make this much less fragile.","draft":false,"lineno":13,"date":"2012-08-23 10:45:48.195230","left":false},{"author":"Peter Beverloo","author_email":"peter@chromium.org","text":"exec \"${@:1:$((${#@} - 1))}\"\n\nand when we want to add buildtype:\nexec \"${@:1:$((${#@} - 1))}\" \"${buildtype}\"\n\nThe real problem is, however, that this stinks. We should be passing the build type as the first parameter instead of the last one, as that would allow us to use \"shift\" to remove it. The script would end up as something like:\n\nbuildtype=\"$(echo \"${1}\" | tr '[A-Z]' '[a-z]')\"\nshift\nexec $@ \"${buildtype}\" ","draft":false,"lineno":19,"date":"2012-08-23 10:45:48.195650","left":false},{"author":"michaelbai","author_email":"michaelbai@chromium.org","text":"On 2012/08/23 10:45:48, Peter Beverloo wrote:\n> buildtype=\"$(echo \"${@: -1}\" | tr '[A-Z]' '[a-z]')\"\n> \n> would make this much less fragile.\n\nDone.","draft":false,"lineno":13,"date":"2012-08-23 22:53:00.145690","left":false},{"author":"michaelbai","author_email":"michaelbai@chromium.org","text":"On 2012/08/23 10:45:48, Peter Beverloo wrote:\n> exec \"${@:1:$((${#@} - 1))}\"\n> \n> and when we want to add buildtype:\n> exec \"${@:1:$((${#@} - 1))}\" \"${buildtype}\"\n> \n> The real problem is, however, that this stinks. We should be passing the build\n> type as the first parameter instead of the last one, as that would allow us to\n> use \"shift\" to remove it. The script would end up as something like:\n> \n> buildtype=\"$(echo \"${1}\" | tr '[A-Z]' '[a-z]')\"\n> shift\n> exec $@ \"${buildtype}\" \n\nDone.","draft":false,"lineno":19,"date":"2012-08-23 22:53:00.147250","left":false}],"id":5015,"is_binary":false},"build/java.gypi":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":1,"num_removed":0,"messages":[],"id":5011,"is_binary":false},"build/apk_test.gypi":{"status":"M","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":2,"num_removed":0,"messages":[],"id":5010,"is_binary":false}},"owner_email":"michaelbai@chromium.org","owner":"michaelbai","message":"add variable for all ant action.","try_job_results":[],"created":"2012-08-22 21:02:14.405820","url":null,"num_comments":13,"modified":"2012-08-23 22:53:00.257800","patchset":8001,"issue":10823435}